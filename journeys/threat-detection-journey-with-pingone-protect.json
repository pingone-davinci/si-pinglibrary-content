{
  "meta": {
    "origin": "",
    "exportedBy": "",
    "exportDate": "",
    "exportTool": "platform-admin ui tree export",
    "exportToolVersion": "1.0",
    "treesSelectedForExport": [
      "Threat Detection Journey with PingOne Protect"
    ],
    "innerTreesIncluded": [
      "Combined OATH And PUSH MFA Methods Registration - Inner Journey",
      "Push MFA Method Registration - Inner Journey",
      "OATH Registration - Inner Journey",
      "WebAuthn MFA Method Registration - Inner Journey",
      "Threat Detection - Inner Journey",
      "MFA Device Registration - Inner Journey",
      "MFA Authentication - Inner Journey"
    ]
  },
  "trees": {
    "WebAuthn MFA Method Registration - Inner Journey": {
      "tree": {
        "_id": "WebAuthn MFA Method Registration - Inner Journey",
        "_rev": "-366670706",
        "identityResource": "managed/alpha_user",
        "entryNodeId": "013cc725-bb56-45a1-b2bc-b191348c5599",
        "innerTreeOnly": true,
        "noSession": false,
        "mustRun": false,
        "enabled": true,
        "transactionalOnly": false,
        "uiConfig": {
          "categories": "[\"Threat Detection\"]"
        },
        "nodes": {
          "013cc725-bb56-45a1-b2bc-b191348c5599": {
            "connections": {
              "error": "e301438c-0bd0-429c-ab0c-66126501069a",
              "failure": "e301438c-0bd0-429c-ab0c-66126501069a",
              "success": "ec637ab4-4918-4b9b-82de-8da9ebd3c8ac",
              "unsupported": "e301438c-0bd0-429c-ab0c-66126501069a"
            },
            "displayName": "WebAuthn Registration Node",
            "nodeType": "WebAuthnRegistrationNode",
            "x": 249,
            "y": 210.015625,
            "version": 1
          },
          "ec637ab4-4918-4b9b-82de-8da9ebd3c8ac": {
            "connections": {
              "outcome": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "Recovery Code Display Node",
            "nodeType": "RecoveryCodeDisplayNode",
            "x": 251,
            "y": 79.015625,
            "version": 1
          }
        },
        "staticNodes": {
          "70e691a5-1e33-4ac3-a356-e7b6d60d92e0": {
            "x": 817,
            "y": 82
          },
          "e301438c-0bd0-429c-ab0c-66126501069a": {
            "x": 814,
            "y": 291
          },
          "startNode": {
            "x": 50,
            "y": 250
          }
        }
      },
      "nodes": {
        "013cc725-bb56-45a1-b2bc-b191348c5599": {
          "_id": "013cc725-bb56-45a1-b2bc-b191348c5599",
          "_rev": "1579362306",
          "trustStoreAlias": "trustalias",
          "fidoCertificationLevel": "OFF",
          "relyingPartyName": "ForgeRock",
          "maxSavedDevices": 0,
          "generateRecoveryCodes": true,
          "storeAttestationDataInTransientState": false,
          "origins": [],
          "userVerificationRequirement": "PREFERRED",
          "postponeDeviceProfileStorage": false,
          "excludeCredentials": false,
          "requiresResidentKey": false,
          "authenticatorAttachment": "UNSPECIFIED",
          "asScript": true,
          "validateFidoU2fAaguid": true,
          "acceptedSigningAlgorithms": [
            "ES256",
            "RS256"
          ],
          "attestationPreference": "NONE",
          "enforceRevocationCheck": false,
          "timeout": 60,
          "_type": {
            "_id": "WebAuthnRegistrationNode",
            "name": "WebAuthn Registration Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "unsupported",
              "displayName": "Unsupported"
            },
            {
              "id": "success",
              "displayName": "Success"
            },
            {
              "id": "failure",
              "displayName": "Failure"
            },
            {
              "id": "error",
              "displayName": "Client Error"
            }
          ]
        },
        "ec637ab4-4918-4b9b-82de-8da9ebd3c8ac": {
          "_id": "ec637ab4-4918-4b9b-82de-8da9ebd3c8ac",
          "_rev": "-1026979116",
          "_type": {
            "_id": "RecoveryCodeDisplayNode",
            "name": "Recovery Code Display Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        }
      },
      "innerNodes": {},
      "scripts": {},
      "emailTemplates": {},
      "socialIdentityProviders": {},
      "themes": [],
      "saml2Entities": {},
      "circlesOfTrust": {}
    },
    "OATH Registration - Inner Journey": {
      "tree": {
        "_id": "OATH Registration - Inner Journey",
        "_rev": "733764376",
        "identityResource": "managed/alpha_user",
        "entryNodeId": "a74fc86b-bef3-45b7-aa64-21342feb6d0f",
        "innerTreeOnly": true,
        "noSession": false,
        "mustRun": false,
        "enabled": true,
        "transactionalOnly": false,
        "uiConfig": {
          "categories": "[\"Threat Detection\"]"
        },
        "nodes": {
          "1cd6339e-9ce1-4142-9324-5108071cb283": {
            "connections": {
              "Reject": "e301438c-0bd0-429c-ab0c-66126501069a",
              "Retry": "a74fc86b-bef3-45b7-aa64-21342feb6d0f"
            },
            "displayName": "Retry Limit Decision",
            "nodeType": "RetryLimitDecisionNode",
            "x": 577,
            "y": 739.015625,
            "version": 1
          },
          "20e5f0b6-3a9d-4d37-8860-f9b54e405a64": {
            "connections": {
              "true": "7a7570f1-fafa-4024-816b-143e14a84eca"
            },
            "displayName": "Set Invalid Code Error Message",
            "nodeType": "ScriptedDecisionNode",
            "x": 874,
            "y": 282.015625,
            "version": 1
          },
          "2b07661f-4488-4a81-a06c-260f3bba12fd": {
            "connections": {
              "failureOutcome": "e301438c-0bd0-429c-ab0c-66126501069a",
              "successOutcome": "b93bfdc3-8784-4404-bf5a-3405e007f51c"
            },
            "displayName": "OATH Registration",
            "nodeType": "OathRegistrationNode",
            "x": 569,
            "y": 222.015625,
            "version": 1
          },
          "5919080a-42ec-4caa-a72b-379928f64287": {
            "connections": {
              "true": "a249211b-b737-4af5-9043-a741b0337be5"
            },
            "displayName": "Set Invalid Code Error Message",
            "nodeType": "ScriptedDecisionNode",
            "x": 879,
            "y": 418.015625,
            "version": 1
          },
          "7a7570f1-fafa-4024-816b-143e14a84eca": {
            "connections": {
              "failureOutcome": "a6b19d5f-a886-4c16-b73e-b1732bcabd9c",
              "notRegisteredOutcome": "e301438c-0bd0-429c-ab0c-66126501069a",
              "successOutcome": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "Collect Verification Code",
            "nodeType": "PageNode",
            "x": 909,
            "y": 0,
            "version": 1
          },
          "9bd179e2-fff2-4c6e-a185-6e6a601c4ee5": {
            "connections": {
              "Reject": "e301438c-0bd0-429c-ab0c-66126501069a",
              "Retry": "5919080a-42ec-4caa-a72b-379928f64287"
            },
            "displayName": "Retry Limit Decision",
            "nodeType": "RetryLimitDecisionNode",
            "x": 908,
            "y": 536.015625,
            "version": 1
          },
          "a249211b-b737-4af5-9043-a741b0337be5": {
            "connections": {
              "false": "9bd179e2-fff2-4c6e-a185-6e6a601c4ee5",
              "true": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "Collect Recovery Code",
            "nodeType": "PageNode",
            "x": 909,
            "y": 704.015625,
            "version": 1
          },
          "a6b19d5f-a886-4c16-b73e-b1732bcabd9c": {
            "connections": {
              "Reject": "e301438c-0bd0-429c-ab0c-66126501069a",
              "Retry": "20e5f0b6-3a9d-4d37-8860-f9b54e405a64"
            },
            "displayName": "Retry Limit Decision",
            "nodeType": "RetryLimitDecisionNode",
            "x": 1246,
            "y": 85.015625,
            "version": 1
          },
          "a74fc86b-bef3-45b7-aa64-21342feb6d0f": {
            "connections": {
              "failureOutcome": "1cd6339e-9ce1-4142-9324-5108071cb283",
              "notRegisteredOutcome": "b2f273ed-d2ca-470f-9d76-f3b7abab21dd",
              "recoveryCodeOutcome": "a249211b-b737-4af5-9043-a741b0337be5",
              "successOutcome": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "OATH Token Verifier",
            "nodeType": "OathTokenVerifierNode",
            "x": 568,
            "y": 482.015625,
            "version": 1
          },
          "b2f273ed-d2ca-470f-9d76-f3b7abab21dd": {
            "connections": {
              "outcome": "2b07661f-4488-4a81-a06c-260f3bba12fd"
            },
            "displayName": "Get Authenticator App",
            "nodeType": "GetAuthenticatorAppNode",
            "x": 560.5714285714286,
            "y": 374.59375,
            "version": 1
          },
          "b93bfdc3-8784-4404-bf5a-3405e007f51c": {
            "connections": {
              "outcome": "7a7570f1-fafa-4024-816b-143e14a84eca"
            },
            "displayName": "Recovery Code Display Node",
            "nodeType": "RecoveryCodeDisplayNode",
            "x": 537,
            "y": 81.015625,
            "version": 1
          }
        },
        "staticNodes": {
          "70e691a5-1e33-4ac3-a356-e7b6d60d92e0": {
            "x": 1908,
            "y": 504
          },
          "e301438c-0bd0-429c-ab0c-66126501069a": {
            "x": 1910,
            "y": 801
          },
          "startNode": {
            "x": 50,
            "y": 250
          }
        }
      },
      "nodes": {
        "1cd6339e-9ce1-4142-9324-5108071cb283": {
          "_id": "1cd6339e-9ce1-4142-9324-5108071cb283",
          "_rev": "-601147287",
          "incrementUserAttributeOnFailure": true,
          "retryLimit": 3,
          "_type": {
            "_id": "RetryLimitDecisionNode",
            "name": "Retry Limit Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Retry",
              "displayName": "Retry"
            },
            {
              "id": "Reject",
              "displayName": "Reject"
            }
          ]
        },
        "20e5f0b6-3a9d-4d37-8860-f9b54e405a64": {
          "_id": "20e5f0b6-3a9d-4d37-8860-f9b54e405a64",
          "_rev": "-1011399115",
          "script": "d7533919-235c-4548-99db-dd9cb33344ae",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "invalidCodeErrorMessage",
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "null"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "2b07661f-4488-4a81-a06c-260f3bba12fd": {
          "_id": "2b07661f-4488-4a81-a06c-260f3bba12fd",
          "_rev": "-1853389764",
          "addChecksum": false,
          "bgColor": "032b75",
          "generateRecoveryCodes": true,
          "truncationOffset": -1,
          "algorithm": "TOTP",
          "postponeDeviceProfileStorage": false,
          "passwordLength": "SIX_DIGITS",
          "totpTimeInterval": 30,
          "scanQRCodeMessage": {},
          "accountName": "USERNAME",
          "issuer": "ForgeRock",
          "minSharedSecretLength": 32,
          "totpHashAlgorithm": "HMAC_SHA1",
          "imgUrl": "",
          "_type": {
            "_id": "OathRegistrationNode",
            "name": "OATH Registration",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "successOutcome",
              "displayName": "Success"
            },
            {
              "id": "failureOutcome",
              "displayName": "Failure"
            }
          ]
        },
        "5919080a-42ec-4caa-a72b-379928f64287": {
          "_id": "5919080a-42ec-4caa-a72b-379928f64287",
          "_rev": "1845789976",
          "script": "d7533919-235c-4548-99db-dd9cb33344ae",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "invalidCodeErrorMessage",
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "null"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "7a7570f1-fafa-4024-816b-143e14a84eca": {
          "_id": "7a7570f1-fafa-4024-816b-143e14a84eca",
          "_rev": "1324527267",
          "nodes": [
            {
              "_id": "9604474b-479d-45bf-b77c-c2ee15fafb1b",
              "nodeType": "ScriptedDecisionNode",
              "nodeVersion": 1,
              "displayName": "Validate Verification Code"
            },
            {
              "_id": "b675f4d8-a659-4a0f-8e6d-5821270669d4",
              "nodeType": "OathTokenVerifierNode",
              "nodeVersion": 1,
              "displayName": "OATH Token Verifier"
            }
          ],
          "pageDescription": {},
          "pageHeader": {
            "en": "Enter Verification Code"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "successOutcome",
              "displayName": "Success"
            },
            {
              "id": "failureOutcome",
              "displayName": "Failure"
            },
            {
              "id": "notRegisteredOutcome",
              "displayName": "Not registered"
            }
          ]
        },
        "9bd179e2-fff2-4c6e-a185-6e6a601c4ee5": {
          "_id": "9bd179e2-fff2-4c6e-a185-6e6a601c4ee5",
          "_rev": "-1975230023",
          "incrementUserAttributeOnFailure": true,
          "retryLimit": 3,
          "_type": {
            "_id": "RetryLimitDecisionNode",
            "name": "Retry Limit Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Retry",
              "displayName": "Retry"
            },
            {
              "id": "Reject",
              "displayName": "Reject"
            }
          ]
        },
        "a249211b-b737-4af5-9043-a741b0337be5": {
          "_id": "a249211b-b737-4af5-9043-a741b0337be5",
          "_rev": "1573640268",
          "nodes": [
            {
              "_id": "32777409-ca77-46e9-8c63-b58e89685fbd",
              "nodeType": "ScriptedDecisionNode",
              "nodeVersion": 1,
              "displayName": "Validate Recovery Code"
            },
            {
              "_id": "329bad80-6cd4-413d-9879-4b3a0d424a99",
              "nodeType": "RecoveryCodeCollectorDecisionNode",
              "nodeVersion": 1,
              "displayName": "Recovery Code Collector Decision"
            }
          ],
          "pageDescription": {},
          "pageHeader": {
            "en": "Enter Recovery Code"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "a6b19d5f-a886-4c16-b73e-b1732bcabd9c": {
          "_id": "a6b19d5f-a886-4c16-b73e-b1732bcabd9c",
          "_rev": "2020694613",
          "incrementUserAttributeOnFailure": true,
          "retryLimit": 3,
          "_type": {
            "_id": "RetryLimitDecisionNode",
            "name": "Retry Limit Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Retry",
              "displayName": "Retry"
            },
            {
              "id": "Reject",
              "displayName": "Reject"
            }
          ]
        },
        "a74fc86b-bef3-45b7-aa64-21342feb6d0f": {
          "_id": "a74fc86b-bef3-45b7-aa64-21342feb6d0f",
          "_rev": "1860727870",
          "totpTimeInterval": 30,
          "maximumAllowedClockDrift": 5,
          "totpTimeSteps": 2,
          "totpHashAlgorithm": "HMAC_SHA1",
          "isRecoveryCodeAllowed": true,
          "algorithm": "TOTP",
          "hotpWindowSize": 100,
          "_type": {
            "_id": "OathTokenVerifierNode",
            "name": "OATH Token Verifier",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "successOutcome",
              "displayName": "Success"
            },
            {
              "id": "failureOutcome",
              "displayName": "Failure"
            },
            {
              "id": "notRegisteredOutcome",
              "displayName": "Not registered"
            },
            {
              "id": "recoveryCodeOutcome",
              "displayName": "Recovery Code"
            }
          ]
        },
        "b2f273ed-d2ca-470f-9d76-f3b7abab21dd": {
          "_id": "b2f273ed-d2ca-470f-9d76-f3b7abab21dd",
          "_rev": "1457743664",
          "continueLabel": {},
          "message": {},
          "googleLink": "https://play.google.com/store/apps/details?id=com.forgerock.authenticator",
          "appleLink": "https://itunes.apple.com/app/forgerock-authenticator/id1038442926",
          "_type": {
            "_id": "GetAuthenticatorAppNode",
            "name": "Get Authenticator App",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "b93bfdc3-8784-4404-bf5a-3405e007f51c": {
          "_id": "b93bfdc3-8784-4404-bf5a-3405e007f51c",
          "_rev": "1737002172",
          "_type": {
            "_id": "RecoveryCodeDisplayNode",
            "name": "Recovery Code Display Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        }
      },
      "innerNodes": {
        "9604474b-479d-45bf-b77c-c2ee15fafb1b": {
          "_id": "9604474b-479d-45bf-b77c-c2ee15fafb1b",
          "_rev": "-2111599336",
          "script": "87cc8351-0d8c-4879-acee-6ddc72b29edc",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails",
            "invalidCodeErrorMessage"
          ],
          "inputs": [
            "invalidCodeErrorMessage"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "b675f4d8-a659-4a0f-8e6d-5821270669d4": {
          "_id": "b675f4d8-a659-4a0f-8e6d-5821270669d4",
          "_rev": "10908655",
          "totpTimeInterval": 30,
          "maximumAllowedClockDrift": 5,
          "totpTimeSteps": 2,
          "totpHashAlgorithm": "HMAC_SHA1",
          "isRecoveryCodeAllowed": false,
          "algorithm": "TOTP",
          "hotpWindowSize": 100,
          "_type": {
            "_id": "OathTokenVerifierNode",
            "name": "OATH Token Verifier",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "successOutcome",
              "displayName": "Success"
            },
            {
              "id": "failureOutcome",
              "displayName": "Failure"
            },
            {
              "id": "notRegisteredOutcome",
              "displayName": "Not registered"
            }
          ]
        },
        "32777409-ca77-46e9-8c63-b58e89685fbd": {
          "_id": "32777409-ca77-46e9-8c63-b58e89685fbd",
          "_rev": "484168044",
          "script": "a6c73f01-13f2-428d-9fc2-8fccbdc4b2d0",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails",
            "invalidCodeErrorMessage"
          ],
          "inputs": [
            "invalidCodeErrorMessage"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "329bad80-6cd4-413d-9879-4b3a0d424a99": {
          "_id": "329bad80-6cd4-413d-9879-4b3a0d424a99",
          "_rev": "660381696",
          "recoveryCodeType": "OATH",
          "_type": {
            "_id": "RecoveryCodeCollectorDecisionNode",
            "name": "Recovery Code Collector Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        }
      },
      "scripts": {
        "d7533919-235c-4548-99db-dd9cb33344ae": {
          "_id": "d7533919-235c-4548-99db-dd9cb33344ae",
          "name": "Threat Detection - Set Invalid code error message",
          "description": "Script to set invalid code error message",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: null\\n    - Script Outputs: \\\"invalidCodeErrorMessage\\\", \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\n// Set the below error message in shared state, can be displayed on the last UI Node\\n\\ntry {\\n    nodeState.putShared(\\\"invalidCodeErrorMessage\\\", \\\"Invalid Code\\\");\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error\\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925703,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083351,
          "evaluatorVersion": "2.0"
        },
        "87cc8351-0d8c-4879-acee-6ddc72b29edc": {
          "_id": "87cc8351-0d8c-4879-acee-6ddc72b29edc",
          "name": "Threat Detection - Validate verification code",
          "description": "Script to validate verification code input, sets constraints, and enables/disables the submit button based on validity",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n*/\\n\\n/*\\n    - Script Inputs: \\\"invalidCodeErrorMessage\\\"\\n    - Script Outputs: \\\"errorMessage\\\", \\\"errorDetails\\\", \\\"invalidCodeErrorMessage\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\ntry {\\n    function validateInput() {\\n        return String(\\\" \\\\n\\\\\\n                    // Validate the verification code \\\\n\\\\\\n                    function validateCode() { \\\\n\\\\\\n                        const submitBtn = document.querySelectorAll('button[type=\\\\\\\"button\\\\\\\"]')[0]; \\\\n\\\\\\n                        const verificationCode = document.querySelectorAll('input[data-vv-as=\\\\\\\"Enter verification code\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (verificationCode) { \\\\n\\\\\\n                            // Set input properties to prevent user tampering \\\\n\\\\\\n                            verificationCode.setAttribute('maxlength', '6'); \\\\n\\\\\\n                            verificationCode.setAttribute('pattern', '[0-9]{6}'); \\\\n\\\\\\n                            verificationCode.setAttribute('inputmode', 'numeric'); \\\\n\\\\\\n                            // Check if the input is exactly 6 digits long and numeric \\\\n\\\\\\n                            const isValidCode = /^[0-9]{6}$/.test(verificationCode.value); \\\\n\\\\\\n                            submitBtn.disabled = !isValidCode; \\\\n\\\\\\n                            return isValidCode; \\\\n\\\\\\n                        } \\\\n\\\\\\n                        return false; \\\\n\\\\\\n                    }; \\\\n\\\\\\n                    \\\\n\\\\\\n                    function preventEnterKeyDefault(event) { \\\\n\\\\\\n                        const submitBtn = document.querySelectorAll('button[type=\\\\\\\"button\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (event.key === 'Enter' && !validateCode()) { \\\\n\\\\\\n                            event.preventDefault(); \\\\n\\\\\\n                            if (submitBtn) submitBtn.disabled = true; \\\\n\\\\\\n                        } \\\\n\\\\\\n                    } \\\\n\\\\\\n                    \\\\n\\\\\\n                    function go(obs) { \\\\n\\\\\\n                        // Auto-submit and go to 'Not Registered' path if method is not registered for the user, in that case it is assumed that button will be of type submit from Page Node \\\\n\\\\\\n                        const nextBtn = document.querySelectorAll('button[type=\\\\\\\"submit\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (nextBtn) { \\\\n\\\\\\n                            nextBtn.style.visibility='hidden'; \\\\n\\\\\\n                            nextBtn.click(); \\\\n\\\\\\n                        } \\\\n\\\\\\n                        const submitBtn = document.querySelectorAll('button[type=\\\\\\\"button\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (submitBtn) submitBtn.disabled = true; \\\\n\\\\\\n                        const verificationCode = document.querySelectorAll('input[data-vv-as=\\\\\\\"Enter verification code\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (verificationCode && submitBtn) { \\\\n\\\\\\n                            verificationCode.addEventListener('input', validateCode); \\\\n\\\\\\n                            verificationCode.addEventListener('keypress', preventEnterKeyDefault); \\\\n\\\\\\n                            submitBtn.addEventListener('click', (event) => { \\\\n\\\\\\n                                if (!validateCode()) { \\\\n\\\\\\n                                    event.preventDefault(); \\\\n\\\\\\n                                    submitBtn.disabled = true; \\\\n\\\\\\n                                } \\\\n\\\\\\n                            }); \\\\n\\\\\\n                            if (obs) obs.disconnect(); \\\\n\\\\\\n                            return; \\\\n\\\\\\n                        } \\\\n\\\\\\n                    } \\\\n\\\\\\n                    \\\\n\\\\\\n                    // If both elements are present, initialize validation \\\\n\\\\\\n                    if (document.querySelectorAll('button[type=\\\\\\\"button\\\\\\\"]')[0] && document.querySelectorAll('input[data-vv-as=\\\\\\\"Enter verification code\\\\\\\"]')[0]) go(); \\\\n\\\\\\n                    else { \\\\n\\\\\\n                        const observer = new MutationObserver((mutations, obs) => { go(obs); }); \\\\n\\\\\\n                        observer.observe(document, { childList: true, subtree: true }); \\\\n\\\\\\n                    } \\\\n\\\\\\n        \\\");\\n    }\\n\\n    var invalidCodeErrorMessage = nodeState.get(\\\"invalidCodeErrorMessage\\\");\\n    nodeState.putShared(\\\"invalidCodeErrorMessage\\\", \\\"\\\");\\n    \\n    if (callbacks.isEmpty()) {\\n        // Display error message if invalid code entered by user\\n        if (invalidCodeErrorMessage && invalidCodeErrorMessage.length) callbacksBuilder.textOutputCallback(2, invalidCodeErrorMessage);\\n        // Request callbacks\\n        callbacksBuilder.scriptTextOutputCallback(validateInput());\\n    }\\n    // Go to true path\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error  \\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925688,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083463,
          "evaluatorVersion": "2.0"
        },
        "a6c73f01-13f2-428d-9fc2-8fccbdc4b2d0": {
          "_id": "a6c73f01-13f2-428d-9fc2-8fccbdc4b2d0",
          "name": "Threat Detection - Validate Recovery Code input",
          "description": "Script to validate Recovery code input, sets constraints, and enables/disables the submit button based on validity",
          "script": "\"// /*\\n//   - Data made available by nodes that have already executed are available in the sharedState variable.\\n//   - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n//  */\\n\\n/*\\n    - Script Inputs: \\\"invalidCodeErrorMessage\\\"\\n    - Script Outputs: \\\"errorMessage\\\", \\\"errorDetails\\\", \\\"invalidCodeErrorMessage\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\ntry {\\n    function validateInput() {\\n        return String(\\\" \\\\n\\\\\\n                    const submitBtn = document.querySelectorAll('button[type=\\\\\\\"submit\\\\\\\"]')[0]; \\\\n\\\\\\n                    if(submitBtn) submitBtn.disabled = true; \\\\n\\\\\\n                    function go(obs) { \\\\n\\\\\\n                        const recoveryCode = document.querySelectorAll('input[data-vv-as=\\\\\\\"Recovery Code\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (recoveryCode && submitBtn) { \\\\n\\\\\\n                            // Set the maxlength attribute to 10 \\\\n\\\\\\n                            recoveryCode.setAttribute('maxlength', 10); \\\\n\\\\\\n                            const enableSubmitBtn = () => { \\\\n\\\\\\n                                // Check input validity before enabling submit button \\\\n\\\\\\n                                const isValidInput = recoveryCode.value.length === 10; \\\\n\\\\\\n                                if (isValidInput) { \\\\n\\\\\\n                                    submitBtn.disabled = false; \\\\n\\\\\\n                                } else { \\\\n\\\\\\n                                    submitBtn.disabled = true; \\\\n\\\\\\n                                } \\\\n\\\\\\n                            }; \\\\n\\\\\\n                            // Revalidate before form submission \\\\n\\\\\\n                            submitBtn.addEventListener('click', (event) => { \\\\n\\\\\\n                                const isValidInput = recoveryCode.value.length === 10; \\\\n\\\\\\n                                if (!isValidInput) { \\\\n\\\\\\n                                    event.preventDefault(); \\\\n\\\\\\n                                    submitBtn.disabled = true; \\\\n\\\\\\n                                } \\\\n\\\\\\n                            }); \\\\n\\\\\\n                            recoveryCode.addEventListener('input', enableSubmitBtn); \\\\n\\\\\\n                            if (obs) obs.disconnect(); \\\\n\\\\\\n                            return; \\\\n\\\\\\n                       } \\\\n\\\\\\n                      } \\\\n\\\\\\n                      if (document.querySelectorAll('input[data-vv-as=\\\\\\\"Recovery Code\\\\\\\"]')[0]) go(); \\\\n\\\\\\n                      else { \\\\n\\\\\\n                        const observer = new MutationObserver((mutations, obs) => { go(obs); }); \\\\n\\\\\\n                        observer.observe(document, { childList: true, subtree: true }); \\\\n\\\\\\n                      } \\\\n\\\\\\n        \\\");\\n    }\\n\\n    var invalidCodeErrorMessage = nodeState.get(\\\"invalidCodeErrorMessage\\\");\\n    nodeState.putShared(\\\"invalidCodeErrorMessage\\\", \\\"\\\");\\n    \\n    if (callbacks.isEmpty()) {                \\n        // Display error message if invalid code entered by user\\n        if (invalidCodeErrorMessage && invalidCodeErrorMessage.length) callbacksBuilder.textOutputCallback(2, invalidCodeErrorMessage);\\n        // Request callbacks\\n        callbacksBuilder.scriptTextOutputCallback(validateInput());\\n    }\\n    // Go to true path\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error  \\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925690,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083411,
          "evaluatorVersion": "2.0"
        }
      },
      "emailTemplates": {},
      "socialIdentityProviders": {},
      "themes": [],
      "saml2Entities": {},
      "circlesOfTrust": {}
    },
    "Push MFA Method Registration - Inner Journey": {
      "tree": {
        "_id": "Push MFA Method Registration - Inner Journey",
        "_rev": "630169338",
        "identityResource": "managed/alpha_user",
        "entryNodeId": "d6ba5460-9fc5-4b2c-9b3d-96b6ab9e407a",
        "innerTreeOnly": true,
        "description": "A login journey with MFA using push notifications. This is for the implementation guide.",
        "noSession": false,
        "mustRun": false,
        "enabled": true,
        "transactionalOnly": false,
        "uiConfig": {
          "categories": "[\"Threat Detection\"]"
        },
        "nodes": {
          "1983a15a-f57e-4b4e-85c1-62c29e816132": {
            "connections": {
              "DONE": "1f583b80-7382-4903-8c29-2424b30e9565",
              "EXITED": "bfb6314c-da25-45fb-ac97-1746de12b0f8"
            },
            "displayName": "Push Wait Node",
            "nodeType": "PushWaitNode",
            "x": 377,
            "y": 107.015625,
            "version": 1
          },
          "1f583b80-7382-4903-8c29-2424b30e9565": {
            "connections": {
              "EXPIRED": "3684dc73-660a-406d-b461-706f5e6190cc",
              "FALSE": "e301438c-0bd0-429c-ab0c-66126501069a",
              "TRUE": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0",
              "WAITING": "1983a15a-f57e-4b4e-85c1-62c29e816132"
            },
            "displayName": "Push Result Verifier Node",
            "nodeType": "PushResultVerifierNode",
            "x": 788,
            "y": 93.015625,
            "version": 1
          },
          "3684dc73-660a-406d-b461-706f5e6190cc": {
            "connections": {
              "Reject": "e301438c-0bd0-429c-ab0c-66126501069a",
              "Retry": "d6ba5460-9fc5-4b2c-9b3d-96b6ab9e407a"
            },
            "displayName": "Retry Limit Decision",
            "nodeType": "RetryLimitDecisionNode",
            "x": 805,
            "y": 324,
            "version": 1
          },
          "4b13cd20-4e83-4bb0-b1c2-8a91a0f7c928": {
            "connections": {
              "FAILURE": "e301438c-0bd0-429c-ab0c-66126501069a",
              "NOT_REGISTERED": "e301438c-0bd0-429c-ab0c-66126501069a",
              "SENT": "8b2b3bdd-4c26-4622-846b-fc2249d13729"
            },
            "displayName": "Push Sender",
            "nodeType": "PushAuthenticationSenderNode",
            "x": 380,
            "y": 1173.015625,
            "version": 1
          },
          "749b200c-a4ee-4bd0-8ad2-95dcde313076": {
            "connections": {
              "EXPIRED": "c62acbca-819b-48e7-8c46-4102e605549d",
              "FALSE": "e301438c-0bd0-429c-ab0c-66126501069a",
              "TRUE": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0",
              "WAITING": "8b2b3bdd-4c26-4622-846b-fc2249d13729"
            },
            "displayName": "Push Result Verifier Node",
            "nodeType": "PushResultVerifierNode",
            "x": 803.3333333333335,
            "y": 1346.359375,
            "version": 1
          },
          "75568f3a-e111-4b0f-b028-7ba08238cf7f": {
            "connections": {
              "Reject": "e301438c-0bd0-429c-ab0c-66126501069a",
              "Retry": "fdb173c0-5152-481f-abb3-4407b815c1e4"
            },
            "displayName": "Retry Limit Decision",
            "nodeType": "RetryLimitDecisionNode",
            "x": 815,
            "y": 769.015625,
            "version": 1
          },
          "8b2b3bdd-4c26-4622-846b-fc2249d13729": {
            "connections": {
              "DONE": "749b200c-a4ee-4bd0-8ad2-95dcde313076",
              "EXITED": "c62acbca-819b-48e7-8c46-4102e605549d"
            },
            "displayName": "Push Wait Node",
            "nodeType": "PushWaitNode",
            "x": 387,
            "y": 1386.015625,
            "version": 1
          },
          "8dbd8cc0-d9ab-4ce8-978a-35c2cd0b228a": {
            "connections": {
              "outcome": "4b13cd20-4e83-4bb0-b1c2-8a91a0f7c928"
            },
            "displayName": "Recovery Code Display Node",
            "nodeType": "RecoveryCodeDisplayNode",
            "x": 352,
            "y": 996.015625,
            "version": 1
          },
          "bfb6314c-da25-45fb-ac97-1746de12b0f8": {
            "connections": {
              "false": "75568f3a-e111-4b0f-b028-7ba08238cf7f",
              "true": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "Collect Recovery Code",
            "nodeType": "PageNode",
            "x": 815,
            "y": 473.015625,
            "version": 1
          },
          "c62acbca-819b-48e7-8c46-4102e605549d": {
            "connections": {
              "Reject": "e301438c-0bd0-429c-ab0c-66126501069a",
              "Retry": "4b13cd20-4e83-4bb0-b1c2-8a91a0f7c928"
            },
            "displayName": "Retry Limit Decision",
            "nodeType": "RetryLimitDecisionNode",
            "x": 827,
            "y": 1167.515625,
            "version": 1
          },
          "d6ba5460-9fc5-4b2c-9b3d-96b6ab9e407a": {
            "connections": {
              "FAILURE": "e301438c-0bd0-429c-ab0c-66126501069a",
              "NOT_REGISTERED": "da49ca6e-71a7-4a9e-abc9-bf503313825c",
              "SENT": "1983a15a-f57e-4b4e-85c1-62c29e816132"
            },
            "displayName": "Push Sender",
            "nodeType": "PushAuthenticationSenderNode",
            "x": 374,
            "y": 316.015625,
            "version": 1
          },
          "da49ca6e-71a7-4a9e-abc9-bf503313825c": {
            "connections": {
              "outcome": "f37214d7-9c0a-4c6e-bda9-ab11cdef0f55"
            },
            "displayName": "Get Authenticator App",
            "nodeType": "GetAuthenticatorAppNode",
            "x": 360,
            "y": 592.015625,
            "version": 1
          },
          "f37214d7-9c0a-4c6e-bda9-ab11cdef0f55": {
            "connections": {
              "failureOutcome": "e301438c-0bd0-429c-ab0c-66126501069a",
              "successOutcome": "8dbd8cc0-d9ab-4ce8-978a-35c2cd0b228a",
              "timeoutOutcome": "da49ca6e-71a7-4a9e-abc9-bf503313825c"
            },
            "displayName": "Push Registration",
            "nodeType": "PushRegistrationNode",
            "x": 378,
            "y": 780.015625,
            "version": 1
          },
          "fdb173c0-5152-481f-abb3-4407b815c1e4": {
            "connections": {
              "true": "bfb6314c-da25-45fb-ac97-1746de12b0f8"
            },
            "displayName": "Set Invalid Code Error Message",
            "nodeType": "ScriptedDecisionNode",
            "x": 780,
            "y": 997.015625,
            "version": 1
          }
        },
        "staticNodes": {
          "70e691a5-1e33-4ac3-a356-e7b6d60d92e0": {
            "x": 1275,
            "y": 117
          },
          "e301438c-0bd0-429c-ab0c-66126501069a": {
            "x": 1173,
            "y": 846
          },
          "startNode": {
            "x": 50,
            "y": 250
          }
        }
      },
      "nodes": {
        "1983a15a-f57e-4b4e-85c1-62c29e816132": {
          "_id": "1983a15a-f57e-4b4e-85c1-62c29e816132",
          "_rev": "-1656671156",
          "challengeMessage": {},
          "exitMessage": {},
          "waitingMessage": {},
          "secondsToWait": 5,
          "_type": {
            "_id": "PushWaitNode",
            "name": "Push Wait Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "DONE",
              "displayName": "Done"
            },
            {
              "id": "EXITED",
              "displayName": "Exit"
            }
          ]
        },
        "1f583b80-7382-4903-8c29-2424b30e9565": {
          "_id": "1f583b80-7382-4903-8c29-2424b30e9565",
          "_rev": "-1273026798",
          "_type": {
            "_id": "PushResultVerifierNode",
            "name": "Push Result Verifier Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "TRUE",
              "displayName": "Success"
            },
            {
              "id": "FALSE",
              "displayName": "Failure"
            },
            {
              "id": "EXPIRED",
              "displayName": "Expired"
            },
            {
              "id": "WAITING",
              "displayName": "Waiting"
            }
          ]
        },
        "3684dc73-660a-406d-b461-706f5e6190cc": {
          "_id": "3684dc73-660a-406d-b461-706f5e6190cc",
          "_rev": "-469534087",
          "incrementUserAttributeOnFailure": true,
          "retryLimit": 3,
          "_type": {
            "_id": "RetryLimitDecisionNode",
            "name": "Retry Limit Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Retry",
              "displayName": "Retry"
            },
            {
              "id": "Reject",
              "displayName": "Reject"
            }
          ]
        },
        "4b13cd20-4e83-4bb0-b1c2-8a91a0f7c928": {
          "_id": "4b13cd20-4e83-4bb0-b1c2-8a91a0f7c928",
          "_rev": "670906971",
          "captureFailure": true,
          "contextInfo": false,
          "userMessage": {},
          "pushType": "DEFAULT",
          "customPayload": [],
          "mandatory": true,
          "messageTimeout": 120000,
          "_type": {
            "_id": "PushAuthenticationSenderNode",
            "name": "Push Sender",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "SENT",
              "displayName": "Sent"
            },
            {
              "id": "NOT_REGISTERED",
              "displayName": "Not Registered"
            },
            {
              "id": "FAILURE",
              "displayName": "Failure"
            }
          ]
        },
        "749b200c-a4ee-4bd0-8ad2-95dcde313076": {
          "_id": "749b200c-a4ee-4bd0-8ad2-95dcde313076",
          "_rev": "-2002543941",
          "_type": {
            "_id": "PushResultVerifierNode",
            "name": "Push Result Verifier Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "TRUE",
              "displayName": "Success"
            },
            {
              "id": "FALSE",
              "displayName": "Failure"
            },
            {
              "id": "EXPIRED",
              "displayName": "Expired"
            },
            {
              "id": "WAITING",
              "displayName": "Waiting"
            }
          ]
        },
        "75568f3a-e111-4b0f-b028-7ba08238cf7f": {
          "_id": "75568f3a-e111-4b0f-b028-7ba08238cf7f",
          "_rev": "-175161442",
          "incrementUserAttributeOnFailure": true,
          "retryLimit": 3,
          "_type": {
            "_id": "RetryLimitDecisionNode",
            "name": "Retry Limit Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Retry",
              "displayName": "Retry"
            },
            {
              "id": "Reject",
              "displayName": "Reject"
            }
          ]
        },
        "8b2b3bdd-4c26-4622-846b-fc2249d13729": {
          "_id": "8b2b3bdd-4c26-4622-846b-fc2249d13729",
          "_rev": "1409672610",
          "challengeMessage": {},
          "exitMessage": {},
          "waitingMessage": {},
          "secondsToWait": 5,
          "_type": {
            "_id": "PushWaitNode",
            "name": "Push Wait Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "DONE",
              "displayName": "Done"
            },
            {
              "id": "EXITED",
              "displayName": "Exit"
            }
          ]
        },
        "8dbd8cc0-d9ab-4ce8-978a-35c2cd0b228a": {
          "_id": "8dbd8cc0-d9ab-4ce8-978a-35c2cd0b228a",
          "_rev": "-1072715646",
          "_type": {
            "_id": "RecoveryCodeDisplayNode",
            "name": "Recovery Code Display Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "bfb6314c-da25-45fb-ac97-1746de12b0f8": {
          "_id": "bfb6314c-da25-45fb-ac97-1746de12b0f8",
          "_rev": "-546902734",
          "nodes": [
            {
              "_id": "6ee1dce2-9e16-46f2-82e9-1e7a961c46d5",
              "nodeType": "ScriptedDecisionNode",
              "nodeVersion": 1,
              "displayName": "Validate Recovery Code"
            },
            {
              "_id": "bdcc8ed0-da62-4580-8706-7dcaf2042250",
              "nodeType": "RecoveryCodeCollectorDecisionNode",
              "nodeVersion": 1,
              "displayName": "Recovery Code Collector Decision"
            }
          ],
          "pageDescription": {},
          "pageHeader": {
            "en": "Enter Recovery Code"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "c62acbca-819b-48e7-8c46-4102e605549d": {
          "_id": "c62acbca-819b-48e7-8c46-4102e605549d",
          "_rev": "1615153485",
          "incrementUserAttributeOnFailure": true,
          "retryLimit": 3,
          "_type": {
            "_id": "RetryLimitDecisionNode",
            "name": "Retry Limit Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Retry",
              "displayName": "Retry"
            },
            {
              "id": "Reject",
              "displayName": "Reject"
            }
          ]
        },
        "d6ba5460-9fc5-4b2c-9b3d-96b6ab9e407a": {
          "_id": "d6ba5460-9fc5-4b2c-9b3d-96b6ab9e407a",
          "_rev": "-1495257947",
          "captureFailure": true,
          "contextInfo": false,
          "userMessage": {},
          "pushType": "DEFAULT",
          "customPayload": [],
          "mandatory": true,
          "messageTimeout": 120000,
          "_type": {
            "_id": "PushAuthenticationSenderNode",
            "name": "Push Sender",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "SENT",
              "displayName": "Sent"
            },
            {
              "id": "NOT_REGISTERED",
              "displayName": "Not Registered"
            },
            {
              "id": "FAILURE",
              "displayName": "Failure"
            }
          ]
        },
        "da49ca6e-71a7-4a9e-abc9-bf503313825c": {
          "_id": "da49ca6e-71a7-4a9e-abc9-bf503313825c",
          "_rev": "-1921130407",
          "continueLabel": {},
          "message": {},
          "googleLink": "https://play.google.com/store/apps/details?id=com.forgerock.authenticator",
          "appleLink": "https://itunes.apple.com/app/forgerock-authenticator/id1038442926",
          "_type": {
            "_id": "GetAuthenticatorAppNode",
            "name": "Get Authenticator App",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "f37214d7-9c0a-4c6e-bda9-ab11cdef0f55": {
          "_id": "f37214d7-9c0a-4c6e-bda9-ab11cdef0f55",
          "_rev": "1991735034",
          "bgColor": "032b75",
          "generateRecoveryCodes": true,
          "scanQRCodeMessage": {},
          "accountName": "USERNAME",
          "issuer": "ForgeRock",
          "imgUrl": "",
          "timeout": 60,
          "_type": {
            "_id": "PushRegistrationNode",
            "name": "Push Registration",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "successOutcome",
              "displayName": "Success"
            },
            {
              "id": "failureOutcome",
              "displayName": "Failure"
            },
            {
              "id": "timeoutOutcome",
              "displayName": "Time Out"
            }
          ]
        },
        "fdb173c0-5152-481f-abb3-4407b815c1e4": {
          "_id": "fdb173c0-5152-481f-abb3-4407b815c1e4",
          "_rev": "-590978883",
          "script": "d7533919-235c-4548-99db-dd9cb33344ae",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "invalidCodeErrorMessage",
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "null"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        }
      },
      "innerNodes": {
        "6ee1dce2-9e16-46f2-82e9-1e7a961c46d5": {
          "_id": "6ee1dce2-9e16-46f2-82e9-1e7a961c46d5",
          "_rev": "691929287",
          "script": "a6c73f01-13f2-428d-9fc2-8fccbdc4b2d0",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails",
            "invalidCodeErrorMessage"
          ],
          "inputs": [
            "invalidCodeErrorMessage"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "bdcc8ed0-da62-4580-8706-7dcaf2042250": {
          "_id": "bdcc8ed0-da62-4580-8706-7dcaf2042250",
          "_rev": "1324537806",
          "recoveryCodeType": "PUSH",
          "_type": {
            "_id": "RecoveryCodeCollectorDecisionNode",
            "name": "Recovery Code Collector Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        }
      },
      "scripts": {
        "d7533919-235c-4548-99db-dd9cb33344ae": {
          "_id": "d7533919-235c-4548-99db-dd9cb33344ae",
          "name": "Threat Detection - Set Invalid code error message",
          "description": "Script to set invalid code error message",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: null\\n    - Script Outputs: \\\"invalidCodeErrorMessage\\\", \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\n// Set the below error message in shared state, can be displayed on the last UI Node\\n\\ntry {\\n    nodeState.putShared(\\\"invalidCodeErrorMessage\\\", \\\"Invalid Code\\\");\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error\\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925703,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083351,
          "evaluatorVersion": "2.0"
        },
        "a6c73f01-13f2-428d-9fc2-8fccbdc4b2d0": {
          "_id": "a6c73f01-13f2-428d-9fc2-8fccbdc4b2d0",
          "name": "Threat Detection - Validate Recovery Code input",
          "description": "Script to validate Recovery code input, sets constraints, and enables/disables the submit button based on validity",
          "script": "\"// /*\\n//   - Data made available by nodes that have already executed are available in the sharedState variable.\\n//   - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n//  */\\n\\n/*\\n    - Script Inputs: \\\"invalidCodeErrorMessage\\\"\\n    - Script Outputs: \\\"errorMessage\\\", \\\"errorDetails\\\", \\\"invalidCodeErrorMessage\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\ntry {\\n    function validateInput() {\\n        return String(\\\" \\\\n\\\\\\n                    const submitBtn = document.querySelectorAll('button[type=\\\\\\\"submit\\\\\\\"]')[0]; \\\\n\\\\\\n                    if(submitBtn) submitBtn.disabled = true; \\\\n\\\\\\n                    function go(obs) { \\\\n\\\\\\n                        const recoveryCode = document.querySelectorAll('input[data-vv-as=\\\\\\\"Recovery Code\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (recoveryCode && submitBtn) { \\\\n\\\\\\n                            // Set the maxlength attribute to 10 \\\\n\\\\\\n                            recoveryCode.setAttribute('maxlength', 10); \\\\n\\\\\\n                            const enableSubmitBtn = () => { \\\\n\\\\\\n                                // Check input validity before enabling submit button \\\\n\\\\\\n                                const isValidInput = recoveryCode.value.length === 10; \\\\n\\\\\\n                                if (isValidInput) { \\\\n\\\\\\n                                    submitBtn.disabled = false; \\\\n\\\\\\n                                } else { \\\\n\\\\\\n                                    submitBtn.disabled = true; \\\\n\\\\\\n                                } \\\\n\\\\\\n                            }; \\\\n\\\\\\n                            // Revalidate before form submission \\\\n\\\\\\n                            submitBtn.addEventListener('click', (event) => { \\\\n\\\\\\n                                const isValidInput = recoveryCode.value.length === 10; \\\\n\\\\\\n                                if (!isValidInput) { \\\\n\\\\\\n                                    event.preventDefault(); \\\\n\\\\\\n                                    submitBtn.disabled = true; \\\\n\\\\\\n                                } \\\\n\\\\\\n                            }); \\\\n\\\\\\n                            recoveryCode.addEventListener('input', enableSubmitBtn); \\\\n\\\\\\n                            if (obs) obs.disconnect(); \\\\n\\\\\\n                            return; \\\\n\\\\\\n                       } \\\\n\\\\\\n                      } \\\\n\\\\\\n                      if (document.querySelectorAll('input[data-vv-as=\\\\\\\"Recovery Code\\\\\\\"]')[0]) go(); \\\\n\\\\\\n                      else { \\\\n\\\\\\n                        const observer = new MutationObserver((mutations, obs) => { go(obs); }); \\\\n\\\\\\n                        observer.observe(document, { childList: true, subtree: true }); \\\\n\\\\\\n                      } \\\\n\\\\\\n        \\\");\\n    }\\n\\n    var invalidCodeErrorMessage = nodeState.get(\\\"invalidCodeErrorMessage\\\");\\n    nodeState.putShared(\\\"invalidCodeErrorMessage\\\", \\\"\\\");\\n    \\n    if (callbacks.isEmpty()) {                \\n        // Display error message if invalid code entered by user\\n        if (invalidCodeErrorMessage && invalidCodeErrorMessage.length) callbacksBuilder.textOutputCallback(2, invalidCodeErrorMessage);\\n        // Request callbacks\\n        callbacksBuilder.scriptTextOutputCallback(validateInput());\\n    }\\n    // Go to true path\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error  \\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925690,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083411,
          "evaluatorVersion": "2.0"
        }
      },
      "emailTemplates": {},
      "socialIdentityProviders": {},
      "themes": [],
      "saml2Entities": {},
      "circlesOfTrust": {}
    },
    "Combined OATH And PUSH MFA Methods Registration - Inner Journey": {
      "tree": {
        "_id": "Combined OATH And PUSH MFA Methods Registration - Inner Journey",
        "_rev": "-2143701264",
        "identityResource": "managed/alpha_user",
        "entryNodeId": "949627a6-e9b1-46de-bb16-c7e91a2ecc54",
        "innerTreeOnly": true,
        "noSession": false,
        "mustRun": false,
        "enabled": true,
        "transactionalOnly": false,
        "uiConfig": {
          "categories": "[\"Threat Detection\"]"
        },
        "nodes": {
          "07895993-12ab-40d7-a525-ff441b14cf8a": {
            "connections": {
              "failureOutcome": "e301438c-0bd0-429c-ab0c-66126501069a",
              "successOutcome": "fe4d16d8-79fc-4b66-b8b3-6071fe4943da",
              "timeoutOutcome": "2342127c-ca12-4f23-9ac4-ab0884f00b5c"
            },
            "displayName": "Combined MFA Registration",
            "nodeType": "CombinedMultiFactorRegistrationNode",
            "x": 211,
            "y": 1163,
            "version": 1
          },
          "2342127c-ca12-4f23-9ac4-ab0884f00b5c": {
            "connections": {
              "Reject": "e301438c-0bd0-429c-ab0c-66126501069a",
              "Retry": "07895993-12ab-40d7-a525-ff441b14cf8a"
            },
            "displayName": "Retry Limit Decision",
            "nodeType": "RetryLimitDecisionNode",
            "x": 259,
            "y": 1450,
            "version": 1
          },
          "2a6921f1-3855-4f7b-9795-58d061b13d93": {
            "connections": {
              "failureOutcome": "4aa24fe5-6bd4-4abf-bcbc-4522c8f66ef4",
              "notRegisteredOutcome": "e301438c-0bd0-429c-ab0c-66126501069a",
              "recoveryCodeOutcome": "5214aa12-ba72-472a-b0d7-cc3e0ceb3d16",
              "successOutcome": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "Enter Verification Code",
            "nodeType": "PageNode",
            "x": 609,
            "y": 307.015625,
            "version": 1
          },
          "31de72c6-6b95-45f7-844f-2565516e52e9": {
            "connections": {
              "true": "2a6921f1-3855-4f7b-9795-58d061b13d93"
            },
            "displayName": "Set Invalid Code Error Message",
            "nodeType": "ScriptedDecisionNode",
            "x": 940,
            "y": 104.015625,
            "version": 1
          },
          "4aa24fe5-6bd4-4abf-bcbc-4522c8f66ef4": {
            "connections": {
              "Reject": "e301438c-0bd0-429c-ab0c-66126501069a",
              "Retry": "31de72c6-6b95-45f7-844f-2565516e52e9"
            },
            "displayName": "Retry Limit Decision",
            "nodeType": "RetryLimitDecisionNode",
            "x": 609,
            "y": 73.015625,
            "version": 1
          },
          "4d93415d-2d1e-4493-8632-0bf71f267e4e": {
            "connections": {
              "DONE": "a14b3060-fea5-48e9-8e48-85de980aa488",
              "EXITED": "75207a75-7a74-4a78-baec-8b8ab5e7c95d"
            },
            "displayName": "Push Wait Node",
            "nodeType": "PushWaitNode",
            "x": 596.5,
            "y": 954.1927083333334,
            "version": 1
          },
          "5137a446-fbe8-4207-bb9c-e1e56c845c09": {
            "connections": {
              "EXPIRED": "2a6921f1-3855-4f7b-9795-58d061b13d93",
              "FALSE": "e301438c-0bd0-429c-ab0c-66126501069a",
              "TRUE": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0",
              "WAITING": "b39262dc-dbc8-42fb-aa35-1570c54fab5a"
            },
            "displayName": "Push Result Verifier Node",
            "nodeType": "PushResultVerifierNode",
            "x": 200,
            "y": 87,
            "version": 1
          },
          "5214aa12-ba72-472a-b0d7-cc3e0ceb3d16": {
            "connections": {
              "false": "b5091cff-8203-47f8-81a5-39a428a0f55f",
              "true": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "Recovery Code Page Node",
            "nodeType": "PageNode",
            "x": 609.1666666666667,
            "y": 638.6927083333334,
            "version": 1
          },
          "64e8bd42-5b76-4eff-a8fe-c50ffb4877bb": {
            "connections": {
              "NOT_REGISTERED": "e301438c-0bd0-429c-ab0c-66126501069a",
              "SENT": "4d93415d-2d1e-4493-8632-0bf71f267e4e"
            },
            "displayName": "Push Sender",
            "nodeType": "PushAuthenticationSenderNode",
            "x": 601,
            "y": 1163.5729166666667,
            "version": 1
          },
          "75207a75-7a74-4a78-baec-8b8ab5e7c95d": {
            "connections": {
              "failureOutcome": "dfa400c8-c1e7-494b-aab5-ccfae3351c29",
              "notRegisteredOutcome": "e301438c-0bd0-429c-ab0c-66126501069a",
              "successOutcome": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "Enter Verification Code",
            "nodeType": "PageNode",
            "x": 996,
            "y": 1144.015625,
            "version": 1
          },
          "80185ded-8070-4254-9114-85dc3edb41be": {
            "connections": {
              "outcome": "07895993-12ab-40d7-a525-ff441b14cf8a"
            },
            "displayName": "Get Authenticator App",
            "nodeType": "GetAuthenticatorAppNode",
            "x": 224,
            "y": 964.421875,
            "version": 1
          },
          "8759f933-0f79-4b5e-93e7-b25889a42a76": {
            "connections": {
              "true": "75207a75-7a74-4a78-baec-8b8ab5e7c95d"
            },
            "displayName": "Set Invalid Code Error Message",
            "nodeType": "ScriptedDecisionNode",
            "x": 1375,
            "y": 1456.015625,
            "version": 1
          },
          "949627a6-e9b1-46de-bb16-c7e91a2ecc54": {
            "connections": {
              "NOT_REGISTERED": "80185ded-8070-4254-9114-85dc3edb41be",
              "SENT": "b39262dc-dbc8-42fb-aa35-1570c54fab5a"
            },
            "displayName": "Push Sender",
            "nodeType": "PushAuthenticationSenderNode",
            "x": 239,
            "y": 674,
            "version": 1
          },
          "a14b3060-fea5-48e9-8e48-85de980aa488": {
            "connections": {
              "EXPIRED": "75207a75-7a74-4a78-baec-8b8ab5e7c95d",
              "FALSE": "e301438c-0bd0-429c-ab0c-66126501069a",
              "TRUE": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0",
              "WAITING": "4d93415d-2d1e-4493-8632-0bf71f267e4e"
            },
            "displayName": "Push Result Verifier Node",
            "nodeType": "PushResultVerifierNode",
            "x": 976.5,
            "y": 936.1927083333334,
            "version": 1
          },
          "aebb1339-d0f2-4cc9-ad5e-1fce3dd6eecd": {
            "connections": {
              "true": "5214aa12-ba72-472a-b0d7-cc3e0ceb3d16"
            },
            "displayName": "Set Invalid Code Error Message",
            "nodeType": "ScriptedDecisionNode",
            "x": 949,
            "y": 647.015625,
            "version": 1
          },
          "b39262dc-dbc8-42fb-aa35-1570c54fab5a": {
            "connections": {
              "DONE": "5137a446-fbe8-4207-bb9c-e1e56c845c09",
              "EXITED": "2a6921f1-3855-4f7b-9795-58d061b13d93"
            },
            "displayName": "Push Wait Node",
            "nodeType": "PushWaitNode",
            "x": 236,
            "y": 405,
            "version": 1
          },
          "b5091cff-8203-47f8-81a5-39a428a0f55f": {
            "connections": {
              "Reject": "e301438c-0bd0-429c-ab0c-66126501069a",
              "Retry": "aebb1339-d0f2-4cc9-ad5e-1fce3dd6eecd"
            },
            "displayName": "Retry Limit Decision",
            "nodeType": "RetryLimitDecisionNode",
            "x": 990,
            "y": 780.015625,
            "version": 1
          },
          "dfa400c8-c1e7-494b-aab5-ccfae3351c29": {
            "connections": {
              "Reject": "e301438c-0bd0-429c-ab0c-66126501069a",
              "Retry": "8759f933-0f79-4b5e-93e7-b25889a42a76"
            },
            "displayName": "Retry Limit Decision",
            "nodeType": "RetryLimitDecisionNode",
            "x": 1018,
            "y": 1434.03125,
            "version": 1
          },
          "fe4d16d8-79fc-4b66-b8b3-6071fe4943da": {
            "connections": {
              "outcome": "64e8bd42-5b76-4eff-a8fe-c50ffb4877bb"
            },
            "displayName": "Recovery Code Display Node",
            "nodeType": "RecoveryCodeDisplayNode",
            "x": 575.8888888888889,
            "y": 1435.5729166666667,
            "version": 1
          }
        },
        "staticNodes": {
          "70e691a5-1e33-4ac3-a356-e7b6d60d92e0": {
            "x": 2334,
            "y": 817.3333333333333
          },
          "e301438c-0bd0-429c-ab0c-66126501069a": {
            "x": 2363,
            "y": 1506.6666666666667
          },
          "startNode": {
            "x": 70,
            "y": 347.5
          }
        }
      },
      "nodes": {
        "07895993-12ab-40d7-a525-ff441b14cf8a": {
          "_id": "07895993-12ab-40d7-a525-ff441b14cf8a",
          "_rev": "-1439652645",
          "addChecksum": false,
          "bgColor": "032b75",
          "generateRecoveryCodes": true,
          "truncationOffset": -1,
          "algorithm": "TOTP",
          "passwordLength": "SIX_DIGITS",
          "totpTimeInterval": 30,
          "policiesJson": "",
          "scanQRCodeMessage": {},
          "accountName": "USERNAME",
          "issuer": "ForgeRock",
          "minSharedSecretLength": 32,
          "totpHashAlgorithm": "HMAC_SHA1",
          "imgUrl": "",
          "timeout": 60,
          "_type": {
            "_id": "CombinedMultiFactorRegistrationNode",
            "name": "Combined MFA Registration",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "successOutcome",
              "displayName": "Success"
            },
            {
              "id": "failureOutcome",
              "displayName": "Failure"
            },
            {
              "id": "timeoutOutcome",
              "displayName": "Time Out"
            }
          ]
        },
        "2342127c-ca12-4f23-9ac4-ab0884f00b5c": {
          "_id": "2342127c-ca12-4f23-9ac4-ab0884f00b5c",
          "_rev": "-965428006",
          "incrementUserAttributeOnFailure": true,
          "retryLimit": 3,
          "_type": {
            "_id": "RetryLimitDecisionNode",
            "name": "Retry Limit Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Retry",
              "displayName": "Retry"
            },
            {
              "id": "Reject",
              "displayName": "Reject"
            }
          ]
        },
        "2a6921f1-3855-4f7b-9795-58d061b13d93": {
          "_id": "2a6921f1-3855-4f7b-9795-58d061b13d93",
          "_rev": "699994341",
          "nodes": [
            {
              "_id": "608dbf81-86c3-403b-afe0-3a79d34c13d1",
              "nodeType": "ScriptedDecisionNode",
              "nodeVersion": 1,
              "displayName": "Validate Verification Code"
            },
            {
              "_id": "edfd6dd2-aa20-461f-9d7a-8ac2579bc4bc",
              "nodeType": "OathTokenVerifierNode",
              "nodeVersion": 1,
              "displayName": "OATH Token Verifier"
            }
          ],
          "pageDescription": {},
          "pageHeader": {
            "en": "Enter Verification Code"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "successOutcome",
              "displayName": "Success"
            },
            {
              "id": "failureOutcome",
              "displayName": "Failure"
            },
            {
              "id": "notRegisteredOutcome",
              "displayName": "Not registered"
            },
            {
              "id": "recoveryCodeOutcome",
              "displayName": "Recovery Code"
            }
          ]
        },
        "31de72c6-6b95-45f7-844f-2565516e52e9": {
          "_id": "31de72c6-6b95-45f7-844f-2565516e52e9",
          "_rev": "-1670972446",
          "script": "d7533919-235c-4548-99db-dd9cb33344ae",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "invalidCodeErrorMessage",
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "null"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "4aa24fe5-6bd4-4abf-bcbc-4522c8f66ef4": {
          "_id": "4aa24fe5-6bd4-4abf-bcbc-4522c8f66ef4",
          "_rev": "-754253126",
          "incrementUserAttributeOnFailure": true,
          "retryLimit": 3,
          "_type": {
            "_id": "RetryLimitDecisionNode",
            "name": "Retry Limit Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Retry",
              "displayName": "Retry"
            },
            {
              "id": "Reject",
              "displayName": "Reject"
            }
          ]
        },
        "4d93415d-2d1e-4493-8632-0bf71f267e4e": {
          "_id": "4d93415d-2d1e-4493-8632-0bf71f267e4e",
          "_rev": "248233540",
          "challengeMessage": {},
          "exitMessage": {},
          "waitingMessage": {},
          "secondsToWait": 5,
          "_type": {
            "_id": "PushWaitNode",
            "name": "Push Wait Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "DONE",
              "displayName": "Done"
            },
            {
              "id": "EXITED",
              "displayName": "Exit"
            }
          ]
        },
        "5137a446-fbe8-4207-bb9c-e1e56c845c09": {
          "_id": "5137a446-fbe8-4207-bb9c-e1e56c845c09",
          "_rev": "-810998085",
          "_type": {
            "_id": "PushResultVerifierNode",
            "name": "Push Result Verifier Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "TRUE",
              "displayName": "Success"
            },
            {
              "id": "FALSE",
              "displayName": "Failure"
            },
            {
              "id": "EXPIRED",
              "displayName": "Expired"
            },
            {
              "id": "WAITING",
              "displayName": "Waiting"
            }
          ]
        },
        "5214aa12-ba72-472a-b0d7-cc3e0ceb3d16": {
          "_id": "5214aa12-ba72-472a-b0d7-cc3e0ceb3d16",
          "_rev": "-1993962183",
          "nodes": [
            {
              "_id": "decca9d6-6a25-4baa-bcf3-112a8c6d6b6e",
              "nodeType": "ScriptedDecisionNode",
              "nodeVersion": 1,
              "displayName": "Validate Recovery Code"
            },
            {
              "_id": "5641ad47-ea89-4afb-b68d-8919a909bbc8",
              "nodeType": "RecoveryCodeCollectorDecisionNode",
              "nodeVersion": 1,
              "displayName": "Recovery Code Collector Decision"
            }
          ],
          "pageDescription": {},
          "pageHeader": {
            "en": "Enter Recovery Code"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "64e8bd42-5b76-4eff-a8fe-c50ffb4877bb": {
          "_id": "64e8bd42-5b76-4eff-a8fe-c50ffb4877bb",
          "_rev": "359932375",
          "captureFailure": false,
          "contextInfo": false,
          "userMessage": {},
          "pushType": "DEFAULT",
          "customPayload": [],
          "mandatory": true,
          "messageTimeout": 120000,
          "_type": {
            "_id": "PushAuthenticationSenderNode",
            "name": "Push Sender",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "SENT",
              "displayName": "Sent"
            },
            {
              "id": "NOT_REGISTERED",
              "displayName": "Not Registered"
            }
          ]
        },
        "75207a75-7a74-4a78-baec-8b8ab5e7c95d": {
          "_id": "75207a75-7a74-4a78-baec-8b8ab5e7c95d",
          "_rev": "109615158",
          "nodes": [
            {
              "_id": "17b8af5c-7dd9-4b26-9bd7-ebcea9548a97",
              "nodeType": "ScriptedDecisionNode",
              "nodeVersion": 1,
              "displayName": "Validate Verification Code"
            },
            {
              "_id": "ae96d2ce-269a-43da-a567-22c5c894c1b1",
              "nodeType": "OathTokenVerifierNode",
              "nodeVersion": 1,
              "displayName": "OATH Token Verifier"
            }
          ],
          "pageDescription": {},
          "pageHeader": {
            "en": "Enter Verification Code"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "successOutcome",
              "displayName": "Success"
            },
            {
              "id": "failureOutcome",
              "displayName": "Failure"
            },
            {
              "id": "notRegisteredOutcome",
              "displayName": "Not registered"
            }
          ]
        },
        "80185ded-8070-4254-9114-85dc3edb41be": {
          "_id": "80185ded-8070-4254-9114-85dc3edb41be",
          "_rev": "1388703577",
          "continueLabel": {},
          "message": {},
          "googleLink": "https://play.google.com/store/apps/details?id=com.forgerock.authenticator",
          "appleLink": "https://itunes.apple.com/app/forgerock-authenticator/id1038442926",
          "_type": {
            "_id": "GetAuthenticatorAppNode",
            "name": "Get Authenticator App",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "8759f933-0f79-4b5e-93e7-b25889a42a76": {
          "_id": "8759f933-0f79-4b5e-93e7-b25889a42a76",
          "_rev": "-1620607580",
          "script": "d7533919-235c-4548-99db-dd9cb33344ae",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "invalidCodeErrorMessage",
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "null"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "949627a6-e9b1-46de-bb16-c7e91a2ecc54": {
          "_id": "949627a6-e9b1-46de-bb16-c7e91a2ecc54",
          "_rev": "-2026889102",
          "captureFailure": false,
          "contextInfo": false,
          "userMessage": {},
          "pushType": "DEFAULT",
          "customPayload": [],
          "mandatory": true,
          "messageTimeout": 120000,
          "_type": {
            "_id": "PushAuthenticationSenderNode",
            "name": "Push Sender",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "SENT",
              "displayName": "Sent"
            },
            {
              "id": "NOT_REGISTERED",
              "displayName": "Not Registered"
            }
          ]
        },
        "a14b3060-fea5-48e9-8e48-85de980aa488": {
          "_id": "a14b3060-fea5-48e9-8e48-85de980aa488",
          "_rev": "391259364",
          "_type": {
            "_id": "PushResultVerifierNode",
            "name": "Push Result Verifier Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "TRUE",
              "displayName": "Success"
            },
            {
              "id": "FALSE",
              "displayName": "Failure"
            },
            {
              "id": "EXPIRED",
              "displayName": "Expired"
            },
            {
              "id": "WAITING",
              "displayName": "Waiting"
            }
          ]
        },
        "aebb1339-d0f2-4cc9-ad5e-1fce3dd6eecd": {
          "_id": "aebb1339-d0f2-4cc9-ad5e-1fce3dd6eecd",
          "_rev": "-95212608",
          "script": "d7533919-235c-4548-99db-dd9cb33344ae",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "invalidCodeErrorMessage",
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "null"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "b39262dc-dbc8-42fb-aa35-1570c54fab5a": {
          "_id": "b39262dc-dbc8-42fb-aa35-1570c54fab5a",
          "_rev": "-1932605516",
          "challengeMessage": {},
          "exitMessage": {},
          "waitingMessage": {},
          "secondsToWait": 5,
          "_type": {
            "_id": "PushWaitNode",
            "name": "Push Wait Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "DONE",
              "displayName": "Done"
            },
            {
              "id": "EXITED",
              "displayName": "Exit"
            }
          ]
        },
        "b5091cff-8203-47f8-81a5-39a428a0f55f": {
          "_id": "b5091cff-8203-47f8-81a5-39a428a0f55f",
          "_rev": "-562566101",
          "incrementUserAttributeOnFailure": true,
          "retryLimit": 3,
          "_type": {
            "_id": "RetryLimitDecisionNode",
            "name": "Retry Limit Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Retry",
              "displayName": "Retry"
            },
            {
              "id": "Reject",
              "displayName": "Reject"
            }
          ]
        },
        "dfa400c8-c1e7-494b-aab5-ccfae3351c29": {
          "_id": "dfa400c8-c1e7-494b-aab5-ccfae3351c29",
          "_rev": "-1183261246",
          "incrementUserAttributeOnFailure": true,
          "retryLimit": 3,
          "_type": {
            "_id": "RetryLimitDecisionNode",
            "name": "Retry Limit Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Retry",
              "displayName": "Retry"
            },
            {
              "id": "Reject",
              "displayName": "Reject"
            }
          ]
        },
        "fe4d16d8-79fc-4b66-b8b3-6071fe4943da": {
          "_id": "fe4d16d8-79fc-4b66-b8b3-6071fe4943da",
          "_rev": "1179620862",
          "_type": {
            "_id": "RecoveryCodeDisplayNode",
            "name": "Recovery Code Display Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        }
      },
      "innerNodes": {
        "608dbf81-86c3-403b-afe0-3a79d34c13d1": {
          "_id": "608dbf81-86c3-403b-afe0-3a79d34c13d1",
          "_rev": "-1206530730",
          "script": "87cc8351-0d8c-4879-acee-6ddc72b29edc",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails",
            "invalidCodeErrorMessage"
          ],
          "inputs": [
            "invalidCodeErrorMessage"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "edfd6dd2-aa20-461f-9d7a-8ac2579bc4bc": {
          "_id": "edfd6dd2-aa20-461f-9d7a-8ac2579bc4bc",
          "_rev": "-954666646",
          "totpTimeInterval": 30,
          "maximumAllowedClockDrift": 5,
          "totpTimeSteps": 2,
          "totpHashAlgorithm": "HMAC_SHA1",
          "isRecoveryCodeAllowed": true,
          "algorithm": "TOTP",
          "hotpWindowSize": 100,
          "_type": {
            "_id": "OathTokenVerifierNode",
            "name": "OATH Token Verifier",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "successOutcome",
              "displayName": "Success"
            },
            {
              "id": "failureOutcome",
              "displayName": "Failure"
            },
            {
              "id": "notRegisteredOutcome",
              "displayName": "Not registered"
            },
            {
              "id": "recoveryCodeOutcome",
              "displayName": "Recovery Code"
            }
          ]
        },
        "decca9d6-6a25-4baa-bcf3-112a8c6d6b6e": {
          "_id": "decca9d6-6a25-4baa-bcf3-112a8c6d6b6e",
          "_rev": "1615600565",
          "script": "a6c73f01-13f2-428d-9fc2-8fccbdc4b2d0",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails",
            "invalidCodeErrorMessage"
          ],
          "inputs": [
            "invalidCodeErrorMessage"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "5641ad47-ea89-4afb-b68d-8919a909bbc8": {
          "_id": "5641ad47-ea89-4afb-b68d-8919a909bbc8",
          "_rev": "-1133326271",
          "recoveryCodeType": "OATH",
          "_type": {
            "_id": "RecoveryCodeCollectorDecisionNode",
            "name": "Recovery Code Collector Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "17b8af5c-7dd9-4b26-9bd7-ebcea9548a97": {
          "_id": "17b8af5c-7dd9-4b26-9bd7-ebcea9548a97",
          "_rev": "846656537",
          "script": "87cc8351-0d8c-4879-acee-6ddc72b29edc",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails",
            "invalidCodeErrorMessage"
          ],
          "inputs": [
            "invalidCodeErrorMessage"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "ae96d2ce-269a-43da-a567-22c5c894c1b1": {
          "_id": "ae96d2ce-269a-43da-a567-22c5c894c1b1",
          "_rev": "-1350273177",
          "totpTimeInterval": 30,
          "maximumAllowedClockDrift": 5,
          "totpTimeSteps": 2,
          "totpHashAlgorithm": "HMAC_SHA1",
          "isRecoveryCodeAllowed": false,
          "algorithm": "TOTP",
          "hotpWindowSize": 100,
          "_type": {
            "_id": "OathTokenVerifierNode",
            "name": "OATH Token Verifier",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "successOutcome",
              "displayName": "Success"
            },
            {
              "id": "failureOutcome",
              "displayName": "Failure"
            },
            {
              "id": "notRegisteredOutcome",
              "displayName": "Not registered"
            }
          ]
        }
      },
      "scripts": {
        "d7533919-235c-4548-99db-dd9cb33344ae": {
          "_id": "d7533919-235c-4548-99db-dd9cb33344ae",
          "name": "Threat Detection - Set Invalid code error message",
          "description": "Script to set invalid code error message",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: null\\n    - Script Outputs: \\\"invalidCodeErrorMessage\\\", \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\n// Set the below error message in shared state, can be displayed on the last UI Node\\n\\ntry {\\n    nodeState.putShared(\\\"invalidCodeErrorMessage\\\", \\\"Invalid Code\\\");\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error\\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925703,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083351,
          "evaluatorVersion": "2.0"
        },
        "87cc8351-0d8c-4879-acee-6ddc72b29edc": {
          "_id": "87cc8351-0d8c-4879-acee-6ddc72b29edc",
          "name": "Threat Detection - Validate verification code",
          "description": "Script to validate verification code input, sets constraints, and enables/disables the submit button based on validity",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n*/\\n\\n/*\\n    - Script Inputs: \\\"invalidCodeErrorMessage\\\"\\n    - Script Outputs: \\\"errorMessage\\\", \\\"errorDetails\\\", \\\"invalidCodeErrorMessage\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\ntry {\\n    function validateInput() {\\n        return String(\\\" \\\\n\\\\\\n                    // Validate the verification code \\\\n\\\\\\n                    function validateCode() { \\\\n\\\\\\n                        const submitBtn = document.querySelectorAll('button[type=\\\\\\\"button\\\\\\\"]')[0]; \\\\n\\\\\\n                        const verificationCode = document.querySelectorAll('input[data-vv-as=\\\\\\\"Enter verification code\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (verificationCode) { \\\\n\\\\\\n                            // Set input properties to prevent user tampering \\\\n\\\\\\n                            verificationCode.setAttribute('maxlength', '6'); \\\\n\\\\\\n                            verificationCode.setAttribute('pattern', '[0-9]{6}'); \\\\n\\\\\\n                            verificationCode.setAttribute('inputmode', 'numeric'); \\\\n\\\\\\n                            // Check if the input is exactly 6 digits long and numeric \\\\n\\\\\\n                            const isValidCode = /^[0-9]{6}$/.test(verificationCode.value); \\\\n\\\\\\n                            submitBtn.disabled = !isValidCode; \\\\n\\\\\\n                            return isValidCode; \\\\n\\\\\\n                        } \\\\n\\\\\\n                        return false; \\\\n\\\\\\n                    }; \\\\n\\\\\\n                    \\\\n\\\\\\n                    function preventEnterKeyDefault(event) { \\\\n\\\\\\n                        const submitBtn = document.querySelectorAll('button[type=\\\\\\\"button\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (event.key === 'Enter' && !validateCode()) { \\\\n\\\\\\n                            event.preventDefault(); \\\\n\\\\\\n                            if (submitBtn) submitBtn.disabled = true; \\\\n\\\\\\n                        } \\\\n\\\\\\n                    } \\\\n\\\\\\n                    \\\\n\\\\\\n                    function go(obs) { \\\\n\\\\\\n                        // Auto-submit and go to 'Not Registered' path if method is not registered for the user, in that case it is assumed that button will be of type submit from Page Node \\\\n\\\\\\n                        const nextBtn = document.querySelectorAll('button[type=\\\\\\\"submit\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (nextBtn) { \\\\n\\\\\\n                            nextBtn.style.visibility='hidden'; \\\\n\\\\\\n                            nextBtn.click(); \\\\n\\\\\\n                        } \\\\n\\\\\\n                        const submitBtn = document.querySelectorAll('button[type=\\\\\\\"button\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (submitBtn) submitBtn.disabled = true; \\\\n\\\\\\n                        const verificationCode = document.querySelectorAll('input[data-vv-as=\\\\\\\"Enter verification code\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (verificationCode && submitBtn) { \\\\n\\\\\\n                            verificationCode.addEventListener('input', validateCode); \\\\n\\\\\\n                            verificationCode.addEventListener('keypress', preventEnterKeyDefault); \\\\n\\\\\\n                            submitBtn.addEventListener('click', (event) => { \\\\n\\\\\\n                                if (!validateCode()) { \\\\n\\\\\\n                                    event.preventDefault(); \\\\n\\\\\\n                                    submitBtn.disabled = true; \\\\n\\\\\\n                                } \\\\n\\\\\\n                            }); \\\\n\\\\\\n                            if (obs) obs.disconnect(); \\\\n\\\\\\n                            return; \\\\n\\\\\\n                        } \\\\n\\\\\\n                    } \\\\n\\\\\\n                    \\\\n\\\\\\n                    // If both elements are present, initialize validation \\\\n\\\\\\n                    if (document.querySelectorAll('button[type=\\\\\\\"button\\\\\\\"]')[0] && document.querySelectorAll('input[data-vv-as=\\\\\\\"Enter verification code\\\\\\\"]')[0]) go(); \\\\n\\\\\\n                    else { \\\\n\\\\\\n                        const observer = new MutationObserver((mutations, obs) => { go(obs); }); \\\\n\\\\\\n                        observer.observe(document, { childList: true, subtree: true }); \\\\n\\\\\\n                    } \\\\n\\\\\\n        \\\");\\n    }\\n\\n    var invalidCodeErrorMessage = nodeState.get(\\\"invalidCodeErrorMessage\\\");\\n    nodeState.putShared(\\\"invalidCodeErrorMessage\\\", \\\"\\\");\\n    \\n    if (callbacks.isEmpty()) {\\n        // Display error message if invalid code entered by user\\n        if (invalidCodeErrorMessage && invalidCodeErrorMessage.length) callbacksBuilder.textOutputCallback(2, invalidCodeErrorMessage);\\n        // Request callbacks\\n        callbacksBuilder.scriptTextOutputCallback(validateInput());\\n    }\\n    // Go to true path\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error  \\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925688,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083463,
          "evaluatorVersion": "2.0"
        },
        "a6c73f01-13f2-428d-9fc2-8fccbdc4b2d0": {
          "_id": "a6c73f01-13f2-428d-9fc2-8fccbdc4b2d0",
          "name": "Threat Detection - Validate Recovery Code input",
          "description": "Script to validate Recovery code input, sets constraints, and enables/disables the submit button based on validity",
          "script": "\"// /*\\n//   - Data made available by nodes that have already executed are available in the sharedState variable.\\n//   - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n//  */\\n\\n/*\\n    - Script Inputs: \\\"invalidCodeErrorMessage\\\"\\n    - Script Outputs: \\\"errorMessage\\\", \\\"errorDetails\\\", \\\"invalidCodeErrorMessage\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\ntry {\\n    function validateInput() {\\n        return String(\\\" \\\\n\\\\\\n                    const submitBtn = document.querySelectorAll('button[type=\\\\\\\"submit\\\\\\\"]')[0]; \\\\n\\\\\\n                    if(submitBtn) submitBtn.disabled = true; \\\\n\\\\\\n                    function go(obs) { \\\\n\\\\\\n                        const recoveryCode = document.querySelectorAll('input[data-vv-as=\\\\\\\"Recovery Code\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (recoveryCode && submitBtn) { \\\\n\\\\\\n                            // Set the maxlength attribute to 10 \\\\n\\\\\\n                            recoveryCode.setAttribute('maxlength', 10); \\\\n\\\\\\n                            const enableSubmitBtn = () => { \\\\n\\\\\\n                                // Check input validity before enabling submit button \\\\n\\\\\\n                                const isValidInput = recoveryCode.value.length === 10; \\\\n\\\\\\n                                if (isValidInput) { \\\\n\\\\\\n                                    submitBtn.disabled = false; \\\\n\\\\\\n                                } else { \\\\n\\\\\\n                                    submitBtn.disabled = true; \\\\n\\\\\\n                                } \\\\n\\\\\\n                            }; \\\\n\\\\\\n                            // Revalidate before form submission \\\\n\\\\\\n                            submitBtn.addEventListener('click', (event) => { \\\\n\\\\\\n                                const isValidInput = recoveryCode.value.length === 10; \\\\n\\\\\\n                                if (!isValidInput) { \\\\n\\\\\\n                                    event.preventDefault(); \\\\n\\\\\\n                                    submitBtn.disabled = true; \\\\n\\\\\\n                                } \\\\n\\\\\\n                            }); \\\\n\\\\\\n                            recoveryCode.addEventListener('input', enableSubmitBtn); \\\\n\\\\\\n                            if (obs) obs.disconnect(); \\\\n\\\\\\n                            return; \\\\n\\\\\\n                       } \\\\n\\\\\\n                      } \\\\n\\\\\\n                      if (document.querySelectorAll('input[data-vv-as=\\\\\\\"Recovery Code\\\\\\\"]')[0]) go(); \\\\n\\\\\\n                      else { \\\\n\\\\\\n                        const observer = new MutationObserver((mutations, obs) => { go(obs); }); \\\\n\\\\\\n                        observer.observe(document, { childList: true, subtree: true }); \\\\n\\\\\\n                      } \\\\n\\\\\\n        \\\");\\n    }\\n\\n    var invalidCodeErrorMessage = nodeState.get(\\\"invalidCodeErrorMessage\\\");\\n    nodeState.putShared(\\\"invalidCodeErrorMessage\\\", \\\"\\\");\\n    \\n    if (callbacks.isEmpty()) {                \\n        // Display error message if invalid code entered by user\\n        if (invalidCodeErrorMessage && invalidCodeErrorMessage.length) callbacksBuilder.textOutputCallback(2, invalidCodeErrorMessage);\\n        // Request callbacks\\n        callbacksBuilder.scriptTextOutputCallback(validateInput());\\n    }\\n    // Go to true path\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error  \\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925690,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083411,
          "evaluatorVersion": "2.0"
        }
      },
      "emailTemplates": {},
      "socialIdentityProviders": {},
      "themes": [],
      "saml2Entities": {},
      "circlesOfTrust": {}
    },
    "Threat Detection - Inner Journey": {
      "tree": {
        "_id": "Threat Detection - Inner Journey",
        "_rev": "2098109109",
        "identityResource": "managed/alpha_user",
        "entryNodeId": "eab087f3-b6f0-4f42-bc0b-a97b05ec416f",
        "innerTreeOnly": true,
        "noSession": false,
        "mustRun": false,
        "enabled": true,
        "transactionalOnly": false,
        "uiConfig": {
          "categories": "[\"Threat Detection\"]"
        },
        "nodes": {
          "1bfed1e8-ba2b-411a-9da5-72ba37ec4f2a": {
            "connections": {
              "error": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0",
              "noMail": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0",
              "sent": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "Notify New Device Detected",
            "nodeType": "ScriptedDecisionNode",
            "x": 1428,
            "y": 526.03125,
            "version": 1
          },
          "20b4f246-37b6-4cc9-ac3e-9b84d86e0716": {
            "connections": {
              "Authentication": "5aab8ca7-73a3-4d39-bcd1-c741fc231be4",
              "Registration": "4fa24834-ef23-4367-afef-d887e7d9b724"
            },
            "displayName": "Determine Flow Type",
            "nodeType": "ScriptedDecisionNode",
            "x": 173.14285714285714,
            "y": 1040.236607142857,
            "version": 1
          },
          "32778673-c648-428a-b38f-d4b77e941f4a": {
            "connections": {
              "true": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "Set Protect Params In Shared State",
            "nodeType": "ScriptedDecisionNode",
            "x": 1730,
            "y": 730.921875,
            "version": 1
          },
          "4fa24834-ef23-4367-afef-d887e7d9b724": {
            "connections": {
              "AITM_MITIGATION": "e20481be-4e83-4f47-a297-679c8fe454fd",
              "BOT_MITIGATION": "e20481be-4e83-4f47-a297-679c8fe454fd",
              "TEMP_EMAIL_MITIGATION": "e20481be-4e83-4f47-a297-679c8fe454fd",
              "clientError": "e20481be-4e83-4f47-a297-679c8fe454fd",
              "exceed": "e20481be-4e83-4f47-a297-679c8fe454fd",
              "failure": "e20481be-4e83-4f47-a297-679c8fe454fd",
              "high": "e20481be-4e83-4f47-a297-679c8fe454fd",
              "low": "32778673-c648-428a-b38f-d4b77e941f4a",
              "medium": "32778673-c648-428a-b38f-d4b77e941f4a"
            },
            "displayName": "Reg: PingOne Protect Evaluation",
            "nodeType": "product-PingOneProtectEvaluationNode",
            "x": 573,
            "y": 1180.03125,
            "version": 1
          },
          "5aab8ca7-73a3-4d39-bcd1-c741fc231be4": {
            "connections": {
              "AITM_MITIGATION": "6dcfdab7-2704-460a-9a4a-ed263c781bfe",
              "BOT_MITIGATION": "6dcfdab7-2704-460a-9a4a-ed263c781bfe",
              "TEMP_EMAIL_MITIGATION": "6dcfdab7-2704-460a-9a4a-ed263c781bfe",
              "clientError": "e20481be-4e83-4f47-a297-679c8fe454fd",
              "exceed": "e20481be-4e83-4f47-a297-679c8fe454fd",
              "failure": "e20481be-4e83-4f47-a297-679c8fe454fd",
              "high": "dd89d84a-ca35-426a-bafb-36e7fca3e99b",
              "low": "ca612b3a-8db4-4c2f-b7ba-33ccac3b3967",
              "medium": "dd89d84a-ca35-426a-bafb-36e7fca3e99b"
            },
            "displayName": "Auth: PingOne Protect Evaluation",
            "nodeType": "product-PingOneProtectEvaluationNode",
            "x": 554,
            "y": 486.03125,
            "version": 1
          },
          "5c6167e2-3fb5-480d-ac03-c7ccc7bcc1bb": {
            "connections": {
              "true": "20b4f246-37b6-4cc9-ac3e-9b84d86e0716"
            },
            "displayName": "Set UserId and Username For Protect",
            "nodeType": "ScriptedDecisionNode",
            "x": 148,
            "y": 888.421875,
            "version": 1
          },
          "6dcfdab7-2704-460a-9a4a-ed263c781bfe": {
            "connections": {
              "false": "e20481be-4e83-4f47-a297-679c8fe454fd",
              "true": "85713e6b-433c-4027-89b8-8adcd0f1818a"
            },
            "displayName": "Account Active Decision",
            "nodeType": "AccountActiveDecisionNode",
            "x": 570,
            "y": 818.015625,
            "version": 1
          },
          "8086d61a-087c-4bc1-9551-dc891ed912fe": {
            "connections": {
              "error": "e20481be-4e83-4f47-a297-679c8fe454fd",
              "noMail": "e20481be-4e83-4f47-a297-679c8fe454fd",
              "sent": "e20481be-4e83-4f47-a297-679c8fe454fd"
            },
            "displayName": "Send Account Disabled Email",
            "nodeType": "ScriptedDecisionNode",
            "x": 842,
            "y": 936.03125,
            "version": 1
          },
          "85713e6b-433c-4027-89b8-8adcd0f1818a": {
            "connections": {
              "outcome": "8086d61a-087c-4bc1-9551-dc891ed912fe"
            },
            "displayName": "Disable Account",
            "nodeType": "AccountLockoutNode",
            "x": 582,
            "y": 975.03125,
            "version": 1
          },
          "94d21cb1-433d-40a7-9dc8-b4b3c57d8b68": {
            "connections": {
              "error": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0",
              "noMail": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0",
              "sent": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "Send Suspicious Activity Mail",
            "nodeType": "ScriptedDecisionNode",
            "x": 964,
            "y": 302.03125,
            "version": 1
          },
          "ca612b3a-8db4-4c2f-b7ba-33ccac3b3967": {
            "connections": {
              "false": "e20481be-4e83-4f47-a297-679c8fe454fd",
              "true": "e91a00af-f188-4853-9699-aab7dd7f2269"
            },
            "displayName": "Account Active Decision",
            "nodeType": "AccountActiveDecisionNode",
            "x": 998,
            "y": 513.015625,
            "version": 1
          },
          "dc951eec-29a0-4b3d-ba3f-0fb81961aeb9": {
            "connections": {
              "false": "5c6167e2-3fb5-480d-ac03-c7ccc7bcc1bb",
              "true": "5c6167e2-3fb5-480d-ac03-c7ccc7bcc1bb"
            },
            "displayName": "Identify Existing User",
            "nodeType": "IdentifyExistingUserNode",
            "x": 176.15625,
            "y": 686.015625,
            "version": 1
          },
          "dd89d84a-ca35-426a-bafb-36e7fca3e99b": {
            "connections": {
              "outcome": "ca612b3a-8db4-4c2f-b7ba-33ccac3b3967"
            },
            "displayName": "Increase Auth Level",
            "nodeType": "ModifyAuthLevelNode",
            "x": 1023,
            "y": 639.515625,
            "version": 1
          },
          "e20481be-4e83-4f47-a297-679c8fe454fd": {
            "connections": {
              "outcome": "e301438c-0bd0-429c-ab0c-66126501069a"
            },
            "displayName": "Update P1 Protect Eval Failure",
            "nodeType": "product-PingOneProtectResultNode",
            "x": 1561,
            "y": 999.03125,
            "version": 1
          },
          "e91a00af-f188-4853-9699-aab7dd7f2269": {
            "connections": {
              "highRisk": "94d21cb1-433d-40a7-9dc8-b4b3c57d8b68",
              "low/medRisk": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0",
              "newDevice": "1bfed1e8-ba2b-411a-9da5-72ba37ec4f2a"
            },
            "displayName": "Extract Protect Activity Params",
            "nodeType": "ScriptedDecisionNode",
            "x": 556.7777777777778,
            "y": 326,
            "version": 1
          },
          "eab087f3-b6f0-4f42-bc0b-a97b05ec416f": {
            "connections": {
              "eval": "dc951eec-29a0-4b3d-ba3f-0fb81961aeb9",
              "init": "ef2525cc-1d31-46d5-a4a5-bec6148575bf"
            },
            "displayName": "P1 Protect Action?",
            "nodeType": "ScriptedDecisionNode",
            "x": 174,
            "y": 456.03125,
            "version": 1
          },
          "ef2525cc-1d31-46d5-a4a5-bec6148575bf": {
            "connections": {
              "false": "e301438c-0bd0-429c-ab0c-66126501069a",
              "true": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "PingOne Protect Initialize",
            "nodeType": "product-PingOneProtectInitializeNode",
            "x": 549,
            "y": 127.03125,
            "version": 1
          }
        },
        "staticNodes": {
          "70e691a5-1e33-4ac3-a356-e7b6d60d92e0": {
            "x": 2111,
            "y": 476
          },
          "e301438c-0bd0-429c-ab0c-66126501069a": {
            "x": 2126,
            "y": 1024
          },
          "startNode": {
            "x": 32,
            "y": 210
          }
        }
      },
      "nodes": {
        "1bfed1e8-ba2b-411a-9da5-72ba37ec4f2a": {
          "_id": "1bfed1e8-ba2b-411a-9da5-72ba37ec4f2a",
          "_rev": "-465621923",
          "script": "cd064403-1dbb-4a7f-be57-c215b537e394",
          "outcomes": [
            "sent",
            "noMail",
            "error"
          ],
          "outputs": [
            "*"
          ],
          "inputs": [
            "PingOneProtectEvaluationNode.RISK",
            "_id"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "sent",
              "displayName": "sent"
            },
            {
              "id": "noMail",
              "displayName": "noMail"
            },
            {
              "id": "error",
              "displayName": "error"
            }
          ]
        },
        "20b4f246-37b6-4cc9-ac3e-9b84d86e0716": {
          "_id": "20b4f246-37b6-4cc9-ac3e-9b84d86e0716",
          "_rev": "-1943180079",
          "script": "b32db242-c04b-4422-86cd-f9d84633c7fb",
          "outcomes": [
            "Authentication",
            "Registration"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "flowType"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Authentication",
              "displayName": "Authentication"
            },
            {
              "id": "Registration",
              "displayName": "Registration"
            }
          ]
        },
        "32778673-c648-428a-b38f-d4b77e941f4a": {
          "_id": "32778673-c648-428a-b38f-d4b77e941f4a",
          "_rev": "-896591524",
          "script": "479bfa88-b58f-46e9-9909-59f43a1109c9",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "objectAttributes",
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "PingOneProtectEvaluationNode",
            "objectAttributes"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "4fa24834-ef23-4367-afef-d887e7d9b724": {
          "_id": "4fa24834-ef23-4367-afef-d887e7d9b724",
          "_rev": "-641661849",
          "flowType": "REGISTRATION",
          "dynamicRiskPolicySetID": false,
          "pauseBehavioralData": true,
          "storeEvaluateResult": true,
          "deviceSharingType": "SHARED",
          "scoreThreshold": "300",
          "userId": "protectUserId",
          "username": "protectUsername",
          "dynamicTargetResourceID": false,
          "userType": "EXTERNAL",
          "recommendedActions": [
            "BOT_MITIGATION",
            "AITM_MITIGATION",
            "TEMP_EMAIL_MITIGATION"
          ],
          "_type": {
            "_id": "product-PingOneProtectEvaluationNode",
            "name": "PingOne Protect Evaluation",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "high",
              "displayName": "High"
            },
            {
              "id": "medium",
              "displayName": "Medium"
            },
            {
              "id": "low",
              "displayName": "Low"
            },
            {
              "id": "exceed",
              "displayName": "Exceeds Score Threshold"
            },
            {
              "id": "failure",
              "displayName": "Failure"
            },
            {
              "id": "BOT_MITIGATION",
              "displayName": "BOT_MITIGATION"
            },
            {
              "id": "AITM_MITIGATION",
              "displayName": "AITM_MITIGATION"
            },
            {
              "id": "TEMP_EMAIL_MITIGATION",
              "displayName": "TEMP_EMAIL_MITIGATION"
            },
            {
              "id": "clientError",
              "displayName": "ClientError"
            }
          ]
        },
        "5aab8ca7-73a3-4d39-bcd1-c741fc231be4": {
          "_id": "5aab8ca7-73a3-4d39-bcd1-c741fc231be4",
          "_rev": "-1974130552",
          "flowType": "AUTHENTICATION",
          "dynamicRiskPolicySetID": false,
          "pauseBehavioralData": true,
          "storeEvaluateResult": true,
          "deviceSharingType": "SHARED",
          "scoreThreshold": "300",
          "userId": "protectUserId",
          "username": "protectUsername",
          "dynamicTargetResourceID": false,
          "userType": "EXTERNAL",
          "recommendedActions": [
            "BOT_MITIGATION",
            "AITM_MITIGATION",
            "TEMP_EMAIL_MITIGATION"
          ],
          "_type": {
            "_id": "product-PingOneProtectEvaluationNode",
            "name": "PingOne Protect Evaluation",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "high",
              "displayName": "High"
            },
            {
              "id": "medium",
              "displayName": "Medium"
            },
            {
              "id": "low",
              "displayName": "Low"
            },
            {
              "id": "exceed",
              "displayName": "Exceeds Score Threshold"
            },
            {
              "id": "failure",
              "displayName": "Failure"
            },
            {
              "id": "BOT_MITIGATION",
              "displayName": "BOT_MITIGATION"
            },
            {
              "id": "AITM_MITIGATION",
              "displayName": "AITM_MITIGATION"
            },
            {
              "id": "TEMP_EMAIL_MITIGATION",
              "displayName": "TEMP_EMAIL_MITIGATION"
            },
            {
              "id": "clientError",
              "displayName": "ClientError"
            }
          ]
        },
        "5c6167e2-3fb5-480d-ac03-c7ccc7bcc1bb": {
          "_id": "5c6167e2-3fb5-480d-ac03-c7ccc7bcc1bb",
          "_rev": "-977308428",
          "script": "3a508e25-5e4e-4c86-a63d-5c8aac219938",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "protectUserId",
            "protectUsername",
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "_id",
            "username"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "6dcfdab7-2704-460a-9a4a-ed263c781bfe": {
          "_id": "6dcfdab7-2704-460a-9a4a-ed263c781bfe",
          "_rev": "559249016",
          "_type": {
            "_id": "AccountActiveDecisionNode",
            "name": "Account Active Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "8086d61a-087c-4bc1-9551-dc891ed912fe": {
          "_id": "8086d61a-087c-4bc1-9551-dc891ed912fe",
          "_rev": "-1783496659",
          "script": "eff31166-03fb-454e-bcb0-c1f6add5f7a6",
          "outcomes": [
            "sent",
            "noMail",
            "error"
          ],
          "outputs": [
            "*"
          ],
          "inputs": [
            "_id",
            "PingOneProtectEvaluationNode.RISK"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "sent",
              "displayName": "sent"
            },
            {
              "id": "noMail",
              "displayName": "noMail"
            },
            {
              "id": "error",
              "displayName": "error"
            }
          ]
        },
        "85713e6b-433c-4027-89b8-8adcd0f1818a": {
          "_id": "85713e6b-433c-4027-89b8-8adcd0f1818a",
          "_rev": "-1193917",
          "lockAction": "LOCK",
          "_type": {
            "_id": "AccountLockoutNode",
            "name": "Account Lockout",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "94d21cb1-433d-40a7-9dc8-b4b3c57d8b68": {
          "_id": "94d21cb1-433d-40a7-9dc8-b4b3c57d8b68",
          "_rev": "1049313547",
          "script": "cd064403-1dbb-4a7f-be57-c215b537e394",
          "outcomes": [
            "sent",
            "noMail",
            "error"
          ],
          "outputs": [
            "*"
          ],
          "inputs": [
            "_id",
            "PingOneProtectEvaluationNode.RISK"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "sent",
              "displayName": "sent"
            },
            {
              "id": "noMail",
              "displayName": "noMail"
            },
            {
              "id": "error",
              "displayName": "error"
            }
          ]
        },
        "ca612b3a-8db4-4c2f-b7ba-33ccac3b3967": {
          "_id": "ca612b3a-8db4-4c2f-b7ba-33ccac3b3967",
          "_rev": "-1076468436",
          "_type": {
            "_id": "AccountActiveDecisionNode",
            "name": "Account Active Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "dc951eec-29a0-4b3d-ba3f-0fb81961aeb9": {
          "_id": "dc951eec-29a0-4b3d-ba3f-0fb81961aeb9",
          "_rev": "394537793",
          "identityAttribute": "userName",
          "identifier": "userName",
          "_type": {
            "_id": "IdentifyExistingUserNode",
            "name": "Identify Existing User",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "dd89d84a-ca35-426a-bafb-36e7fca3e99b": {
          "_id": "dd89d84a-ca35-426a-bafb-36e7fca3e99b",
          "_rev": "-961525467",
          "authLevelIncrement": 1,
          "_type": {
            "_id": "ModifyAuthLevelNode",
            "name": "Modify Auth Level",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "e20481be-4e83-4f47-a297-679c8fe454fd": {
          "_id": "e20481be-4e83-4f47-a297-679c8fe454fd",
          "_rev": "-1664428923",
          "status": "FAILED",
          "_type": {
            "_id": "product-PingOneProtectResultNode",
            "name": "PingOne Protect Result",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "e91a00af-f188-4853-9699-aab7dd7f2269": {
          "_id": "e91a00af-f188-4853-9699-aab7dd7f2269",
          "_rev": "28153178",
          "script": "34b32392-dd95-4fed-9e01-88fd6441dae7",
          "outcomes": [
            "highRisk",
            "newDevice",
            "low/medRisk"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "PingOneProtectEvaluationNode.RISK",
            "_id"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "highRisk",
              "displayName": "highRisk"
            },
            {
              "id": "newDevice",
              "displayName": "newDevice"
            },
            {
              "id": "low/medRisk",
              "displayName": "low/medRisk"
            }
          ]
        },
        "eab087f3-b6f0-4f42-bc0b-a97b05ec416f": {
          "_id": "eab087f3-b6f0-4f42-bc0b-a97b05ec416f",
          "_rev": "398827909",
          "script": "390bdf79-fadd-404f-9422-29823b7dce8a",
          "outcomes": [
            "init",
            "eval"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "p1ProtectAction"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "init",
              "displayName": "init"
            },
            {
              "id": "eval",
              "displayName": "eval"
            }
          ]
        },
        "ef2525cc-1d31-46d5-a4a5-bec6148575bf": {
          "_id": "ef2525cc-1d31-46d5-a4a5-bec6148575bf",
          "_rev": "-1952285296",
          "deviceAttributesToIgnore": [],
          "enableTrust": false,
          "disableTags": false,
          "behavioralDataCollection": true,
          "consoleLogEnabled": false,
          "deviceKeyRsyncIntervals": 14,
          "disableHub": false,
          "lazyMetadata": false,
          "_type": {
            "_id": "product-PingOneProtectInitializeNode",
            "name": "PingOne Protect Initialize",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        }
      },
      "innerNodes": {},
      "scripts": {
        "cd064403-1dbb-4a7f-be57-c215b537e394": {
          "_id": "cd064403-1dbb-4a7f-be57-c215b537e394",
          "name": "Threat Detection - Send suspicious activity email",
          "description": "Script to send next-gen templated email if any suspicious activity detected",
          "script": "\"/**\\n * @file This script sends a templated email to a user via the IDM's configured email service\\n * using the openidm binding in next-gen scripting\\n * NOTE - The use of SendGrid is not supported in Production and must be changed to your own email service\\n * Steps are here: https://backstage.forgerock.com/docs/idcloud/latest/tenants/email-provider.html#external_smtp_email_server\\n * @version 0.2.0\\n * @keywords email mail sharedState transientState templateService\\n */\\n\\n/**\\n * Script configuration\\n*/\\n\\n// Initialise the logger called ds-node-logger-lib library script\\nXLogger = require(\\\"ds-node-logger-lib\\\").XLogger;\\nlogger = new XLogger(this);\\n\\nvar config = {\\n    /**\\n     * @property {string} templateID - Identifier of email template\\n     * @property {string} idmEndpoint - IDM Endpoint used to send templated emails\\n     * @property {string} idmAction - IDM action executed against the idmEndpoint\\n     */\\n\\n    templateID: \\\"suspiciousActivity\\\",\\n    idmEndpoint: \\\"external/email\\\",\\n    idmAction: \\\"sendTemplate\\\"\\n};\\n\\n/**\\n * Node outcomes\\n*/\\nvar nodeOutcome = {\\n    PASS: \\\"sent\\\",\\n    FAIL: \\\"noMail\\\",\\n    ERROR: \\\"error\\\"\\n};\\n\\n/**\\n * Send email via the IDM Email Service openidm binding in next-gen scripting\\n * \\n * @param {string} mail - mail attribute retrieved from the idRepository. Note if this is a registration journey acquire mail from sharedState\\n */\\n\\nfunction sendMail(mail, protectActivityCity, protectActivityState) {\\n    try {\\n        var params = new Object();\\n        params.templateName = config.templateID;\\n        params.to = mail;\\n        params.object = {\\n            \\\"mail\\\": mail,\\n            \\\"custom_protectActivityCity\\\": protectActivityCity,\\n            \\\"custom_protectActivityState\\\": protectActivityState\\n        };\\n        openidm.action(config.idmEndpoint, config.idmAction, params);\\n        logger.error(\\\"Email send successfully\\\");\\n        return nodeOutcome.PASS;\\n    }\\n    catch (e) {\\n        logger.error(\\\"Failed to call IDM Email endpoint using template. Exception is: \\\" + e);\\n        return nodeOutcome.ERROR;\\n    }\\n};\\n\\nfunction capitalizeFirstLetter(string) {\\n    return string\\n    .split(' ')                   // Split the string into an array of words\\n    .map(word => \\n        word.charAt(0).toUpperCase() + word.slice(1)\\n    )                             // Capitalize the first letter of each word\\n    .join(' ');                   // Join the array back into a single string\\n    // return string.length > 0 ? string.charAt(0).toUpperCase() + string.slice(1) : \\\"\\\";\\n};\\n\\n/**\\n * Main function\\n */\\n\\n(function () {\\n    logger.error(\\\"Node execution started\\\");\\n    var id;\\n    var mail;\\n    var rawResponse;\\n    var protectActivityCity = \\\"\\\";\\n    var protectActivityState = \\\"\\\";\\n\\n    if (!(id = nodeState.get(\\\"_id\\\"))) {\\n        logger.error(\\\"Unable to retrieve Identity\\\");\\n        action.goTo(nodeOutcome.ERROR);\\n        return;\\n    } else {\\n        var identity = idRepository.getIdentity(id);\\n    }\\n\\n    //If this is a registration journey adapt the following to try retrieve from nodeState\\n    if (!(mail = identity.getAttributeValues(\\\"mail\\\").toArray()[0])) {\\n        logger.error(\\\"Unable to retrieve mail attribute from the idRepository\\\");\\n        action.goTo(nodeOutcome.FAIL);\\n        return;\\n    }\\n\\n    if(rawResponse = nodeState.get(\\\"PingOneProtectEvaluationNode.RISK\\\")){\\n        protectActivityCity = rawResponse.details.city;\\n        protectActivityState = rawResponse.details.state;\\n        protectActivityCity = capitalizeFirstLetter(protectActivityCity);\\n        protectActivityState = capitalizeFirstLetter(protectActivityState);\\n    }\\n\\n    //Execute function to send mail\\n    outcome = sendMail(mail, protectActivityCity, protectActivityState);\\n})();\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925688,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083479,
          "evaluatorVersion": "2.0"
        },
        "b32db242-c04b-4422-86cd-f9d84633c7fb": {
          "_id": "b32db242-c04b-4422-86cd-f9d84633c7fb",
          "name": "Threat Detection - P1 Protect Extract Flow Type",
          "description": "Script to extract flow type for Threat Detection Journey",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: \\\"flowType\\\"\\n    - Script Outputs: \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"Registration\\\", \\\"Authentication\\\"\\n*/\\n\\n// FlowType is required to be set in shared state in the parent journey\\n// Currently Reg & Authn flowTypes are supported in this script\\n// In future the list will increase to support types like Account Recovery, Authorization etc.\\ntry {\\n    if(nodeState.get('flowType') === \\\"Registration\\\") outcome = \\\"Registration\\\";\\n    else outcome = \\\"Authentication\\\";\\n    // Go to outcome\\n    action.goTo(outcome);    \\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error  \\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925691,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083370,
          "evaluatorVersion": "2.0"
        },
        "479bfa88-b58f-46e9-9909-59f43a1109c9": {
          "_id": "479bfa88-b58f-46e9-9909-59f43a1109c9",
          "name": "Threat Detection - Set Protect Activity Params in shared state",
          "description": "Script to set protect activity params in shared state ",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: \\\"objectAttributes\\\", \\\"PingOneProtectEvaluationNode.RISK\\\"\\n    - Script Outputs: \\\"objectAttributes\\\", \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\ntry {\\n    function capitalizeFirstLetter(string) {\\n        return string\\n        .split(' ')                   // Split the string into an array of words\\n        .map(word => \\n            word.charAt(0).toUpperCase() + word.slice(1)\\n        )                             // Capitalize the first letter of each word\\n        .join(' ');                   // Join the array back into a single string\\n        // return string.length > 0 ? string.charAt(0).toUpperCase() + string.slice(1) : \\\"\\\";\\n    }\\n    \\n    var attributes = nodeState.get(\\\"objectAttributes\\\");\\n    \\n    var rawResponse = nodeState.get(\\\"PingOneProtectEvaluationNode.RISK\\\");\\n    \\n    \\n    // Get & Set the protect activity variables in shared state\\n    var protectActivityCity = rawResponse.details.city;\\n    var protectActivityState = rawResponse.details.state;\\n    var protectDeviceOS = rawResponse.details.device.os.name;\\n    \\n    protectActivityCity = capitalizeFirstLetter(protectActivityCity);\\n    protectActivityState = capitalizeFirstLetter(protectActivityState);\\n    \\n    if (attributes) {\\n      attributes.put(\\\"custom_protectActivityCity\\\", protectActivityCity);\\n      attributes.put(\\\"custom_protectActivityState\\\", protectActivityState);\\n      attributes.put(\\\"custom_protectDeviceOS\\\", protectDeviceOS);\\n      nodeState.putShared(\\\"objectAttributes\\\", attributes);\\n    }\\n    // Go to true path\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error  \\n    action.goTo(\\\"Error\\\");\\n}\\n\\n\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925688,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083366,
          "evaluatorVersion": "2.0"
        },
        "3a508e25-5e4e-4c86-a63d-5c8aac219938": {
          "_id": "3a508e25-5e4e-4c86-a63d-5c8aac219938",
          "name": "Threat Detection - Set Protect userId and username",
          "description": "Script to set userId and username to be used in P1 Protect nodes",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: \\\"_id\\\", \\\"username\\\"\\n    - Script Outputs: \\\"protectUserId\\\", \\\"protectUsername\\\", \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\ntry {\\n    var protectUserId = nodeState.get(\\\"_id\\\");\\n    var protectUsername = nodeState.get(\\\"username\\\");\\n    \\n    if(protectUserId === null) protectUserId = protectUsername;\\n    \\n    nodeState.putShared(\\\"protectUserId\\\", protectUserId);\\n    nodeState.putShared(\\\"protectUsername\\\", protectUsername);\\n    // Go to true path\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error  \\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925688,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083368,
          "evaluatorVersion": "2.0"
        },
        "eff31166-03fb-454e-bcb0-c1f6add5f7a6": {
          "_id": "eff31166-03fb-454e-bcb0-c1f6add5f7a6",
          "name": "Threat Detection - Send account disabled email",
          "description": "Script to send next-gen templated email if account is disabled",
          "script": "\"/**\\n * @file This script sends a templated email to a user via the IDM's configured email service\\n * using the openidm binding in next-gen scripting\\n * NOTE - The use of SendGrid is not supported in Production and must be changed to your own email service\\n * Steps are here: https://backstage.forgerock.com/docs/idcloud/latest/tenants/email-provider.html#external_smtp_email_server\\n * @version 0.2.0\\n * @keywords email mail sharedState transientState templateService\\n */\\n\\n/**\\n * Script configuration\\n*/\\n\\n// Initialise the logger called ds-node-logger-lib library script\\nXLogger = require(\\\"ds-node-logger-lib\\\").XLogger;\\nlogger = new XLogger(this);\\n\\nvar config = {\\n    /**\\n     * @property {string} templateID - Identifier of email template\\n     * @property {string} idmEndpoint - IDM Endpoint used to send templated emails\\n     * @property {string} idmAction - IDM action executed against the idmEndpoint\\n     */\\n\\n    templateID: \\\"accountDisabled\\\",\\n    idmEndpoint: \\\"external/email\\\",\\n    idmAction: \\\"sendTemplate\\\"\\n};\\n\\n/**\\n * Node outcomes\\n*/\\nvar nodeOutcome = {\\n    PASS: \\\"sent\\\",\\n    FAIL: \\\"noMail\\\",\\n    ERROR: \\\"error\\\"\\n};\\n\\n/**\\n * Send email via the IDM Email Service openidm binding in next-gen scripting\\n * \\n * @param {string} mail - mail attribute retrieved from the idRepository. Note if this is a registration journey acquire mail from sharedState\\n */\\n\\nfunction sendMail(mail, protectActivityCity, protectActivityState) {\\n    try {\\n        var params = new Object();\\n        params.templateName = config.templateID;\\n        params.to = mail;\\n        params.object = {\\n            \\\"mail\\\": mail,\\n            \\\"custom_protectActivityCity\\\": protectActivityCity,\\n            \\\"custom_protectActivityState\\\": protectActivityState\\n        };\\n        openidm.action(config.idmEndpoint, config.idmAction, params);\\n        logger.error(\\\"Email send successfully\\\");\\n        return nodeOutcome.PASS;\\n    }\\n    catch (e) {\\n        logger.error(\\\"Failed to call IDM Email endpoint using template. Exception is: \\\" + e);\\n        return nodeOutcome.ERROR;\\n    }\\n};\\n\\nfunction capitalizeFirstLetter(string) {\\n    return string\\n    .split(' ')                   // Split the string into an array of words\\n    .map(word => \\n        word.charAt(0).toUpperCase() + word.slice(1)\\n    )                             // Capitalize the first letter of each word\\n    .join(' ');                   // Join the array back into a single string\\n    // return string.length > 0 ? string.charAt(0).toUpperCase() + string.slice(1) : \\\"\\\";\\n};\\n\\n/**\\n * Main function\\n */\\n\\n(function () {\\n    logger.error(\\\"Node execution started\\\");\\n    var id;\\n    var mail;\\n    var rawResponse;\\n    var protectActivityCity = \\\"\\\";\\n    var protectActivityState = \\\"\\\";\\n\\n    if (!(id = nodeState.get(\\\"_id\\\"))) {\\n        logger.error(\\\"Unable to retrieve Identity\\\");\\n        action.goTo(nodeOutcome.ERROR);\\n        return;\\n    } else {\\n        var identity = idRepository.getIdentity(id);\\n    }\\n\\n    //If this is a registration journey adapt the following to try retrieve from nodeState\\n    if (!(mail = identity.getAttributeValues(\\\"mail\\\").toArray()[0])) {\\n        logger.error(\\\"Unable to retrieve mail attribute from the idRepository\\\");\\n        action.goTo(nodeOutcome.FAIL);\\n        return;\\n    }\\n\\n    if(rawResponse = nodeState.get(\\\"PingOneProtectEvaluationNode.RISK\\\")){\\n        protectActivityCity = rawResponse.details.city;\\n        protectActivityState = rawResponse.details.state;\\n        protectActivityCity = capitalizeFirstLetter(protectActivityCity);\\n        protectActivityState = capitalizeFirstLetter(protectActivityState);\\n    }\\n\\n    //Execute function to send mail\\n    outcome = sendMail(mail, protectActivityCity, protectActivityState);\\n})();\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925690,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083469,
          "evaluatorVersion": "2.0"
        },
        "34b32392-dd95-4fed-9e01-88fd6441dae7": {
          "_id": "34b32392-dd95-4fed-9e01-88fd6441dae7",
          "name": "Threat Detection - P1 Protect Extract Parameters From Risk Evaluation",
          "description": "Script to extract parameters from P1 Protect Risk Evaluation",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: \\\"PingOneProtectEvaluationNode.RISK\\\", \\\"_id\\\"\\n    - Script Outputs: \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"highRisk\\\", \\\"newDevice\\\", \\\"low/medRisk\\\"\\n*/\\n\\ntry {\\n    function capitalizeFirstLetter(string) {\\n        return string\\n        .split(' ')                   // Split the string into an array of words\\n        .map(word => \\n            word.charAt(0).toUpperCase() + word.slice(1)\\n        )                             // Capitalize the first letter of each word\\n        .join(' ');                   // Join the array back into a single string\\n    }\\n    \\n    var rawResponse = nodeState.get(\\\"PingOneProtectEvaluationNode.RISK\\\");\\n    \\n    var riskLevel = rawResponse.result.level;\\n    \\n    // Get & Set the protect activity variables in user's profile (to be used in notification templates)\\n    var protectActivityCity = rawResponse.details.city;\\n    var protectActivityState = rawResponse.details.state;\\n    var protectDeviceOS = rawResponse.details.device.os.name;\\n    \\n    protectActivityCity = capitalizeFirstLetter(protectActivityCity);\\n    protectActivityState = capitalizeFirstLetter(protectActivityState);\\n    \\n    \\n    // Get the userId from nodestate\\n    var userId = nodeState.get(\\\"_id\\\");\\n    \\n    // Update the protectActvityCity attribute of user\\n    openidm.patch(\\\"managed/alpha_user/\\\" + userId, null, [{\\\"operation\\\":\\\"replace\\\", \\\"field\\\":\\\"/custom_protectActivityCity\\\", \\\"value\\\":protectActivityCity}]);\\n    \\n    openidm.patch(\\\"managed/alpha_user/\\\" + userId, null, [{\\\"operation\\\":\\\"replace\\\", \\\"field\\\":\\\"/custom_protectActivityState\\\", \\\"value\\\":protectActivityState}]);\\n    \\n    openidm.patch(\\\"managed/alpha_user/\\\" + userId, null, [{\\\"operation\\\":\\\"replace\\\", \\\"field\\\":\\\"/custom_protectDeviceOS\\\", \\\"value\\\":protectDeviceOS}]);\\n    \\n    if(riskLevel === \\\"HIGH\\\") {\\n        outcome = \\\"highRisk\\\";\\n        action.goTo(outcome);\\n    }\\n    \\n    // Check if new device is found\\n    if(rawResponse.details.newDevice.status === \\\"UNKNOWN_DEVICE\\\") outcome = \\\"newDevice\\\";\\n    else outcome = \\\"low/medRisk\\\";\\n    \\n    // Go to outcome\\n    action.goTo(outcome);\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error  \\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925692,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083397,
          "evaluatorVersion": "2.0"
        },
        "390bdf79-fadd-404f-9422-29823b7dce8a": {
          "_id": "390bdf79-fadd-404f-9422-29823b7dce8a",
          "name": "Threat Detection - P1 Protect Action",
          "description": "Script to get action to be taken in Threat Detection Journey",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: \\\"p1ProtectAction\\\"\\n    - Script Outputs: \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"init\\\", \\\"eval\\\"\\n*/\\n\\ntry {\\n    // Only two state variables are expected to be put in shared state in the main journey: \\n    // \\\"init\\\" -> To initialize the P1 Protect to collect Risk SDK signals & \\n    // \\\"eval\\\" -> To send the Risk SDK signals to protect and evalute them\\n    var p1ProtectAction = nodeState.get(\\\"p1ProtectAction\\\");\\n    \\n    if(p1ProtectAction === \\\"init\\\") action.goTo(\\\"init\\\");\\n    else action.goTo(\\\"eval\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error  \\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925695,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083367,
          "evaluatorVersion": "2.0"
        }
      },
      "emailTemplates": {},
      "socialIdentityProviders": {},
      "themes": [],
      "saml2Entities": {},
      "circlesOfTrust": {}
    },
    "MFA Authentication - Inner Journey": {
      "tree": {
        "_id": "MFA Authentication - Inner Journey",
        "_rev": "312010089",
        "identityResource": "managed/alpha_user",
        "entryNodeId": "6d8e2a09-49cf-42e7-b94e-59046c7da9be",
        "innerTreeOnly": true,
        "noSession": false,
        "mustRun": false,
        "enabled": true,
        "transactionalOnly": false,
        "uiConfig": {
          "categories": "[\"Threat Detection\"]"
        },
        "nodes": {
          "00d6f9db-9b4f-43ce-9e87-6b67cf33f284": {
            "connections": {
              "EMAIL": "b51ba06b-8094-475c-8293-3f3133fd0baa",
              "Error": "e301438c-0bd0-429c-ab0c-66126501069a",
              "FIDO2": "7859b9ee-0b45-4f4e-8cb9-5901cc8df6b2",
              "Magic Link": "1d8f1610-0bf8-4d33-8ba1-57fa41ccb47e",
              "OATH": "2276b39a-3e2a-4fd0-a831-44b1bd3a8a13",
              "PUSH": "a64f9e2f-1a86-430e-b3f6-7ff2d92c186e",
              "SMS": "5715b985-231b-449e-b1a6-45853c1fae35",
              "VOICE": "44e7a69c-b220-4d4e-b0b7-6a0a45e3e126"
            },
            "displayName": "Select Auth Device",
            "nodeType": "PageNode",
            "x": 220,
            "y": 468.421875,
            "version": 1
          },
          "0cfa645f-94e3-4a8e-8c64-fc13054a302c": {
            "connections": {
              "true": "2276b39a-3e2a-4fd0-a831-44b1bd3a8a13"
            },
            "displayName": "Set Invalid Code Error Message",
            "nodeType": "ScriptedDecisionNode",
            "x": 535,
            "y": 2349.015625,
            "version": 1
          },
          "1d8f1610-0bf8-4d33-8ba1-57fa41ccb47e": {
            "connections": {
              "outcome": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "Email Magic Link",
            "nodeType": "EmailSuspendNode",
            "x": 230,
            "y": 862.015625,
            "version": 1
          },
          "2276b39a-3e2a-4fd0-a831-44b1bd3a8a13": {
            "connections": {
              "failureOutcome": "402c5d71-61a8-4ad3-b8c3-c55898a85466",
              "notRegisteredOutcome": "e301438c-0bd0-429c-ab0c-66126501069a",
              "recoveryCodeOutcome": "9fec1a6e-78ea-4830-a226-9e63ffe61d08",
              "successOutcome": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "Enter Verification Code",
            "nodeType": "PageNode",
            "x": 573,
            "y": 1845.015625,
            "version": 1
          },
          "35e54a17-213d-4603-9861-6bf9649dc7b4": {
            "connections": {
              "error": "e301438c-0bd0-429c-ab0c-66126501069a",
              "true": "8dd2f089-ab42-4f3d-b754-86985f8156df"
            },
            "displayName": "Twilio Verify Sender",
            "nodeType": "VerifyAuthSenderNode",
            "x": 824,
            "y": 168.03125,
            "version": 1
          },
          "3bc40cbc-8a11-4295-8605-99aaac6e7ed8": {
            "connections": {
              "error": "e301438c-0bd0-429c-ab0c-66126501069a",
              "noMail": "e301438c-0bd0-429c-ab0c-66126501069a",
              "sent": "733d692c-ad82-48f1-bbc4-6855ab5212dc"
            },
            "displayName": "Send OTP Email",
            "nodeType": "ScriptedDecisionNode",
            "x": 824,
            "y": 8.03125,
            "version": 1
          },
          "402c5d71-61a8-4ad3-b8c3-c55898a85466": {
            "connections": {
              "Reject": "e301438c-0bd0-429c-ab0c-66126501069a",
              "Retry": "0cfa645f-94e3-4a8e-8c64-fc13054a302c"
            },
            "displayName": "Retry Limit Decision",
            "nodeType": "RetryLimitDecisionNode",
            "x": 578,
            "y": 2176.515625,
            "version": 1
          },
          "44e7a69c-b220-4d4e-b0b7-6a0a45e3e126": {
            "connections": {
              "Error": "e301438c-0bd0-429c-ab0c-66126501069a",
              "False": "e301438c-0bd0-429c-ab0c-66126501069a",
              "True": "59892180-4c18-4e1f-95f8-f78def8b752f"
            },
            "displayName": "Twilio Identifier",
            "nodeType": "VerifyAuthIdentifierNode",
            "x": 547,
            "y": 266.03125,
            "version": 1
          },
          "5715b985-231b-449e-b1a6-45853c1fae35": {
            "connections": {
              "Error": "e301438c-0bd0-429c-ab0c-66126501069a",
              "False": "e301438c-0bd0-429c-ab0c-66126501069a",
              "True": "35e54a17-213d-4603-9861-6bf9649dc7b4"
            },
            "displayName": "Twilio Identifier",
            "nodeType": "VerifyAuthIdentifierNode",
            "x": 544,
            "y": 114.03125,
            "version": 1
          },
          "59892180-4c18-4e1f-95f8-f78def8b752f": {
            "connections": {
              "error": "e301438c-0bd0-429c-ab0c-66126501069a",
              "true": "8dd2f089-ab42-4f3d-b754-86985f8156df"
            },
            "displayName": "Twilio Verify Sender",
            "nodeType": "VerifyAuthSenderNode",
            "x": 824,
            "y": 296.03125,
            "version": 1
          },
          "6aeb8029-6131-41af-9193-449058fb415d": {
            "connections": {
              "Reject": "e301438c-0bd0-429c-ab0c-66126501069a",
              "Retry": "a64f9e2f-1a86-430e-b3f6-7ff2d92c186e"
            },
            "displayName": "Retry Limit Decision",
            "nodeType": "RetryLimitDecisionNode",
            "x": 571,
            "y": 2475.015625,
            "version": 1
          },
          "6d8e2a09-49cf-42e7-b94e-59046c7da9be": {
            "connections": {
              "false": "e301438c-0bd0-429c-ab0c-66126501069a",
              "true": "00d6f9db-9b4f-43ce-9e87-6b67cf33f284"
            },
            "displayName": "Identify Existing User",
            "nodeType": "IdentifyExistingUserNode",
            "x": 226,
            "y": 283.03125,
            "version": 1
          },
          "733d692c-ad82-48f1-bbc4-6855ab5212dc": {
            "connections": {
              "false": "945ec619-8dfa-4904-aed3-d9fa8037d986",
              "true": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "Collect OTP",
            "nodeType": "PageNode",
            "x": 1100,
            "y": 13.015625,
            "version": 1
          },
          "76ac3d1a-82d6-4086-8513-9ced0858ee79": {
            "connections": {
              "true": "9fec1a6e-78ea-4830-a226-9e63ffe61d08"
            },
            "displayName": "Set Invalid Code Error Message",
            "nodeType": "ScriptedDecisionNode",
            "x": 533,
            "y": 1270.015625,
            "version": 1
          },
          "7859b9ee-0b45-4f4e-8cb9-5901cc8df6b2": {
            "connections": {
              "error": "e301438c-0bd0-429c-ab0c-66126501069a",
              "failure": "e301438c-0bd0-429c-ab0c-66126501069a",
              "noDevice": "e301438c-0bd0-429c-ab0c-66126501069a",
              "recoveryCode": "a7d2a8be-e923-4dc6-87f1-4fc878d77cfc",
              "success": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0",
              "unsupported": "e301438c-0bd0-429c-ab0c-66126501069a"
            },
            "displayName": "WebAuthn Authentication Node",
            "nodeType": "WebAuthnAuthenticationNode",
            "x": 530,
            "y": 444.015625,
            "version": 1
          },
          "78aa469c-9a9a-4bdf-925b-4c2af282f877": {
            "connections": {
              "true": "733d692c-ad82-48f1-bbc4-6855ab5212dc"
            },
            "displayName": "Set Invalid Code Error Message",
            "nodeType": "ScriptedDecisionNode",
            "x": 1379,
            "y": 15.015625,
            "version": 1
          },
          "7ed73b41-e3ff-4a3a-a9c0-f1be6e06f6da": {
            "connections": {
              "EXPIRED": "6aeb8029-6131-41af-9193-449058fb415d",
              "FALSE": "e301438c-0bd0-429c-ab0c-66126501069a",
              "TRUE": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0",
              "WAITING": "e69c9588-f8e1-4c6d-ac3a-3f035611880c"
            },
            "displayName": "Push Result Verifier Node",
            "nodeType": "PushResultVerifierNode",
            "x": 903,
            "y": 2450.015625,
            "version": 1
          },
          "8ca347fe-adb9-4a6a-8cab-7ce8d20d7942": {
            "connections": {
              "true": "8dd2f089-ab42-4f3d-b754-86985f8156df"
            },
            "displayName": "Set Invalid Code Error Message",
            "nodeType": "ScriptedDecisionNode",
            "x": 1088,
            "y": 563.015625,
            "version": 1
          },
          "8dd2f089-ab42-4f3d-b754-86985f8156df": {
            "connections": {
              "error": "e301438c-0bd0-429c-ab0c-66126501069a",
              "false": "d3c385db-0014-475b-8d79-681f0424c1cc",
              "true": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "Collect OTP",
            "nodeType": "PageNode",
            "x": 1099.984375,
            "y": 254.015625,
            "version": 1
          },
          "945ec619-8dfa-4904-aed3-d9fa8037d986": {
            "connections": {
              "Reject": "e301438c-0bd0-429c-ab0c-66126501069a",
              "Retry": "78aa469c-9a9a-4bdf-925b-4c2af282f877"
            },
            "displayName": "Retry Limit Decision",
            "nodeType": "RetryLimitDecisionNode",
            "x": 1404,
            "y": 133,
            "version": 1
          },
          "9d76e136-4862-4b1a-9ec1-d9a67d6f4797": {
            "connections": {
              "true": "9fa48a27-b41a-4a53-9b22-7f305ad9c8c7"
            },
            "displayName": "Set Invalid Code Error Message",
            "nodeType": "ScriptedDecisionNode",
            "x": 1170,
            "y": 2331.015625,
            "version": 1
          },
          "9fa48a27-b41a-4a53-9b22-7f305ad9c8c7": {
            "connections": {
              "false": "f8cd1bb2-a0a7-4b6b-bf80-6a39c2123014",
              "true": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "Enter Recovery Code",
            "nodeType": "PageNode",
            "x": 1201,
            "y": 2627.015625,
            "version": 1
          },
          "9fec1a6e-78ea-4830-a226-9e63ffe61d08": {
            "connections": {
              "false": "cc12937b-69bb-46e8-91ab-34504bd6f316",
              "true": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "Enter Recovery Code",
            "nodeType": "PageNode",
            "x": 572,
            "y": 1578.015625,
            "version": 1
          },
          "a64f9e2f-1a86-430e-b3f6-7ff2d92c186e": {
            "connections": {
              "NOT_REGISTERED": "e301438c-0bd0-429c-ab0c-66126501069a",
              "SENT": "7ed73b41-e3ff-4a3a-a9c0-f1be6e06f6da"
            },
            "displayName": "Push Sender",
            "nodeType": "PushAuthenticationSenderNode",
            "x": 573,
            "y": 2646.015625,
            "version": 1
          },
          "a7d2a8be-e923-4dc6-87f1-4fc878d77cfc": {
            "connections": {
              "false": "cc2964e1-ade1-4087-bec0-0f1db5b020e8",
              "true": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "Enter Recovery Code",
            "nodeType": "PageNode",
            "x": 553,
            "y": 699.015625,
            "version": 1
          },
          "b51ba06b-8094-475c-8293-3f3133fd0baa": {
            "connections": {
              "outcome": "3bc40cbc-8a11-4295-8605-99aaac6e7ed8"
            },
            "displayName": "HOTP Generator",
            "nodeType": "OneTimePasswordGeneratorNode",
            "x": 545,
            "y": 37.015625,
            "version": 1
          },
          "cc12937b-69bb-46e8-91ab-34504bd6f316": {
            "connections": {
              "Reject": "e301438c-0bd0-429c-ab0c-66126501069a",
              "Retry": "76ac3d1a-82d6-4086-8513-9ced0858ee79"
            },
            "displayName": "Retry Limit Decision",
            "nodeType": "RetryLimitDecisionNode",
            "x": 574.7142857142858,
            "y": 1407.950892857143,
            "version": 1
          },
          "cc2964e1-ade1-4087-bec0-0f1db5b020e8": {
            "connections": {
              "Reject": "e301438c-0bd0-429c-ab0c-66126501069a",
              "Retry": "e358c23f-3199-423c-8819-cf067f6fb2ed"
            },
            "displayName": "Retry Limit Decision",
            "nodeType": "RetryLimitDecisionNode",
            "x": 563,
            "y": 973.515625,
            "version": 1
          },
          "d3c385db-0014-475b-8d79-681f0424c1cc": {
            "connections": {
              "Reject": "e301438c-0bd0-429c-ab0c-66126501069a",
              "Retry": "8ca347fe-adb9-4a6a-8cab-7ce8d20d7942"
            },
            "displayName": "Retry Limit Decision",
            "nodeType": "RetryLimitDecisionNode",
            "x": 1402,
            "y": 328.015625,
            "version": 1
          },
          "e358c23f-3199-423c-8819-cf067f6fb2ed": {
            "connections": {
              "true": "a7d2a8be-e923-4dc6-87f1-4fc878d77cfc"
            },
            "displayName": "Set Invalid Code Error Message",
            "nodeType": "ScriptedDecisionNode",
            "x": 527.75,
            "y": 1142.01953125,
            "version": 1
          },
          "e69c9588-f8e1-4c6d-ac3a-3f035611880c": {
            "connections": {
              "DONE": "7ed73b41-e3ff-4a3a-a9c0-f1be6e06f6da",
              "EXITED": "9fa48a27-b41a-4a53-9b22-7f305ad9c8c7"
            },
            "displayName": "Push Wait Node",
            "nodeType": "PushWaitNode",
            "x": 925,
            "y": 2648.015625,
            "version": 1
          },
          "f8cd1bb2-a0a7-4b6b-bf80-6a39c2123014": {
            "connections": {
              "Reject": "e301438c-0bd0-429c-ab0c-66126501069a",
              "Retry": "9d76e136-4862-4b1a-9ec1-d9a67d6f4797"
            },
            "displayName": "Retry Limit Decision",
            "nodeType": "RetryLimitDecisionNode",
            "x": 1206,
            "y": 2467.015625,
            "version": 1
          }
        },
        "staticNodes": {
          "70e691a5-1e33-4ac3-a356-e7b6d60d92e0": {
            "x": 1628,
            "y": 1175
          },
          "e301438c-0bd0-429c-ab0c-66126501069a": {
            "x": 1267,
            "y": 1175
          },
          "startNode": {
            "x": 50,
            "y": 250
          }
        }
      },
      "nodes": {
        "00d6f9db-9b4f-43ce-9e87-6b67cf33f284": {
          "_id": "00d6f9db-9b4f-43ce-9e87-6b67cf33f284",
          "_rev": "1060525782",
          "nodes": [
            {
              "_id": "a5f50d0b-5dba-41fa-bbd0-d23ade1565d9",
              "nodeType": "ScriptedDecisionNode",
              "nodeVersion": 1,
              "displayName": "Select MFA Device"
            }
          ],
          "pageDescription": {
            "en": "Select an MFA method to use to sign on to your account."
          },
          "pageHeader": {
            "en": "Select Authentication Method"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "EMAIL",
              "displayName": "EMAIL"
            },
            {
              "id": "SMS",
              "displayName": "SMS"
            },
            {
              "id": "VOICE",
              "displayName": "VOICE"
            },
            {
              "id": "FIDO2",
              "displayName": "FIDO2"
            },
            {
              "id": "OATH",
              "displayName": "OATH"
            },
            {
              "id": "PUSH",
              "displayName": "PUSH"
            },
            {
              "id": "Magic Link",
              "displayName": "Magic Link"
            },
            {
              "id": "Error",
              "displayName": "Error"
            }
          ]
        },
        "0cfa645f-94e3-4a8e-8c64-fc13054a302c": {
          "_id": "0cfa645f-94e3-4a8e-8c64-fc13054a302c",
          "_rev": "-580204797",
          "script": "d7533919-235c-4548-99db-dd9cb33344ae",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "invalidCodeErrorMessage",
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "null"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "1d8f1610-0bf8-4d33-8ba1-57fa41ccb47e": {
          "_id": "1d8f1610-0bf8-4d33-8ba1-57fa41ccb47e",
          "_rev": "-1200212031",
          "emailSuspendMessage": {
            "en": "An email has been sent to the address you entered. Click the link in that email to proceed."
          },
          "emailTemplateName": "magicLinkTemplate",
          "identityAttribute": "userName",
          "emailAttribute": "mail",
          "objectLookup": true,
          "_type": {
            "_id": "EmailSuspendNode",
            "name": "Email Suspend Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "2276b39a-3e2a-4fd0-a831-44b1bd3a8a13": {
          "_id": "2276b39a-3e2a-4fd0-a831-44b1bd3a8a13",
          "_rev": "-182227476",
          "nodes": [
            {
              "_id": "38f15244-8bd2-41fb-8948-b51236285a6a",
              "nodeType": "ScriptedDecisionNode",
              "nodeVersion": 1,
              "displayName": "Validate Verification Code"
            },
            {
              "_id": "15f8e247-dc5a-46c9-b697-cf52286a8302",
              "nodeType": "OathTokenVerifierNode",
              "nodeVersion": 1,
              "displayName": "OATH Token Verifier"
            }
          ],
          "pageDescription": {},
          "pageHeader": {
            "en": "Enter Verification Code"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "successOutcome",
              "displayName": "Success"
            },
            {
              "id": "failureOutcome",
              "displayName": "Failure"
            },
            {
              "id": "notRegisteredOutcome",
              "displayName": "Not registered"
            },
            {
              "id": "recoveryCodeOutcome",
              "displayName": "Recovery Code"
            }
          ]
        },
        "35e54a17-213d-4603-9861-6bf9649dc7b4": {
          "_id": "35e54a17-213d-4603-9861-6bf9649dc7b4",
          "_rev": "-1426273131",
          "accountSID": "",
          "authToken": null,
          "channel": "SMS",
          "identifierSharedState": "userIdentifier",
          "serviceSID": "",
          "requestIdentifier": false,
          "_type": {
            "_id": "VerifyAuthSenderNode",
            "name": "Twilio Verify Sender",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "error",
              "displayName": "Error"
            }
          ]
        },
        "3bc40cbc-8a11-4295-8605-99aaac6e7ed8": {
          "_id": "3bc40cbc-8a11-4295-8605-99aaac6e7ed8",
          "_rev": "-778770575",
          "script": "1b225c20-fd83-4a16-afcb-b67a96cc9ca6",
          "outcomes": [
            "sent",
            "noMail",
            "error"
          ],
          "outputs": [
            "*"
          ],
          "inputs": [
            "_id",
            "oneTimePassword"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "sent",
              "displayName": "sent"
            },
            {
              "id": "noMail",
              "displayName": "noMail"
            },
            {
              "id": "error",
              "displayName": "error"
            }
          ]
        },
        "402c5d71-61a8-4ad3-b8c3-c55898a85466": {
          "_id": "402c5d71-61a8-4ad3-b8c3-c55898a85466",
          "_rev": "1137103884",
          "incrementUserAttributeOnFailure": true,
          "retryLimit": 3,
          "_type": {
            "_id": "RetryLimitDecisionNode",
            "name": "Retry Limit Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Retry",
              "displayName": "Retry"
            },
            {
              "id": "Reject",
              "displayName": "Reject"
            }
          ]
        },
        "44e7a69c-b220-4d4e-b0b7-6a0a45e3e126": {
          "_id": "44e7a69c-b220-4d4e-b0b7-6a0a45e3e126",
          "_rev": "-854751150",
          "identifierAttribute": "telephoneNumber",
          "identifierSharedState": "userIdentifier",
          "_type": {
            "_id": "VerifyAuthIdentifierNode",
            "name": "Twilio Identifier",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "True",
              "displayName": "True"
            },
            {
              "id": "False",
              "displayName": "False"
            },
            {
              "id": "Error",
              "displayName": "Error"
            }
          ]
        },
        "5715b985-231b-449e-b1a6-45853c1fae35": {
          "_id": "5715b985-231b-449e-b1a6-45853c1fae35",
          "_rev": "1930712207",
          "identifierAttribute": "telephoneNumber",
          "identifierSharedState": "userIdentifier",
          "_type": {
            "_id": "VerifyAuthIdentifierNode",
            "name": "Twilio Identifier",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "True",
              "displayName": "True"
            },
            {
              "id": "False",
              "displayName": "False"
            },
            {
              "id": "Error",
              "displayName": "Error"
            }
          ]
        },
        "59892180-4c18-4e1f-95f8-f78def8b752f": {
          "_id": "59892180-4c18-4e1f-95f8-f78def8b752f",
          "_rev": "778427846",
          "accountSID": "",
          "authToken": null,
          "channel": "CALL",
          "identifierSharedState": "userIdentifier",
          "serviceSID": "",
          "requestIdentifier": false,
          "_type": {
            "_id": "VerifyAuthSenderNode",
            "name": "Twilio Verify Sender",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "error",
              "displayName": "Error"
            }
          ]
        },
        "6aeb8029-6131-41af-9193-449058fb415d": {
          "_id": "6aeb8029-6131-41af-9193-449058fb415d",
          "_rev": "871181800",
          "incrementUserAttributeOnFailure": true,
          "retryLimit": 3,
          "_type": {
            "_id": "RetryLimitDecisionNode",
            "name": "Retry Limit Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Retry",
              "displayName": "Retry"
            },
            {
              "id": "Reject",
              "displayName": "Reject"
            }
          ]
        },
        "6d8e2a09-49cf-42e7-b94e-59046c7da9be": {
          "_id": "6d8e2a09-49cf-42e7-b94e-59046c7da9be",
          "_rev": "-2095837001",
          "identityAttribute": "userName",
          "identifier": "userName",
          "_type": {
            "_id": "IdentifyExistingUserNode",
            "name": "Identify Existing User",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "733d692c-ad82-48f1-bbc4-6855ab5212dc": {
          "_id": "733d692c-ad82-48f1-bbc4-6855ab5212dc",
          "_rev": "1924094664",
          "nodes": [
            {
              "_id": "4ed11f51-d804-46d5-aba8-7b5103571144",
              "nodeType": "ScriptedDecisionNode",
              "nodeVersion": 1,
              "displayName": "Validate OTP"
            },
            {
              "_id": "305b8554-2ab0-4070-aac4-7d9edd7ea04a",
              "nodeType": "OneTimePasswordCollectorDecisionNode",
              "nodeVersion": 1,
              "displayName": "OTP Collector Decision"
            }
          ],
          "pageDescription": {
            "en": "Enter the passcode you received."
          },
          "pageHeader": {
            "en": "Enter Passcode"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "76ac3d1a-82d6-4086-8513-9ced0858ee79": {
          "_id": "76ac3d1a-82d6-4086-8513-9ced0858ee79",
          "_rev": "1658410082",
          "script": "d7533919-235c-4548-99db-dd9cb33344ae",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "invalidCodeErrorMessage",
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "null"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "7859b9ee-0b45-4f4e-8cb9-5901cc8df6b2": {
          "_id": "7859b9ee-0b45-4f4e-8cb9-5901cc8df6b2",
          "_rev": "562255874",
          "detectSignCountMismatch": false,
          "requiresResidentKey": false,
          "asScript": true,
          "origins": [],
          "userVerificationRequirement": "PREFERRED",
          "isRecoveryCodeAllowed": true,
          "timeout": 60,
          "_type": {
            "_id": "WebAuthnAuthenticationNode",
            "name": "WebAuthn Authentication Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "unsupported",
              "displayName": "Unsupported"
            },
            {
              "id": "noDevice",
              "displayName": "No Device Registered"
            },
            {
              "id": "success",
              "displayName": "Success"
            },
            {
              "id": "failure",
              "displayName": "Failure"
            },
            {
              "id": "error",
              "displayName": "Client Error"
            },
            {
              "id": "recoveryCode",
              "displayName": "Recovery Code"
            }
          ]
        },
        "78aa469c-9a9a-4bdf-925b-4c2af282f877": {
          "_id": "78aa469c-9a9a-4bdf-925b-4c2af282f877",
          "_rev": "-2024372500",
          "script": "d7533919-235c-4548-99db-dd9cb33344ae",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "invalidCodeErrorMessage",
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "null"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "7ed73b41-e3ff-4a3a-a9c0-f1be6e06f6da": {
          "_id": "7ed73b41-e3ff-4a3a-a9c0-f1be6e06f6da",
          "_rev": "1826048243",
          "_type": {
            "_id": "PushResultVerifierNode",
            "name": "Push Result Verifier Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "TRUE",
              "displayName": "Success"
            },
            {
              "id": "FALSE",
              "displayName": "Failure"
            },
            {
              "id": "EXPIRED",
              "displayName": "Expired"
            },
            {
              "id": "WAITING",
              "displayName": "Waiting"
            }
          ]
        },
        "8ca347fe-adb9-4a6a-8cab-7ce8d20d7942": {
          "_id": "8ca347fe-adb9-4a6a-8cab-7ce8d20d7942",
          "_rev": "-1228256083",
          "script": "d7533919-235c-4548-99db-dd9cb33344ae",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "invalidCodeErrorMessage",
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "null"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "8dd2f089-ab42-4f3d-b754-86985f8156df": {
          "_id": "8dd2f089-ab42-4f3d-b754-86985f8156df",
          "_rev": "-2118214909",
          "nodes": [
            {
              "_id": "ccaec499-0207-40f1-825d-8ec7f60b80c0",
              "nodeType": "ScriptedDecisionNode",
              "nodeVersion": 1,
              "displayName": "Validate OTP"
            },
            {
              "_id": "861f3727-3d57-4f70-800b-1bbc34aa78cb",
              "nodeType": "VerifyAuthCollectorDecisionNode",
              "nodeVersion": 1,
              "displayName": "Twilio Verify Collector Decision"
            }
          ],
          "pageDescription": {
            "en": "Enter the passcode you received."
          },
          "pageHeader": {
            "en": "Enter Passcode"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            },
            {
              "id": "error",
              "displayName": "Error"
            }
          ]
        },
        "945ec619-8dfa-4904-aed3-d9fa8037d986": {
          "_id": "945ec619-8dfa-4904-aed3-d9fa8037d986",
          "_rev": "-1907102724",
          "incrementUserAttributeOnFailure": true,
          "retryLimit": 3,
          "_type": {
            "_id": "RetryLimitDecisionNode",
            "name": "Retry Limit Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Retry",
              "displayName": "Retry"
            },
            {
              "id": "Reject",
              "displayName": "Reject"
            }
          ]
        },
        "9d76e136-4862-4b1a-9ec1-d9a67d6f4797": {
          "_id": "9d76e136-4862-4b1a-9ec1-d9a67d6f4797",
          "_rev": "20510500",
          "script": "d7533919-235c-4548-99db-dd9cb33344ae",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "invalidCodeErrorMessage",
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "null"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "9fa48a27-b41a-4a53-9b22-7f305ad9c8c7": {
          "_id": "9fa48a27-b41a-4a53-9b22-7f305ad9c8c7",
          "_rev": "1007485789",
          "nodes": [
            {
              "_id": "6a426b2b-9e69-47ed-9d96-1027dacd6fcb",
              "nodeType": "ScriptedDecisionNode",
              "nodeVersion": 1,
              "displayName": "Validate Recovery Code"
            },
            {
              "_id": "21c58fc6-b8ec-4615-b42b-b2b2e4235b7b",
              "nodeType": "RecoveryCodeCollectorDecisionNode",
              "nodeVersion": 1,
              "displayName": "PUSH Recovery Code Collector Decision"
            }
          ],
          "pageDescription": {},
          "pageHeader": {
            "en": "Enter Recovery Code"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "9fec1a6e-78ea-4830-a226-9e63ffe61d08": {
          "_id": "9fec1a6e-78ea-4830-a226-9e63ffe61d08",
          "_rev": "467679062",
          "nodes": [
            {
              "_id": "5d64f2ec-c8a6-43b0-94cd-1162f74dbc01",
              "nodeType": "ScriptedDecisionNode",
              "nodeVersion": 1,
              "displayName": "Validate Recovery Code"
            },
            {
              "_id": "96ce645a-a8fb-4442-99fb-925fa6ca6de1",
              "nodeType": "RecoveryCodeCollectorDecisionNode",
              "nodeVersion": 1,
              "displayName": "OATH Recovery Code Collector Decision"
            }
          ],
          "pageDescription": {},
          "pageHeader": {
            "en": "Enter Recovery Code"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "a64f9e2f-1a86-430e-b3f6-7ff2d92c186e": {
          "_id": "a64f9e2f-1a86-430e-b3f6-7ff2d92c186e",
          "_rev": "925355998",
          "captureFailure": false,
          "contextInfo": false,
          "userMessage": {},
          "pushType": "DEFAULT",
          "customPayload": [],
          "mandatory": true,
          "messageTimeout": 120000,
          "_type": {
            "_id": "PushAuthenticationSenderNode",
            "name": "Push Sender",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "SENT",
              "displayName": "Sent"
            },
            {
              "id": "NOT_REGISTERED",
              "displayName": "Not Registered"
            }
          ]
        },
        "a7d2a8be-e923-4dc6-87f1-4fc878d77cfc": {
          "_id": "a7d2a8be-e923-4dc6-87f1-4fc878d77cfc",
          "_rev": "166315148",
          "nodes": [
            {
              "_id": "eceb88a4-363b-45ab-8092-8d810698d81e",
              "nodeType": "ScriptedDecisionNode",
              "nodeVersion": 1,
              "displayName": "Validate Recovery Code"
            },
            {
              "_id": "9bd1d9b6-fb69-4c4e-bb01-c5080779b578",
              "nodeType": "RecoveryCodeCollectorDecisionNode",
              "nodeVersion": 1,
              "displayName": "WEB_AUTHN Recovery Code Collector Decision"
            }
          ],
          "pageDescription": {},
          "pageHeader": {
            "en": "Enter Recovery Code"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "b51ba06b-8094-475c-8293-3f3133fd0baa": {
          "_id": "b51ba06b-8094-475c-8293-3f3133fd0baa",
          "_rev": "-132142528",
          "length": 6,
          "_type": {
            "_id": "OneTimePasswordGeneratorNode",
            "name": "HOTP Generator",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "cc12937b-69bb-46e8-91ab-34504bd6f316": {
          "_id": "cc12937b-69bb-46e8-91ab-34504bd6f316",
          "_rev": "940890469",
          "incrementUserAttributeOnFailure": true,
          "retryLimit": 3,
          "_type": {
            "_id": "RetryLimitDecisionNode",
            "name": "Retry Limit Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Retry",
              "displayName": "Retry"
            },
            {
              "id": "Reject",
              "displayName": "Reject"
            }
          ]
        },
        "cc2964e1-ade1-4087-bec0-0f1db5b020e8": {
          "_id": "cc2964e1-ade1-4087-bec0-0f1db5b020e8",
          "_rev": "10009568",
          "incrementUserAttributeOnFailure": true,
          "retryLimit": 3,
          "_type": {
            "_id": "RetryLimitDecisionNode",
            "name": "Retry Limit Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Retry",
              "displayName": "Retry"
            },
            {
              "id": "Reject",
              "displayName": "Reject"
            }
          ]
        },
        "d3c385db-0014-475b-8d79-681f0424c1cc": {
          "_id": "d3c385db-0014-475b-8d79-681f0424c1cc",
          "_rev": "240664844",
          "incrementUserAttributeOnFailure": true,
          "retryLimit": 3,
          "_type": {
            "_id": "RetryLimitDecisionNode",
            "name": "Retry Limit Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Retry",
              "displayName": "Retry"
            },
            {
              "id": "Reject",
              "displayName": "Reject"
            }
          ]
        },
        "e358c23f-3199-423c-8819-cf067f6fb2ed": {
          "_id": "e358c23f-3199-423c-8819-cf067f6fb2ed",
          "_rev": "552273325",
          "script": "d7533919-235c-4548-99db-dd9cb33344ae",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "invalidCodeErrorMessage",
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "null"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "e69c9588-f8e1-4c6d-ac3a-3f035611880c": {
          "_id": "e69c9588-f8e1-4c6d-ac3a-3f035611880c",
          "_rev": "-1833812100",
          "challengeMessage": {},
          "exitMessage": {},
          "waitingMessage": {},
          "secondsToWait": 5,
          "_type": {
            "_id": "PushWaitNode",
            "name": "Push Wait Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "DONE",
              "displayName": "Done"
            },
            {
              "id": "EXITED",
              "displayName": "Exit"
            }
          ]
        },
        "f8cd1bb2-a0a7-4b6b-bf80-6a39c2123014": {
          "_id": "f8cd1bb2-a0a7-4b6b-bf80-6a39c2123014",
          "_rev": "1559586210",
          "incrementUserAttributeOnFailure": true,
          "retryLimit": 3,
          "_type": {
            "_id": "RetryLimitDecisionNode",
            "name": "Retry Limit Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Retry",
              "displayName": "Retry"
            },
            {
              "id": "Reject",
              "displayName": "Reject"
            }
          ]
        }
      },
      "innerNodes": {
        "a5f50d0b-5dba-41fa-bbd0-d23ade1565d9": {
          "_id": "a5f50d0b-5dba-41fa-bbd0-d23ade1565d9",
          "_rev": "-1235538225",
          "script": "1125d585-0e19-4677-bd18-aa97a800b45d",
          "outcomes": [
            "EMAIL",
            "SMS",
            "VOICE",
            "FIDO2",
            "OATH",
            "PUSH",
            "Magic Link",
            "Error"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "_id",
            "ciam_allowedMFATypes",
            "ciam_magicLinkEnabled"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "EMAIL",
              "displayName": "EMAIL"
            },
            {
              "id": "SMS",
              "displayName": "SMS"
            },
            {
              "id": "VOICE",
              "displayName": "VOICE"
            },
            {
              "id": "FIDO2",
              "displayName": "FIDO2"
            },
            {
              "id": "OATH",
              "displayName": "OATH"
            },
            {
              "id": "PUSH",
              "displayName": "PUSH"
            },
            {
              "id": "Magic Link",
              "displayName": "Magic Link"
            },
            {
              "id": "Error",
              "displayName": "Error"
            }
          ]
        },
        "38f15244-8bd2-41fb-8948-b51236285a6a": {
          "_id": "38f15244-8bd2-41fb-8948-b51236285a6a",
          "_rev": "-598695322",
          "script": "87cc8351-0d8c-4879-acee-6ddc72b29edc",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails",
            "invalidCodeErrorMessage"
          ],
          "inputs": [
            "invalidCodeErrorMessage"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "15f8e247-dc5a-46c9-b697-cf52286a8302": {
          "_id": "15f8e247-dc5a-46c9-b697-cf52286a8302",
          "_rev": "513042455",
          "totpTimeInterval": 30,
          "maximumAllowedClockDrift": 5,
          "totpTimeSteps": 2,
          "totpHashAlgorithm": "HMAC_SHA1",
          "isRecoveryCodeAllowed": true,
          "algorithm": "TOTP",
          "hotpWindowSize": 100,
          "_type": {
            "_id": "OathTokenVerifierNode",
            "name": "OATH Token Verifier",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "successOutcome",
              "displayName": "Success"
            },
            {
              "id": "failureOutcome",
              "displayName": "Failure"
            },
            {
              "id": "notRegisteredOutcome",
              "displayName": "Not registered"
            },
            {
              "id": "recoveryCodeOutcome",
              "displayName": "Recovery Code"
            }
          ]
        },
        "4ed11f51-d804-46d5-aba8-7b5103571144": {
          "_id": "4ed11f51-d804-46d5-aba8-7b5103571144",
          "_rev": "-1122680624",
          "script": "ee3e8507-00ff-48e8-a861-ea3a87a0c278",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails",
            "invalidCodeErrorMessage"
          ],
          "inputs": [
            "invalidCodeErrorMessage",
            "oneTimePassword"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "305b8554-2ab0-4070-aac4-7d9edd7ea04a": {
          "_id": "305b8554-2ab0-4070-aac4-7d9edd7ea04a",
          "_rev": "1193970560",
          "passwordExpiryTime": 5,
          "_type": {
            "_id": "OneTimePasswordCollectorDecisionNode",
            "name": "OTP Collector Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "ccaec499-0207-40f1-825d-8ec7f60b80c0": {
          "_id": "ccaec499-0207-40f1-825d-8ec7f60b80c0",
          "_rev": "1473180410",
          "script": "ee3e8507-00ff-48e8-a861-ea3a87a0c278",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails",
            "invalidCodeErrorMessage"
          ],
          "inputs": [
            "invalidCodeErrorMessage"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "861f3727-3d57-4f70-800b-1bbc34aa78cb": {
          "_id": "861f3727-3d57-4f70-800b-1bbc34aa78cb",
          "_rev": "189927325",
          "hideCode": true,
          "resendButtonText": "resend",
          "showCancelButton": false,
          "cancelButtonText": "cancel",
          "identifierSharedState": "userIdentifier",
          "nextButtonText": "next",
          "showResendButton": false,
          "_type": {
            "_id": "VerifyAuthCollectorDecisionNode",
            "name": "Twilio Verify Collector Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            },
            {
              "id": "error",
              "displayName": "Error"
            }
          ]
        },
        "6a426b2b-9e69-47ed-9d96-1027dacd6fcb": {
          "_id": "6a426b2b-9e69-47ed-9d96-1027dacd6fcb",
          "_rev": "1200121174",
          "script": "a6c73f01-13f2-428d-9fc2-8fccbdc4b2d0",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails",
            "invalidCodeErrorMessage"
          ],
          "inputs": [
            "invalidCodeErrorMessage"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "21c58fc6-b8ec-4615-b42b-b2b2e4235b7b": {
          "_id": "21c58fc6-b8ec-4615-b42b-b2b2e4235b7b",
          "_rev": "521509512",
          "recoveryCodeType": "PUSH",
          "_type": {
            "_id": "RecoveryCodeCollectorDecisionNode",
            "name": "Recovery Code Collector Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "5d64f2ec-c8a6-43b0-94cd-1162f74dbc01": {
          "_id": "5d64f2ec-c8a6-43b0-94cd-1162f74dbc01",
          "_rev": "1715242946",
          "script": "a6c73f01-13f2-428d-9fc2-8fccbdc4b2d0",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails",
            "invalidCodeErrorMessage"
          ],
          "inputs": [
            "invalidCodeErrorMessage"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "96ce645a-a8fb-4442-99fb-925fa6ca6de1": {
          "_id": "96ce645a-a8fb-4442-99fb-925fa6ca6de1",
          "_rev": "-439537375",
          "recoveryCodeType": "OATH",
          "_type": {
            "_id": "RecoveryCodeCollectorDecisionNode",
            "name": "Recovery Code Collector Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "eceb88a4-363b-45ab-8092-8d810698d81e": {
          "_id": "eceb88a4-363b-45ab-8092-8d810698d81e",
          "_rev": "-1611199840",
          "script": "a6c73f01-13f2-428d-9fc2-8fccbdc4b2d0",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails",
            "invalidCodeErrorMessage"
          ],
          "inputs": [
            "invalidCodeErrorMessage"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "9bd1d9b6-fb69-4c4e-bb01-c5080779b578": {
          "_id": "9bd1d9b6-fb69-4c4e-bb01-c5080779b578",
          "_rev": "-990331899",
          "recoveryCodeType": "WEB_AUTHN",
          "_type": {
            "_id": "RecoveryCodeCollectorDecisionNode",
            "name": "Recovery Code Collector Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        }
      },
      "scripts": {
        "d7533919-235c-4548-99db-dd9cb33344ae": {
          "_id": "d7533919-235c-4548-99db-dd9cb33344ae",
          "name": "Threat Detection - Set Invalid code error message",
          "description": "Script to set invalid code error message",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: null\\n    - Script Outputs: \\\"invalidCodeErrorMessage\\\", \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\n// Set the below error message in shared state, can be displayed on the last UI Node\\n\\ntry {\\n    nodeState.putShared(\\\"invalidCodeErrorMessage\\\", \\\"Invalid Code\\\");\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error\\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925703,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083351,
          "evaluatorVersion": "2.0"
        },
        "1b225c20-fd83-4a16-afcb-b67a96cc9ca6": {
          "_id": "1b225c20-fd83-4a16-afcb-b67a96cc9ca6",
          "name": "Threat Detection - Send OTP email",
          "description": "Script to send next-gen templated email containing a generated one-time password to the user.",
          "script": "\"/**\\n * @file This script sends a templated HOTP to a user via the IDM's configured email service\\n * using the openidm binding in next-gen scripting\\n * NOTE - The use of SendGrid is not supported in Production and must be changed to your own email service\\n * Steps are here: https://backstage.forgerock.com/docs/idcloud/latest/tenants/email-provider.html#external_smtp_email_server\\n * @version 0.2.0\\n * @keywords email mail hotp sharedState transientState templateService\\n */\\n\\n/**\\n * Script configuration\\n*/\\n\\n// Initialise the logger called ds-node-logger-lib library script\\nXLogger = require(\\\"ds-node-logger-lib\\\").XLogger;\\nlogger = new XLogger(this);\\n\\nvar config = {\\n    /**\\n     * @property {string} templateID - Identifier of email template\\n     * @property {string} idmEndpoint - IDM Endpoint used to send templated emails\\n     * @property {string} idmAction - IDM action executed against the idmEndpoint\\n     */\\n\\n    templateID: \\\"otp\\\",\\n    idmEndpoint: \\\"external/email\\\",\\n    idmAction: \\\"sendTemplate\\\"\\n};\\n\\n/**\\n * Node outcomes\\n*/\\nvar nodeOutcome = {\\n    PASS: \\\"sent\\\",\\n    FAIL: \\\"noMail\\\",\\n    ERROR: \\\"error\\\"\\n};\\n\\n/**\\n * Send email via the IDM Email Service openidm binding in next-gen scripting\\n * \\n * @param {string} hotp - HOTP retrieved from transientState\\n * @param {string} mail - mail attribute retrieved from the idRepository. Note if this is a registration journey acquire mail from sharedState\\n * @param {string} givenName - givenName attribute retrieved from the idRepository. Note if this is a registration journey acquire givenName from sharedState\\n */\\n\\nfunction sendMail(hotp, mail, givenName) {\\n    try {\\n        var params = new Object();\\n        params.templateName = config.templateID;\\n        params.to = mail;\\n        params.object = {\\n            \\\"givenName\\\": givenName,\\n            \\\"otp\\\": hotp\\n        };\\n        openidm.action(config.idmEndpoint, config.idmAction, params);\\n        logger.error(\\\"Email send successfully\\\");\\n        return nodeOutcome.PASS;\\n    }\\n    catch (e) {\\n        logger.error(\\\"Failed to call IDM Email endpoint using template. Exception is: \\\" + e);\\n        return nodeOutcome.ERROR;\\n    }\\n};\\n\\n/**\\n * Main function\\n */\\n\\n(function () {\\n    logger.error(\\\"Node execution started\\\");\\n    var id;\\n    var hotp;\\n    var mail;\\n\\n    if (!(id = nodeState.get(\\\"_id\\\"))) {\\n        logger.error(\\\"Unable to retrieve Identity\\\");\\n        action.goTo(nodeOutcome.ERROR);\\n        return;\\n    } else {\\n        var identity = idRepository.getIdentity(id);\\n    }\\n\\n    if (!(hotp = nodeState.get(\\\"oneTimePassword\\\"))) {\\n        logger.error(\\\"Unable to retrieve HOTP from state\\\");\\n        action.goTo(nodeOutcome.ERROR);\\n        return;\\n    }\\n\\n    //If this is a registration journey adapt the following to try retrieve from nodeState\\n    if (!(mail = identity.getAttributeValues(\\\"mail\\\").toArray()[0])) {\\n        logger.error(\\\"Unable to retrieve mail attribute from the idRepository\\\");\\n        action.goTo(nodeOutcome.FAIL);\\n        return;\\n    }\\n\\n    //If this is a registration journey adapt the following to try retrieve from nodeState\\n    //Be sure to set givenName against the user\\n    if (!(givenName = identity.getAttributeValues(\\\"givenName\\\").toArray()[0])) {\\n        logger.error(\\\"Unable to retrieve givenName attribute from the idRepository\\\");\\n        action.goTo(nodeOutcome.FAIL);\\n        return;\\n    }\\n\\n    //Execute function to send mail\\n    outcome = sendMail(hotp, mail, givenName);\\n})();\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925691,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083484,
          "evaluatorVersion": "2.0"
        },
        "1125d585-0e19-4677-bd18-aa97a800b45d": {
          "_id": "1125d585-0e19-4677-bd18-aa97a800b45d",
          "name": "Threat Detection - Get user's registered MFA devices",
          "description": "Script to fetch user's registered MFA methods",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: \\\"_id\\\", \\\"ciam_allowedMFATypes\\\", \\\"ciam_magicLinkEnabled\\\"\\n    - Script Outputs: \\\"usableMFADevices\\\", \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"true\\\", \\\"Error\\\"\\n*/\\n\\ntry {\\n    // Retrieve user ID and allowed MFA devices\\n    var userId = nodeState.get(\\\"_id\\\");\\n    var allowedMFAMethods = nodeState.get(\\\"ciam_allowedMFATypes\\\");\\n    \\n    var mfaMapping = {\\n        \\\"EMAIL\\\": \\\"allowEmail\\\",\\n        \\\"SMS\\\": \\\"allowSMS\\\",\\n        \\\"VOICE\\\": \\\"allowVoice\\\",\\n        \\\"OATH\\\": \\\"allowOATH\\\",\\n        \\\"PUSH\\\": \\\"allowPush\\\",\\n        \\\"FIDO2\\\": \\\"allowFIDO2\\\"\\n    };\\n    \\n    var allowEmail = false, allowSMS = false, allowVoice = false, allowOATH = false, allowPush = false, allowFIDO2 = false;\\n    \\n    allowedMFAMethods.forEach(device => {\\n        if (mfaMapping[device]) {\\n            this[mfaMapping[device]] = true;\\n        }\\n    });\\n    \\n    var mfaDevicesObj = openidm.read(\\\"managed/alpha_user/\\\" + userId, null, [\\\"custom_mfaDevices\\\"]);\\n    var mfaDevices = (mfaDevicesObj && mfaDevicesObj.custom_mfaDevices) ? mfaDevicesObj.custom_mfaDevices : [];\\n    \\n    // By default returned mfaDevices is of Object type so values are parsed in a new array\\n    var usableMFADevices = [];\\n    \\n    // Store MFA devices and additional option in shared state    \\n    mfaDevices.forEach(device => {\\n        usableMFADevices.push(device);\\n    });\\n    \\n    usableMFADevices = usableMFADevices.filter(device =>\\n        (device === \\\"SMS\\\" && allowSMS) ||\\n        (device === \\\"EMAIL\\\" && allowEmail) ||\\n        (device === \\\"VOICE\\\" && allowVoice) ||\\n        (device === \\\"OATH\\\" && allowOATH) ||\\n        (device === \\\"PUSH\\\" && allowPush) ||\\n        (device === \\\"FIDO2\\\" && allowFIDO2)                               \\n    );\\n\\n    // Index of latest registered MFA device\\n    var idxLatestMFADevice = usableMFADevices ? usableMFADevices.length - 1 : -1;\\n    \\n    // Add Magic Link, if enabled by Admin\\n    var magicLinkEnabled = nodeState.get(\\\"ciam_magicLinkEnabled\\\");\\n    if(magicLinkEnabled) usableMFADevices.push(\\\"Magic Link\\\");\\n    \\n    // nodeState.putShared(\\\"usableMFADevices\\\", usableMFADevices);\\n    \\n    // Handle callback logic\\n    if (callbacks.isEmpty()) {\\n      callbacksBuilder.choiceCallback(\\\"Select an MFA device\\\", usableMFADevices, idxLatestMFADevice, false);\\n    } else {\\n      // Callbacks returned from browser, save selected choice\\n      var index = callbacks.getChoiceCallbacks().get(0)[0];\\n      var selectedDevice = usableMFADevices[index] || null;\\n    \\n      if (!selectedDevice) {\\n        nodeState.putShared(\\\"errorMessage\\\", \\\"No registered MFA device found\\\");\\n        // Go to error  \\n        action.goTo(\\\"Error\\\");\\n      } else {\\n        // Go to authentication for that selected MFA device\\n        action.goTo(selectedDevice);\\n      }\\n    }\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error  \\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925691,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083469,
          "evaluatorVersion": "2.0"
        },
        "87cc8351-0d8c-4879-acee-6ddc72b29edc": {
          "_id": "87cc8351-0d8c-4879-acee-6ddc72b29edc",
          "name": "Threat Detection - Validate verification code",
          "description": "Script to validate verification code input, sets constraints, and enables/disables the submit button based on validity",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n*/\\n\\n/*\\n    - Script Inputs: \\\"invalidCodeErrorMessage\\\"\\n    - Script Outputs: \\\"errorMessage\\\", \\\"errorDetails\\\", \\\"invalidCodeErrorMessage\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\ntry {\\n    function validateInput() {\\n        return String(\\\" \\\\n\\\\\\n                    // Validate the verification code \\\\n\\\\\\n                    function validateCode() { \\\\n\\\\\\n                        const submitBtn = document.querySelectorAll('button[type=\\\\\\\"button\\\\\\\"]')[0]; \\\\n\\\\\\n                        const verificationCode = document.querySelectorAll('input[data-vv-as=\\\\\\\"Enter verification code\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (verificationCode) { \\\\n\\\\\\n                            // Set input properties to prevent user tampering \\\\n\\\\\\n                            verificationCode.setAttribute('maxlength', '6'); \\\\n\\\\\\n                            verificationCode.setAttribute('pattern', '[0-9]{6}'); \\\\n\\\\\\n                            verificationCode.setAttribute('inputmode', 'numeric'); \\\\n\\\\\\n                            // Check if the input is exactly 6 digits long and numeric \\\\n\\\\\\n                            const isValidCode = /^[0-9]{6}$/.test(verificationCode.value); \\\\n\\\\\\n                            submitBtn.disabled = !isValidCode; \\\\n\\\\\\n                            return isValidCode; \\\\n\\\\\\n                        } \\\\n\\\\\\n                        return false; \\\\n\\\\\\n                    }; \\\\n\\\\\\n                    \\\\n\\\\\\n                    function preventEnterKeyDefault(event) { \\\\n\\\\\\n                        const submitBtn = document.querySelectorAll('button[type=\\\\\\\"button\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (event.key === 'Enter' && !validateCode()) { \\\\n\\\\\\n                            event.preventDefault(); \\\\n\\\\\\n                            if (submitBtn) submitBtn.disabled = true; \\\\n\\\\\\n                        } \\\\n\\\\\\n                    } \\\\n\\\\\\n                    \\\\n\\\\\\n                    function go(obs) { \\\\n\\\\\\n                        // Auto-submit and go to 'Not Registered' path if method is not registered for the user, in that case it is assumed that button will be of type submit from Page Node \\\\n\\\\\\n                        const nextBtn = document.querySelectorAll('button[type=\\\\\\\"submit\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (nextBtn) { \\\\n\\\\\\n                            nextBtn.style.visibility='hidden'; \\\\n\\\\\\n                            nextBtn.click(); \\\\n\\\\\\n                        } \\\\n\\\\\\n                        const submitBtn = document.querySelectorAll('button[type=\\\\\\\"button\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (submitBtn) submitBtn.disabled = true; \\\\n\\\\\\n                        const verificationCode = document.querySelectorAll('input[data-vv-as=\\\\\\\"Enter verification code\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (verificationCode && submitBtn) { \\\\n\\\\\\n                            verificationCode.addEventListener('input', validateCode); \\\\n\\\\\\n                            verificationCode.addEventListener('keypress', preventEnterKeyDefault); \\\\n\\\\\\n                            submitBtn.addEventListener('click', (event) => { \\\\n\\\\\\n                                if (!validateCode()) { \\\\n\\\\\\n                                    event.preventDefault(); \\\\n\\\\\\n                                    submitBtn.disabled = true; \\\\n\\\\\\n                                } \\\\n\\\\\\n                            }); \\\\n\\\\\\n                            if (obs) obs.disconnect(); \\\\n\\\\\\n                            return; \\\\n\\\\\\n                        } \\\\n\\\\\\n                    } \\\\n\\\\\\n                    \\\\n\\\\\\n                    // If both elements are present, initialize validation \\\\n\\\\\\n                    if (document.querySelectorAll('button[type=\\\\\\\"button\\\\\\\"]')[0] && document.querySelectorAll('input[data-vv-as=\\\\\\\"Enter verification code\\\\\\\"]')[0]) go(); \\\\n\\\\\\n                    else { \\\\n\\\\\\n                        const observer = new MutationObserver((mutations, obs) => { go(obs); }); \\\\n\\\\\\n                        observer.observe(document, { childList: true, subtree: true }); \\\\n\\\\\\n                    } \\\\n\\\\\\n        \\\");\\n    }\\n\\n    var invalidCodeErrorMessage = nodeState.get(\\\"invalidCodeErrorMessage\\\");\\n    nodeState.putShared(\\\"invalidCodeErrorMessage\\\", \\\"\\\");\\n    \\n    if (callbacks.isEmpty()) {\\n        // Display error message if invalid code entered by user\\n        if (invalidCodeErrorMessage && invalidCodeErrorMessage.length) callbacksBuilder.textOutputCallback(2, invalidCodeErrorMessage);\\n        // Request callbacks\\n        callbacksBuilder.scriptTextOutputCallback(validateInput());\\n    }\\n    // Go to true path\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error  \\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925688,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083463,
          "evaluatorVersion": "2.0"
        },
        "ee3e8507-00ff-48e8-a861-ea3a87a0c278": {
          "_id": "ee3e8507-00ff-48e8-a861-ea3a87a0c278",
          "name": "Threat Detection - Validate OTP input",
          "description": "Script to validate OTP input, sets constraints, and enables/disables the submit button based on validity",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: \\\"oneTimePassword\\\", \\\"invalidCodeErrorMessage\\\"\\n    - Script Outputs: \\\"errorMessage\\\", \\\"errorDetails\\\", \\\"invalidCodeErrorMessage\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\n// Note: If HOTP Genrator node is used in prior, \\\"oneTimePassword\\\" will be a transient state property, make sure to make it available in script inputs. \\n// If the OTP is generated by Twilio nodes, the default length is set to 6 and only digits are considered. Modify this if necessary.\\n\\ntry {\\n    function validateInput(otpLength) {\\n        return String(\\\" \\\\n\\\\\\n                    var otpLength = \\\" + otpLength + \\\" \\\\n\\\\\\n                    const submitBtn = document.querySelectorAll('button[type=\\\\\\\"submit\\\\\\\"]')[0]; \\\\n\\\\\\n                    if (submitBtn) submitBtn.disabled = true; \\\\n\\\\\\n                    // Validate the passcode \\\\n\\\\\\n                    function validateCode() { \\\\n\\\\\\n                        const passcode = document.querySelectorAll('input[data-vv-as=\\\\\\\"One Time Password\\\\\\\"]')[0] || document.querySelectorAll('input[data-vv-as=\\\\\\\"Code\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (passcode) { \\\\n\\\\\\n                            // Set input properties to prevent user tampering \\\\n\\\\\\n                            passcode.setAttribute('maxlength', otpLength); \\\\n\\\\\\n                            passcode.setAttribute('pattern', '[0-9]{' + otpLength + '}'); \\\\n\\\\\\n                            passcode.setAttribute('inputmode', 'numeric'); \\\\n\\\\\\n                            // Check if the input is exactly 6 digits long and numeric \\\\n\\\\\\n                            const isValidCode = new RegExp('^[0-9]{' + otpLength + '}$').test(passcode.value); \\\\n\\\\\\n                            submitBtn.disabled = !isValidCode; \\\\n\\\\\\n                            return isValidCode; \\\\n\\\\\\n                        } \\\\n\\\\\\n                        return false; \\\\n\\\\\\n                    }; \\\\n\\\\\\n                    \\\\n\\\\\\n                    function go(obs) { \\\\n\\\\\\n                        const passcode = document.querySelectorAll('input[data-vv-as=\\\\\\\"One Time Password\\\\\\\"]')[0] || document.querySelectorAll('input[data-vv-as=\\\\\\\"Code\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (passcode && submitBtn) { \\\\n\\\\\\n                            passcode.addEventListener('input', validateCode); \\\\n\\\\\\n                            submitBtn.addEventListener('click', (event) => { \\\\n\\\\\\n                                if (!validateCode()) { \\\\n\\\\\\n                                    event.preventDefault(); \\\\n\\\\\\n                                    submitBtn.disabled = true; \\\\n\\\\\\n                                } \\\\n\\\\\\n                            }); \\\\n\\\\\\n                            if (obs) obs.disconnect(); \\\\n\\\\\\n                            return; \\\\n\\\\\\n                        } \\\\n\\\\\\n                    } \\\\n\\\\\\n                    \\\\n\\\\\\n                    // For HOTP and Twilio OTP collector nodes, if either of the element is present, initialize validation \\\\n\\\\\\n                    if (document.querySelectorAll('input[data-vv-as=\\\\\\\"One Time Password\\\\\\\"]')[0] || document.querySelectorAll('input[data-vv-as=\\\\\\\"Code\\\\\\\"]')[0]) go(); \\\\n\\\\\\n                    else { \\\\n\\\\\\n                        const observer = new MutationObserver((mutations, obs) => { go(obs); }); \\\\n\\\\\\n                        observer.observe(document, { childList: true, subtree: true }); \\\\n\\\\\\n                    } \\\\n\\\\\\n        \\\");\\n    }\\n\\n    var invalidCodeErrorMessage = nodeState.get(\\\"invalidCodeErrorMessage\\\");\\n    nodeState.putShared(\\\"invalidCodeErrorMessage\\\", \\\"\\\");\\n\\n    // Get \\\"oneTimePassword\\\" shared in transient state by the HOTP Generator node or default it to 6\\n    var otpLength = nodeState.get(\\\"oneTimePassword\\\") ? nodeState.get(\\\"oneTimePassword\\\").length : 6;\\n    \\n    if (callbacks.isEmpty()) {\\n        // Display error message if invalid code entered by user\\n        if (invalidCodeErrorMessage && invalidCodeErrorMessage.length) callbacksBuilder.textOutputCallback(2, invalidCodeErrorMessage);\\n        // Request callbacks\\n        callbacksBuilder.scriptTextOutputCallback(validateInput(otpLength));\\n    }\\n    // Go to true path\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error  \\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925704,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083450,
          "evaluatorVersion": "2.0"
        },
        "a6c73f01-13f2-428d-9fc2-8fccbdc4b2d0": {
          "_id": "a6c73f01-13f2-428d-9fc2-8fccbdc4b2d0",
          "name": "Threat Detection - Validate Recovery Code input",
          "description": "Script to validate Recovery code input, sets constraints, and enables/disables the submit button based on validity",
          "script": "\"// /*\\n//   - Data made available by nodes that have already executed are available in the sharedState variable.\\n//   - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n//  */\\n\\n/*\\n    - Script Inputs: \\\"invalidCodeErrorMessage\\\"\\n    - Script Outputs: \\\"errorMessage\\\", \\\"errorDetails\\\", \\\"invalidCodeErrorMessage\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\ntry {\\n    function validateInput() {\\n        return String(\\\" \\\\n\\\\\\n                    const submitBtn = document.querySelectorAll('button[type=\\\\\\\"submit\\\\\\\"]')[0]; \\\\n\\\\\\n                    if(submitBtn) submitBtn.disabled = true; \\\\n\\\\\\n                    function go(obs) { \\\\n\\\\\\n                        const recoveryCode = document.querySelectorAll('input[data-vv-as=\\\\\\\"Recovery Code\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (recoveryCode && submitBtn) { \\\\n\\\\\\n                            // Set the maxlength attribute to 10 \\\\n\\\\\\n                            recoveryCode.setAttribute('maxlength', 10); \\\\n\\\\\\n                            const enableSubmitBtn = () => { \\\\n\\\\\\n                                // Check input validity before enabling submit button \\\\n\\\\\\n                                const isValidInput = recoveryCode.value.length === 10; \\\\n\\\\\\n                                if (isValidInput) { \\\\n\\\\\\n                                    submitBtn.disabled = false; \\\\n\\\\\\n                                } else { \\\\n\\\\\\n                                    submitBtn.disabled = true; \\\\n\\\\\\n                                } \\\\n\\\\\\n                            }; \\\\n\\\\\\n                            // Revalidate before form submission \\\\n\\\\\\n                            submitBtn.addEventListener('click', (event) => { \\\\n\\\\\\n                                const isValidInput = recoveryCode.value.length === 10; \\\\n\\\\\\n                                if (!isValidInput) { \\\\n\\\\\\n                                    event.preventDefault(); \\\\n\\\\\\n                                    submitBtn.disabled = true; \\\\n\\\\\\n                                } \\\\n\\\\\\n                            }); \\\\n\\\\\\n                            recoveryCode.addEventListener('input', enableSubmitBtn); \\\\n\\\\\\n                            if (obs) obs.disconnect(); \\\\n\\\\\\n                            return; \\\\n\\\\\\n                       } \\\\n\\\\\\n                      } \\\\n\\\\\\n                      if (document.querySelectorAll('input[data-vv-as=\\\\\\\"Recovery Code\\\\\\\"]')[0]) go(); \\\\n\\\\\\n                      else { \\\\n\\\\\\n                        const observer = new MutationObserver((mutations, obs) => { go(obs); }); \\\\n\\\\\\n                        observer.observe(document, { childList: true, subtree: true }); \\\\n\\\\\\n                      } \\\\n\\\\\\n        \\\");\\n    }\\n\\n    var invalidCodeErrorMessage = nodeState.get(\\\"invalidCodeErrorMessage\\\");\\n    nodeState.putShared(\\\"invalidCodeErrorMessage\\\", \\\"\\\");\\n    \\n    if (callbacks.isEmpty()) {                \\n        // Display error message if invalid code entered by user\\n        if (invalidCodeErrorMessage && invalidCodeErrorMessage.length) callbacksBuilder.textOutputCallback(2, invalidCodeErrorMessage);\\n        // Request callbacks\\n        callbacksBuilder.scriptTextOutputCallback(validateInput());\\n    }\\n    // Go to true path\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error  \\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925690,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083411,
          "evaluatorVersion": "2.0"
        }
      },
      "emailTemplates": {
        "magicLinkTemplate": {
          "_id": "emailTemplate/magicLinkTemplate",
          "advancedEditor": true,
          "defaultLocale": "en",
          "description": "To authenticate with email address ",
          "displayName": "Magic Link Template",
          "enabled": true,
          "from": "",
          "html": {
            "en": "",
            "fr": ""
          },
          "message": {
            "en": "<div style=\"display:block;text-align:center;font-family:sans-serif;border:1px solid #c5c5c5;width:400px;padding:30px 20px\">\n  <img src=\"https://assets.pingone.com/ux/ui-library/5.0.2/images/logo-pingidentity.png\" alt=\"Company Logo\" style=\"height:65px;margin-bottom:10px\" />\n  <h1>Sign On Request</h1>\n  <div style=\"margin-top:20px;margin-bottom:25px\">\n    <p>Please click the link below to authenticate. </p>\n    <a href=\"{{object.resumeURI}}\" style=\"font-size:14pt\">Complete Sign On</a>\n  </div>\n</div>",
            "fr": "<html>\n  <head></head>\n  <body style=\"background-color: #324054; color: #5e6d82; padding: 60px; text-align: center;\">\n    <h3>Ceci est votre mail d'inscription.</h3>\n    <p>\n      <a href=\"{{object.resumeURI}}\" style=\"text-decoration: none; color: #109cf1;\">Lien de vérification email</a>\n    </p>\n  </body>\n</html>"
          },
          "mimeType": "text/html",
          "styles": "body{background-color:#324054;color:#5e6d82;padding:60px;text-align:center}a{text-decoration:none;color:#109cf1}.content{background-color:#fff;border-radius:4px;margin:0 auto;padding:48px;width:235px}",
          "subject": {
            "en": "Sign On Request",
            "fr": "Créer un nouveau compte"
          },
          "templateId": "magicLinkTemplate"
        }
      },
      "socialIdentityProviders": {},
      "themes": [],
      "saml2Entities": {},
      "circlesOfTrust": {}
    },
    "MFA Device Registration - Inner Journey": {
      "tree": {
        "_id": "MFA Device Registration - Inner Journey",
        "_rev": "-43074817",
        "identityResource": "managed/alpha_user",
        "entryNodeId": "5820deb1-d71d-4754-97fc-cda5ee8b6416",
        "innerTreeOnly": true,
        "noSession": false,
        "mustRun": false,
        "enabled": true,
        "transactionalOnly": false,
        "uiConfig": {
          "categories": "[\"Threat Detection\"]"
        },
        "nodes": {
          "2b779980-8038-4f29-ad31-a754b6baba01": {
            "connections": {
              "error": "e301438c-0bd0-429c-ab0c-66126501069a",
              "true": "5db175d6-78ad-4020-87e7-8afae5e1a729"
            },
            "displayName": "Twilio Verify Sender",
            "nodeType": "VerifyAuthSenderNode",
            "x": 1382,
            "y": 1238.03125,
            "version": 1
          },
          "2e4ce40b-54d0-43a0-8118-5ba91c064c05": {
            "connections": {
              "Error": "e301438c-0bd0-429c-ab0c-66126501069a",
              "False": "e301438c-0bd0-429c-ab0c-66126501069a",
              "True": "2b779980-8038-4f29-ad31-a754b6baba01"
            },
            "displayName": "Twilio Verify Lookup",
            "nodeType": "VerifyAuthLookupNode",
            "x": 1015,
            "y": 1227.03125,
            "version": 1
          },
          "2fad8ff4-120b-4b5b-9264-ba41fc4203e0": {
            "connections": {
              "error": "e301438c-0bd0-429c-ab0c-66126501069a",
              "true": "5db175d6-78ad-4020-87e7-8afae5e1a729"
            },
            "displayName": "Twilio Verify Sender",
            "nodeType": "VerifyAuthSenderNode",
            "x": 1391,
            "y": 832.03125,
            "version": 1
          },
          "31e90931-3888-4de1-b426-0d6579c0d78f": {
            "connections": {
              "Error": "e301438c-0bd0-429c-ab0c-66126501069a",
              "FIDO2": "ba41ae63-5bbe-4b7b-a4e5-a90304d5537b",
              "OATH": "b9328338-0df6-46c4-8392-73fee238c2a2",
              "OATH+PUSH": "5283a80c-0d77-4b10-b156-502241657a0c",
              "PUSH": "8f52da1e-b28d-4ce5-a77a-d797f1237e72",
              "SMS": "88f6c518-7268-462b-b82d-47b1e09b851b",
              "VOICE": "9df13d2c-b18a-48eb-b2c4-fd8c334ca9f0"
            },
            "displayName": "Select Authn Device",
            "nodeType": "PageNode",
            "x": 233,
            "y": 442.421875,
            "version": 1
          },
          "44cc2d56-24aa-4671-8ef8-b99e52a065b3": {
            "connections": {
              "true": "5db175d6-78ad-4020-87e7-8afae5e1a729"
            },
            "displayName": "Set Invalid Code Error Message",
            "nodeType": "ScriptedDecisionNode",
            "x": 1711,
            "y": 1389.015625,
            "version": 1
          },
          "4c57f922-30fc-4814-bce0-7090de73cb9a": {
            "connections": {
              "outcome": "8b49bdc3-26e3-45e6-877d-297afcc55ac4"
            },
            "displayName": "Collect Phone Number",
            "nodeType": "PageNode",
            "x": 643,
            "y": 1457.015625,
            "version": 1
          },
          "5283a80c-0d77-4b10-b156-502241657a0c": {
            "connections": {
              "false": "e301438c-0bd0-429c-ab0c-66126501069a",
              "true": "7942c6ca-65c5-499c-b95c-645309cbbc1c"
            },
            "displayName": "Register OATH & PUSH",
            "nodeType": "InnerTreeEvaluatorNode",
            "x": 996,
            "y": 600.015625,
            "version": 1
          },
          "558e7b97-c2f7-4c85-8f51-1f20657f1659": {
            "connections": {
              "outcome": "974a86b4-f951-4b35-978b-255dc7e7c94a"
            },
            "displayName": "Collect Phone Number",
            "nodeType": "PageNode",
            "x": 645,
            "y": 1013.015625,
            "version": 1
          },
          "5820deb1-d71d-4754-97fc-cda5ee8b6416": {
            "connections": {
              "false": "e301438c-0bd0-429c-ab0c-66126501069a",
              "true": "31e90931-3888-4de1-b426-0d6579c0d78f"
            },
            "displayName": "Get User Id In Shared State",
            "nodeType": "IdentifyExistingUserNode",
            "x": 218.3125,
            "y": 812.03125,
            "version": 1
          },
          "5db175d6-78ad-4020-87e7-8afae5e1a729": {
            "connections": {
              "error": "e301438c-0bd0-429c-ab0c-66126501069a",
              "false": "8e735644-4c63-4a53-9343-d97a56fd9dd4",
              "true": "7942c6ca-65c5-499c-b95c-645309cbbc1c"
            },
            "displayName": "Collect OTP",
            "nodeType": "PageNode",
            "x": 1751,
            "y": 845.015625,
            "version": 1
          },
          "7942c6ca-65c5-499c-b95c-645309cbbc1c": {
            "connections": {
              "Error": "e301438c-0bd0-429c-ab0c-66126501069a",
              "true": "80725b3b-416a-4803-9b29-102f87312d20"
            },
            "displayName": "Update MFA Devices Object",
            "nodeType": "ScriptedDecisionNode",
            "x": 2072,
            "y": 622.421875,
            "version": 1
          },
          "80725b3b-416a-4803-9b29-102f87312d20": {
            "connections": {
              "error": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0",
              "noMail": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0",
              "sent": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "Notify User On Email",
            "nodeType": "ScriptedDecisionNode",
            "x": 2407,
            "y": 616.03125,
            "version": 1
          },
          "88f6c518-7268-462b-b82d-47b1e09b851b": {
            "connections": {
              "Error": "e301438c-0bd0-429c-ab0c-66126501069a",
              "False": "558e7b97-c2f7-4c85-8f51-1f20657f1659",
              "True": "b2a16d72-b492-4ab0-98c8-293063090ca0"
            },
            "displayName": "Twilio Identifier",
            "nodeType": "VerifyAuthIdentifierNode",
            "x": 648,
            "y": 798.03125,
            "version": 1
          },
          "8b49bdc3-26e3-45e6-877d-297afcc55ac4": {
            "connections": {
              "FAILURE": "e301438c-0bd0-429c-ab0c-66126501069a",
              "PATCHED": "9df13d2c-b18a-48eb-b2c4-fd8c334ca9f0"
            },
            "displayName": "Update User",
            "nodeType": "PatchObjectNode",
            "x": 1036.46875,
            "y": 1465.03125,
            "version": 1
          },
          "8e735644-4c63-4a53-9343-d97a56fd9dd4": {
            "connections": {
              "Reject": "e301438c-0bd0-429c-ab0c-66126501069a",
              "Retry": "44cc2d56-24aa-4671-8ef8-b99e52a065b3"
            },
            "displayName": "Retry Limit Decision",
            "nodeType": "RetryLimitDecisionNode",
            "x": 1748.5,
            "y": 1167.01953125,
            "version": 1
          },
          "8f52da1e-b28d-4ce5-a77a-d797f1237e72": {
            "connections": {
              "false": "e301438c-0bd0-429c-ab0c-66126501069a",
              "true": "7942c6ca-65c5-499c-b95c-645309cbbc1c"
            },
            "displayName": "Register Push MFA",
            "nodeType": "InnerTreeEvaluatorNode",
            "x": 1002,
            "y": 382.015625,
            "version": 1
          },
          "974a86b4-f951-4b35-978b-255dc7e7c94a": {
            "connections": {
              "FAILURE": "e301438c-0bd0-429c-ab0c-66126501069a",
              "PATCHED": "88f6c518-7268-462b-b82d-47b1e09b851b"
            },
            "displayName": "Update User",
            "nodeType": "PatchObjectNode",
            "x": 1015,
            "y": 1018.015625,
            "version": 1
          },
          "9df13d2c-b18a-48eb-b2c4-fd8c334ca9f0": {
            "connections": {
              "Error": "e301438c-0bd0-429c-ab0c-66126501069a",
              "False": "4c57f922-30fc-4814-bce0-7090de73cb9a",
              "True": "2e4ce40b-54d0-43a0-8118-5ba91c064c05"
            },
            "displayName": "Twilio Identifier",
            "nodeType": "VerifyAuthIdentifierNode",
            "x": 638,
            "y": 1230.03125,
            "version": 1
          },
          "b2a16d72-b492-4ab0-98c8-293063090ca0": {
            "connections": {
              "Error": "e301438c-0bd0-429c-ab0c-66126501069a",
              "False": "e301438c-0bd0-429c-ab0c-66126501069a",
              "True": "2fad8ff4-120b-4b5b-9264-ba41fc4203e0"
            },
            "displayName": "Twilio Verify Lookup",
            "nodeType": "VerifyAuthLookupNode",
            "x": 998,
            "y": 804.03125,
            "version": 1
          },
          "b9328338-0df6-46c4-8392-73fee238c2a2": {
            "connections": {
              "false": "e301438c-0bd0-429c-ab0c-66126501069a",
              "true": "7942c6ca-65c5-499c-b95c-645309cbbc1c"
            },
            "displayName": "Register OATH MFA",
            "nodeType": "InnerTreeEvaluatorNode",
            "x": 999,
            "y": 209.015625,
            "version": 1
          },
          "ba41ae63-5bbe-4b7b-a4e5-a90304d5537b": {
            "connections": {
              "false": "e301438c-0bd0-429c-ab0c-66126501069a",
              "true": "7942c6ca-65c5-499c-b95c-645309cbbc1c"
            },
            "displayName": "Register WebAuthn Method",
            "nodeType": "InnerTreeEvaluatorNode",
            "x": 970,
            "y": 63.03125,
            "version": 1
          }
        },
        "staticNodes": {
          "70e691a5-1e33-4ac3-a356-e7b6d60d92e0": {
            "x": 2883,
            "y": 663.3333333333333
          },
          "e301438c-0bd0-429c-ab0c-66126501069a": {
            "x": 1435,
            "y": 1030.6666666666667
          },
          "startNode": {
            "x": 70,
            "y": 347.5
          }
        }
      },
      "nodes": {
        "2b779980-8038-4f29-ad31-a754b6baba01": {
          "_id": "2b779980-8038-4f29-ad31-a754b6baba01",
          "_rev": "336510293",
          "accountSID": "",
          "authToken": null,
          "channel": "CALL",
          "identifierSharedState": "userIdentifier",
          "serviceSID": "",
          "requestIdentifier": false,
          "_type": {
            "_id": "VerifyAuthSenderNode",
            "name": "Twilio Verify Sender",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "error",
              "displayName": "Error"
            }
          ]
        },
        "2e4ce40b-54d0-43a0-8118-5ba91c064c05": {
          "_id": "2e4ce40b-54d0-43a0-8118-5ba91c064c05",
          "_rev": "-812994197",
          "accountSID": "",
          "authToken": null,
          "identifierSharedState": "userIdentifier",
          "_type": {
            "_id": "VerifyAuthLookupNode",
            "name": "Twilio Verify Lookup",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "True",
              "displayName": "True"
            },
            {
              "id": "False",
              "displayName": "False"
            },
            {
              "id": "Error",
              "displayName": "Error"
            }
          ]
        },
        "2fad8ff4-120b-4b5b-9264-ba41fc4203e0": {
          "_id": "2fad8ff4-120b-4b5b-9264-ba41fc4203e0",
          "_rev": "-627646956",
          "accountSID": "",
          "authToken": null,
          "channel": "SMS",
          "identifierSharedState": "userIdentifier",
          "serviceSID": "",
          "requestIdentifier": false,
          "_type": {
            "_id": "VerifyAuthSenderNode",
            "name": "Twilio Verify Sender",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "error",
              "displayName": "Error"
            }
          ]
        },
        "31e90931-3888-4de1-b426-0d6579c0d78f": {
          "_id": "31e90931-3888-4de1-b426-0d6579c0d78f",
          "_rev": "-1522727201",
          "nodes": [
            {
              "_id": "59e7b1b9-8289-40c7-b621-da8f881c7372",
              "nodeType": "ScriptedDecisionNode",
              "nodeVersion": 1,
              "displayName": "Get Allowed MFA methods"
            }
          ],
          "pageDescription": {
            "en": "Select an MFA method to use to sign on to your account."
          },
          "pageHeader": {
            "en": "Select Method"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "FIDO2",
              "displayName": "FIDO2"
            },
            {
              "id": "OATH",
              "displayName": "OATH"
            },
            {
              "id": "PUSH",
              "displayName": "PUSH"
            },
            {
              "id": "OATH+PUSH",
              "displayName": "OATH+PUSH"
            },
            {
              "id": "SMS",
              "displayName": "SMS"
            },
            {
              "id": "VOICE",
              "displayName": "VOICE"
            },
            {
              "id": "Error",
              "displayName": "Error"
            }
          ]
        },
        "44cc2d56-24aa-4671-8ef8-b99e52a065b3": {
          "_id": "44cc2d56-24aa-4671-8ef8-b99e52a065b3",
          "_rev": "-652288900",
          "script": "d7533919-235c-4548-99db-dd9cb33344ae",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "invalidCodeErrorMessage",
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "null"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "4c57f922-30fc-4814-bce0-7090de73cb9a": {
          "_id": "4c57f922-30fc-4814-bce0-7090de73cb9a",
          "_rev": "1807825825",
          "nodes": [
            {
              "_id": "49cd87a5-30ae-4684-80c2-09be4be055f9",
              "nodeType": "AttributeCollectorNode",
              "nodeVersion": 1,
              "displayName": "Collect Phone Number"
            }
          ],
          "pageDescription": {
            "en": "Enter your mobile phone number, including the country code, to receive authentication passcodes."
          },
          "pageHeader": {
            "en": "Voice"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "5283a80c-0d77-4b10-b156-502241657a0c": {
          "_id": "5283a80c-0d77-4b10-b156-502241657a0c",
          "_rev": "1720973060",
          "displayErrorOutcome": false,
          "tree": "Combined OATH And PUSH MFA Methods Registration - Inner Journey",
          "_type": {
            "_id": "InnerTreeEvaluatorNode",
            "name": "Inner Tree Evaluator",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "558e7b97-c2f7-4c85-8f51-1f20657f1659": {
          "_id": "558e7b97-c2f7-4c85-8f51-1f20657f1659",
          "_rev": "-1786787406",
          "nodes": [
            {
              "_id": "10dc5c95-a53e-4199-a9e3-c856cc1d6eb6",
              "nodeType": "AttributeCollectorNode",
              "nodeVersion": 1,
              "displayName": "Collect Phone Number"
            }
          ],
          "pageDescription": {
            "en": "Enter your mobile phone number, including the country code, to receive authentication passcodes."
          },
          "pageHeader": {
            "en": "Text Message"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "5820deb1-d71d-4754-97fc-cda5ee8b6416": {
          "_id": "5820deb1-d71d-4754-97fc-cda5ee8b6416",
          "_rev": "1447138683",
          "identityAttribute": "userName",
          "identifier": "userName",
          "_type": {
            "_id": "IdentifyExistingUserNode",
            "name": "Identify Existing User",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "5db175d6-78ad-4020-87e7-8afae5e1a729": {
          "_id": "5db175d6-78ad-4020-87e7-8afae5e1a729",
          "_rev": "-1108372181",
          "nodes": [
            {
              "_id": "ca8d317c-8c99-477c-8846-2951000518bf",
              "nodeType": "ScriptedDecisionNode",
              "nodeVersion": 1,
              "displayName": "Validate OTP"
            },
            {
              "_id": "52111389-b865-4220-8168-09f279cfa6c1",
              "nodeType": "VerifyAuthCollectorDecisionNode",
              "nodeVersion": 1,
              "displayName": "Twilio Verify Collector Decision"
            }
          ],
          "pageDescription": {
            "en": "Enter the passcode you received."
          },
          "pageHeader": {
            "en": "Enter Passcode"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            },
            {
              "id": "error",
              "displayName": "Error"
            }
          ]
        },
        "7942c6ca-65c5-499c-b95c-645309cbbc1c": {
          "_id": "7942c6ca-65c5-499c-b95c-645309cbbc1c",
          "_rev": "753593000",
          "script": "7c93cb90-c43b-448b-893d-68de7019ccac",
          "outcomes": [
            "true",
            "Error"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "_id",
            "ciam_allowedMFATypes",
            "mfaDeviceType"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            },
            {
              "id": "Error",
              "displayName": "Error"
            }
          ]
        },
        "80725b3b-416a-4803-9b29-102f87312d20": {
          "_id": "80725b3b-416a-4803-9b29-102f87312d20",
          "_rev": "281440115",
          "script": "5229cb9a-5efc-4632-ae47-5bafad71601a",
          "outcomes": [
            "sent",
            "noMail",
            "error"
          ],
          "outputs": [
            "*"
          ],
          "inputs": [
            "_id",
            "mfaDeviceType"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "sent",
              "displayName": "sent"
            },
            {
              "id": "noMail",
              "displayName": "noMail"
            },
            {
              "id": "error",
              "displayName": "error"
            }
          ]
        },
        "88f6c518-7268-462b-b82d-47b1e09b851b": {
          "_id": "88f6c518-7268-462b-b82d-47b1e09b851b",
          "_rev": "-1210552164",
          "identifierAttribute": "telephoneNumber",
          "identifierSharedState": "userIdentifier",
          "_type": {
            "_id": "VerifyAuthIdentifierNode",
            "name": "Twilio Identifier",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "True",
              "displayName": "True"
            },
            {
              "id": "False",
              "displayName": "False"
            },
            {
              "id": "Error",
              "displayName": "Error"
            }
          ]
        },
        "8b49bdc3-26e3-45e6-877d-297afcc55ac4": {
          "_id": "8b49bdc3-26e3-45e6-877d-297afcc55ac4",
          "_rev": "-222898763",
          "identityResource": "managed/alpha_user",
          "patchAsObject": false,
          "ignoredFields": [],
          "identityAttribute": "userName",
          "_type": {
            "_id": "PatchObjectNode",
            "name": "Patch Object",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "PATCHED",
              "displayName": "Patched"
            },
            {
              "id": "FAILURE",
              "displayName": "Failed"
            }
          ]
        },
        "8e735644-4c63-4a53-9343-d97a56fd9dd4": {
          "_id": "8e735644-4c63-4a53-9343-d97a56fd9dd4",
          "_rev": "636717889",
          "incrementUserAttributeOnFailure": true,
          "retryLimit": 3,
          "_type": {
            "_id": "RetryLimitDecisionNode",
            "name": "Retry Limit Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Retry",
              "displayName": "Retry"
            },
            {
              "id": "Reject",
              "displayName": "Reject"
            }
          ]
        },
        "8f52da1e-b28d-4ce5-a77a-d797f1237e72": {
          "_id": "8f52da1e-b28d-4ce5-a77a-d797f1237e72",
          "_rev": "-85161021",
          "displayErrorOutcome": false,
          "tree": "Push MFA Method Registration - Inner Journey",
          "_type": {
            "_id": "InnerTreeEvaluatorNode",
            "name": "Inner Tree Evaluator",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "974a86b4-f951-4b35-978b-255dc7e7c94a": {
          "_id": "974a86b4-f951-4b35-978b-255dc7e7c94a",
          "_rev": "160244194",
          "identityResource": "managed/alpha_user",
          "patchAsObject": false,
          "ignoredFields": [],
          "identityAttribute": "userName",
          "_type": {
            "_id": "PatchObjectNode",
            "name": "Patch Object",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "PATCHED",
              "displayName": "Patched"
            },
            {
              "id": "FAILURE",
              "displayName": "Failed"
            }
          ]
        },
        "9df13d2c-b18a-48eb-b2c4-fd8c334ca9f0": {
          "_id": "9df13d2c-b18a-48eb-b2c4-fd8c334ca9f0",
          "_rev": "1329844908",
          "identifierAttribute": "telephoneNumber",
          "identifierSharedState": "userIdentifier",
          "_type": {
            "_id": "VerifyAuthIdentifierNode",
            "name": "Twilio Identifier",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "True",
              "displayName": "True"
            },
            {
              "id": "False",
              "displayName": "False"
            },
            {
              "id": "Error",
              "displayName": "Error"
            }
          ]
        },
        "b2a16d72-b492-4ab0-98c8-293063090ca0": {
          "_id": "b2a16d72-b492-4ab0-98c8-293063090ca0",
          "_rev": "-1794460791",
          "accountSID": "",
          "authToken": null,
          "identifierSharedState": "userIdentifier",
          "_type": {
            "_id": "VerifyAuthLookupNode",
            "name": "Twilio Verify Lookup",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "True",
              "displayName": "True"
            },
            {
              "id": "False",
              "displayName": "False"
            },
            {
              "id": "Error",
              "displayName": "Error"
            }
          ]
        },
        "b9328338-0df6-46c4-8392-73fee238c2a2": {
          "_id": "b9328338-0df6-46c4-8392-73fee238c2a2",
          "_rev": "-2139632755",
          "displayErrorOutcome": false,
          "tree": "OATH Registration - Inner Journey",
          "_type": {
            "_id": "InnerTreeEvaluatorNode",
            "name": "Inner Tree Evaluator",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "ba41ae63-5bbe-4b7b-a4e5-a90304d5537b": {
          "_id": "ba41ae63-5bbe-4b7b-a4e5-a90304d5537b",
          "_rev": "-823979982",
          "displayErrorOutcome": false,
          "tree": "WebAuthn MFA Method Registration - Inner Journey",
          "_type": {
            "_id": "InnerTreeEvaluatorNode",
            "name": "Inner Tree Evaluator",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        }
      },
      "innerNodes": {
        "59e7b1b9-8289-40c7-b621-da8f881c7372": {
          "_id": "59e7b1b9-8289-40c7-b621-da8f881c7372",
          "_rev": "1637282508",
          "script": "2a43b67f-1dad-42ae-95b2-5ef022f59f64",
          "outcomes": [
            "FIDO2",
            "OATH",
            "PUSH",
            "OATH+PUSH",
            "SMS",
            "VOICE",
            "Error"
          ],
          "outputs": [
            "mfaDeviceType",
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "ciam_allowedMFATypes"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "FIDO2",
              "displayName": "FIDO2"
            },
            {
              "id": "OATH",
              "displayName": "OATH"
            },
            {
              "id": "PUSH",
              "displayName": "PUSH"
            },
            {
              "id": "OATH+PUSH",
              "displayName": "OATH+PUSH"
            },
            {
              "id": "SMS",
              "displayName": "SMS"
            },
            {
              "id": "VOICE",
              "displayName": "VOICE"
            },
            {
              "id": "Error",
              "displayName": "Error"
            }
          ]
        },
        "49cd87a5-30ae-4684-80c2-09be4be055f9": {
          "_id": "49cd87a5-30ae-4684-80c2-09be4be055f9",
          "_rev": "-1026059687",
          "attributesToCollect": [
            "telephoneNumber"
          ],
          "identityAttribute": "userName",
          "validateInputs": true,
          "required": true,
          "_type": {
            "_id": "AttributeCollectorNode",
            "name": "Attribute Collector",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "10dc5c95-a53e-4199-a9e3-c856cc1d6eb6": {
          "_id": "10dc5c95-a53e-4199-a9e3-c856cc1d6eb6",
          "_rev": "-660412453",
          "attributesToCollect": [
            "telephoneNumber"
          ],
          "identityAttribute": "userName",
          "validateInputs": true,
          "required": true,
          "_type": {
            "_id": "AttributeCollectorNode",
            "name": "Attribute Collector",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "ca8d317c-8c99-477c-8846-2951000518bf": {
          "_id": "ca8d317c-8c99-477c-8846-2951000518bf",
          "_rev": "198062309",
          "script": "ee3e8507-00ff-48e8-a861-ea3a87a0c278",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails",
            "invalidCodeErrorMessage"
          ],
          "inputs": [
            "invalidCodeErrorMessage"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "52111389-b865-4220-8168-09f279cfa6c1": {
          "_id": "52111389-b865-4220-8168-09f279cfa6c1",
          "_rev": "-847385239",
          "hideCode": true,
          "resendButtonText": "resend",
          "showCancelButton": false,
          "cancelButtonText": "cancel",
          "identifierSharedState": "userIdentifier",
          "nextButtonText": "next",
          "showResendButton": false,
          "_type": {
            "_id": "VerifyAuthCollectorDecisionNode",
            "name": "Twilio Verify Collector Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            },
            {
              "id": "error",
              "displayName": "Error"
            }
          ]
        }
      },
      "scripts": {
        "d7533919-235c-4548-99db-dd9cb33344ae": {
          "_id": "d7533919-235c-4548-99db-dd9cb33344ae",
          "name": "Threat Detection - Set Invalid code error message",
          "description": "Script to set invalid code error message",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: null\\n    - Script Outputs: \\\"invalidCodeErrorMessage\\\", \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\n// Set the below error message in shared state, can be displayed on the last UI Node\\n\\ntry {\\n    nodeState.putShared(\\\"invalidCodeErrorMessage\\\", \\\"Invalid Code\\\");\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error\\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925703,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083351,
          "evaluatorVersion": "2.0"
        },
        "7c93cb90-c43b-448b-893d-68de7019ccac": {
          "_id": "7c93cb90-c43b-448b-893d-68de7019ccac",
          "name": "Threat Detection - Set MFA device in user's profile",
          "description": "Script to register MFA device/method in user's profile, script should be executed after verification of a respective MFA device/method",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: \\\"_id\\\", \\\"ciam_allowedMFATypes\\\", \\\"mfaDeviceType\\\"\\n    - Script Outputs: \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"true\\\", \\\"Error\\\"\\n*/\\n\\n// Caution: This script might auto-enroll the \\\"EMAIL\\\" as a MFA method in user's profile\\n\\ntry {\\n    // Retrieve userId and allowedMFATypes from shared state\\n    var userId = nodeState.get(\\\"_id\\\");\\n    var allowedMFAMethods = nodeState.get(\\\"ciam_allowedMFATypes\\\");\\n    \\n    // Read the user's MFA devices from the directory\\n    var mfaDevicesObj = openidm.read(\\\"managed/alpha_user/\\\" + userId, null, [\\\"custom_mfaDevices\\\"]);\\n    var mfaDevices = (mfaDevicesObj && mfaDevicesObj.custom_mfaDevices) ? mfaDevicesObj.custom_mfaDevices : [];\\n    \\n    // Parse the MFA devices into a usable array\\n    var usableMFADevices = [];\\n    mfaDevices.forEach(device => {\\n        usableMFADevices.push(device);\\n    });\\n    \\n    var emailMFAAllowed = false;\\n    \\n    // Check if EMAIL MFA is allowed\\n    allowedMFAMethods.forEach(method => {\\n        if (method === \\\"EMAIL\\\") emailMFAAllowed = true;\\n    });\\n    \\n    // Caution: By default, add EMAIL to the MFA devices list if it's allowed and not already present\\n    if (emailMFAAllowed && !usableMFADevices.includes(\\\"EMAIL\\\")) {\\n        usableMFADevices.push(\\\"EMAIL\\\");\\n    }\\n    \\n    // Get the selected device type from shared state\\n    var selectedDevice = nodeState.get(\\\"mfaDeviceType\\\");\\n    \\n    // Handle device registration based on the selected device type\\n    // If Admin wants a single FIDO2 device that a user can register and authenticate with, \\n    // change the node configuration in the WebAuthn Inner Journey and the below condition\\n    if (!usableMFADevices.includes(selectedDevice) || selectedDevice === \\\"FIDO2\\\") {\\n        // Handle combined MFA registration for OATH+PUSH if both are unregistered\\n        if (selectedDevice === \\\"OATH+PUSH\\\") {\\n            if(!usableMFADevices.includes(\\\"OATH\\\") && !usableMFADevices.includes(\\\"PUSH\\\")) {\\n                usableMFADevices.push(\\\"OATH\\\");\\n                usableMFADevices.push(\\\"PUSH\\\");\\n            } else {\\n                // OATH or PUSH device already registered for user, this option can't be use to register device again\\n                // If either of OATH or PUSH is registered and user want to register the other method from OATH/PUSH, \\n                // Use separate OATH and PUSH paths for registration\\n                nodeState.putShared(\\\"errorMessage\\\", \\\"An unexpected error occurred, please contact support team.\\\");\\n            }\\n        } else {\\n            usableMFADevices.push(selectedDevice);\\n        }\\n    }\\n    \\n    // Update the user's custom_mfaDevices attribute\\n    openidm.patch(\\\"managed/alpha_user/\\\" + userId, null, [{\\\"operation\\\":\\\"replace\\\", \\\"field\\\":\\\"/custom_mfaDevices\\\", \\\"value\\\":usableMFADevices}]);\\n\\n    // Update the custom_latestMFADevice variable to store the selected device, it will be used in the notification template\\n    var latestMFADevice = selectedDevice;\\n    if(selectedDevice === \\\"OATH+PUSH\\\") latestMFADevice = \\\"OATH & Push\\\";\\n    openidm.patch(\\\"managed/alpha_user/\\\" + userId, null, [{\\\"operation\\\":\\\"replace\\\", \\\"field\\\":\\\"/custom_latestMFADevice\\\", \\\"value\\\":latestMFADevice}]);\\n    // Set the outcome to true\\n    action.goTo(\\\"true\\\");   \\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error  \\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925704,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083397,
          "evaluatorVersion": "2.0"
        },
        "5229cb9a-5efc-4632-ae47-5bafad71601a": {
          "_id": "5229cb9a-5efc-4632-ae47-5bafad71601a",
          "name": "Threat Detection - Send device registration email",
          "description": "Script to send next-gen templated email when new MFA device is registered.",
          "script": "\"/**\\n * @file This script sends a templated email to a user via the IDM's configured email service\\n * using the openidm binding in next-gen scripting\\n * NOTE - The use of SendGrid is not supported in Production and must be changed to your own email service\\n * Steps are here: https://backstage.forgerock.com/docs/idcloud/latest/tenants/email-provider.html#external_smtp_email_server\\n * @version 0.2.0\\n * @keywords email mail sharedState transientState templateService\\n */\\n\\n/**\\n * Script configuration\\n*/\\n\\n// Initialise the logger called ds-node-logger-lib library script\\nXLogger = require(\\\"ds-node-logger-lib\\\").XLogger;\\nlogger = new XLogger(this);\\n\\nvar config = {\\n    /**\\n     * @property {string} templateID - Identifier of email template\\n     * @property {string} idmEndpoint - IDM Endpoint used to send templated emails\\n     * @property {string} idmAction - IDM action executed against the idmEndpoint\\n     */\\n\\n    templateID: \\\"deviceRegistration\\\",\\n    idmEndpoint: \\\"external/email\\\",\\n    idmAction: \\\"sendTemplate\\\"\\n};\\n\\n/**\\n * Node outcomes\\n*/\\nvar nodeOutcome = {\\n    PASS: \\\"sent\\\",\\n    FAIL: \\\"noMail\\\",\\n    ERROR: \\\"error\\\"\\n};\\n\\n/**\\n * Send email via the IDM Email Service openidm binding in next-gen scripting\\n * \\n * @param {string} mail - mail attribute retrieved from the idRepository. Note if this is a registration journey acquire mail from sharedState\\n */\\n\\nfunction sendMail(mail, mfaDeviceType) {\\n    try {\\n        var params = new Object();\\n        params.templateName = config.templateID;\\n        params.to = mail;\\n        params.object = {\\n            \\\"custom_latestMFADevice\\\": mfaDeviceType\\n        };\\n        openidm.action(config.idmEndpoint, config.idmAction, params);\\n        logger.error(\\\"Email send successfully\\\");\\n        return nodeOutcome.PASS;\\n    }\\n    catch (e) {\\n        logger.error(\\\"Failed to call IDM Email endpoint using template. Exception is: \\\" + e);\\n        return nodeOutcome.ERROR;\\n    }\\n};\\n\\n/**\\n * Main function\\n */\\n\\n(function () {\\n    logger.error(\\\"Node execution started\\\");\\n    var id;\\n    var mail;\\n    var mfaDeviceType;\\n\\n    if (!(id = nodeState.get(\\\"_id\\\"))) {\\n        logger.error(\\\"Unable to retrieve Identity\\\");\\n        action.goTo(nodeOutcome.ERROR);\\n        return;\\n    } else {\\n        var identity = idRepository.getIdentity(id);\\n    }\\n\\n    //If this is a registration journey adapt the following to try retrieve from nodeState\\n    if (!(mail = identity.getAttributeValues(\\\"mail\\\").toArray()[0])) {\\n        logger.error(\\\"Unable to retrieve mail attribute from the idRepository\\\");\\n        action.goTo(nodeOutcome.FAIL);\\n        return;\\n    }\\n\\n    if (!(mfaDeviceType = nodeState.get(\\\"mfaDeviceType\\\"))) {\\n        logger.error(\\\"Unable to retrieve mfaDeviceType from state\\\");\\n        action.goTo(nodeOutcome.ERROR);\\n        return;\\n    }\\n\\n    //Execute function to send mail\\n    outcome = sendMail(mail, mfaDeviceType);\\n})();\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925703,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083412,
          "evaluatorVersion": "2.0"
        },
        "2a43b67f-1dad-42ae-95b2-5ef022f59f64": {
          "_id": "2a43b67f-1dad-42ae-95b2-5ef022f59f64",
          "name": "Threat Detection - Get available MFA methods",
          "description": "Script to fetch available MFA methods that a user can register with",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: \\\"ciam_allowedMFATypes\\\"\\n    - Script Outputs: \\\"mfaDeviceType\\\", \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"true\\\", \\\"Error\\\"\\n*/\\n\\ntry {\\n    // Get allowed MFA types from shared state\\n    var allowedMFAMethods = nodeState.get(\\\"ciam_allowedMFATypes\\\");\\n\\n    // Create an array storing usableMFAMethods\\n    var usableMFAMethods = [];\\n    \\n    allowedMFAMethods.forEach(device => {\\n        usableMFAMethods.push(device);\\n    });\\n    \\n    // Email verification is done in parent journey, can be used directly during MFA authentication\\n    // Scrubbing \\\"EMAIL\\\" device type, if available in usableMFAMethods\\n    if (usableMFAMethods.includes(\\\"EMAIL\\\")) {\\n        var index = usableMFAMethods.indexOf(\\\"EMAIL\\\");\\n        if (index > -1) usableMFAMethods.splice(index, 1);\\n    }\\n    \\n    // Combined registration for OATH & Push, if both OATH & Push are allowed MFA types\\n    if(usableMFAMethods.includes(\\\"OATH\\\") && usableMFAMethods.includes(\\\"PUSH\\\")) usableMFAMethods.push(\\\"OATH+PUSH\\\");\\n    \\n    // Handle callback logic\\n    if (callbacks.isEmpty()) {\\n      callbacksBuilder.choiceCallback(\\\"Select an MFA device\\\", usableMFAMethods, 0, false);\\n    } else {\\n      // Callbacks returned from browser, save selected choice\\n      var index = callbacks.getChoiceCallbacks().get(0)[0];\\n      var selectedDevice = usableMFAMethods[index] || null;\\n    \\n      if (!selectedDevice) {\\n        nodeState.putShared(\\\"errorMessage\\\", \\\"An unexpected error occurred, please contact support team\\\");\\n        // Go to Error\\n        action.goTo(\\\"Error\\\");\\n      } else {  \\n        nodeState.putShared(\\\"mfaDeviceType\\\", selectedDevice);\\n        // Go to selected device path\\n        action.goTo(selectedDevice);\\n      }\\n    }\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error\\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925863,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083447,
          "evaluatorVersion": "2.0"
        },
        "ee3e8507-00ff-48e8-a861-ea3a87a0c278": {
          "_id": "ee3e8507-00ff-48e8-a861-ea3a87a0c278",
          "name": "Threat Detection - Validate OTP input",
          "description": "Script to validate OTP input, sets constraints, and enables/disables the submit button based on validity",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: \\\"oneTimePassword\\\", \\\"invalidCodeErrorMessage\\\"\\n    - Script Outputs: \\\"errorMessage\\\", \\\"errorDetails\\\", \\\"invalidCodeErrorMessage\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\n// Note: If HOTP Genrator node is used in prior, \\\"oneTimePassword\\\" will be a transient state property, make sure to make it available in script inputs. \\n// If the OTP is generated by Twilio nodes, the default length is set to 6 and only digits are considered. Modify this if necessary.\\n\\ntry {\\n    function validateInput(otpLength) {\\n        return String(\\\" \\\\n\\\\\\n                    var otpLength = \\\" + otpLength + \\\" \\\\n\\\\\\n                    const submitBtn = document.querySelectorAll('button[type=\\\\\\\"submit\\\\\\\"]')[0]; \\\\n\\\\\\n                    if (submitBtn) submitBtn.disabled = true; \\\\n\\\\\\n                    // Validate the passcode \\\\n\\\\\\n                    function validateCode() { \\\\n\\\\\\n                        const passcode = document.querySelectorAll('input[data-vv-as=\\\\\\\"One Time Password\\\\\\\"]')[0] || document.querySelectorAll('input[data-vv-as=\\\\\\\"Code\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (passcode) { \\\\n\\\\\\n                            // Set input properties to prevent user tampering \\\\n\\\\\\n                            passcode.setAttribute('maxlength', otpLength); \\\\n\\\\\\n                            passcode.setAttribute('pattern', '[0-9]{' + otpLength + '}'); \\\\n\\\\\\n                            passcode.setAttribute('inputmode', 'numeric'); \\\\n\\\\\\n                            // Check if the input is exactly 6 digits long and numeric \\\\n\\\\\\n                            const isValidCode = new RegExp('^[0-9]{' + otpLength + '}$').test(passcode.value); \\\\n\\\\\\n                            submitBtn.disabled = !isValidCode; \\\\n\\\\\\n                            return isValidCode; \\\\n\\\\\\n                        } \\\\n\\\\\\n                        return false; \\\\n\\\\\\n                    }; \\\\n\\\\\\n                    \\\\n\\\\\\n                    function go(obs) { \\\\n\\\\\\n                        const passcode = document.querySelectorAll('input[data-vv-as=\\\\\\\"One Time Password\\\\\\\"]')[0] || document.querySelectorAll('input[data-vv-as=\\\\\\\"Code\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (passcode && submitBtn) { \\\\n\\\\\\n                            passcode.addEventListener('input', validateCode); \\\\n\\\\\\n                            submitBtn.addEventListener('click', (event) => { \\\\n\\\\\\n                                if (!validateCode()) { \\\\n\\\\\\n                                    event.preventDefault(); \\\\n\\\\\\n                                    submitBtn.disabled = true; \\\\n\\\\\\n                                } \\\\n\\\\\\n                            }); \\\\n\\\\\\n                            if (obs) obs.disconnect(); \\\\n\\\\\\n                            return; \\\\n\\\\\\n                        } \\\\n\\\\\\n                    } \\\\n\\\\\\n                    \\\\n\\\\\\n                    // For HOTP and Twilio OTP collector nodes, if either of the element is present, initialize validation \\\\n\\\\\\n                    if (document.querySelectorAll('input[data-vv-as=\\\\\\\"One Time Password\\\\\\\"]')[0] || document.querySelectorAll('input[data-vv-as=\\\\\\\"Code\\\\\\\"]')[0]) go(); \\\\n\\\\\\n                    else { \\\\n\\\\\\n                        const observer = new MutationObserver((mutations, obs) => { go(obs); }); \\\\n\\\\\\n                        observer.observe(document, { childList: true, subtree: true }); \\\\n\\\\\\n                    } \\\\n\\\\\\n        \\\");\\n    }\\n\\n    var invalidCodeErrorMessage = nodeState.get(\\\"invalidCodeErrorMessage\\\");\\n    nodeState.putShared(\\\"invalidCodeErrorMessage\\\", \\\"\\\");\\n\\n    // Get \\\"oneTimePassword\\\" shared in transient state by the HOTP Generator node or default it to 6\\n    var otpLength = nodeState.get(\\\"oneTimePassword\\\") ? nodeState.get(\\\"oneTimePassword\\\").length : 6;\\n    \\n    if (callbacks.isEmpty()) {\\n        // Display error message if invalid code entered by user\\n        if (invalidCodeErrorMessage && invalidCodeErrorMessage.length) callbacksBuilder.textOutputCallback(2, invalidCodeErrorMessage);\\n        // Request callbacks\\n        callbacksBuilder.scriptTextOutputCallback(validateInput(otpLength));\\n    }\\n    // Go to true path\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error  \\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925704,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083450,
          "evaluatorVersion": "2.0"
        }
      },
      "emailTemplates": {},
      "socialIdentityProviders": {},
      "themes": [],
      "saml2Entities": {},
      "circlesOfTrust": {}
    },
    "Threat Detection Journey with PingOne Protect": {
      "tree": {
        "_id": "Threat Detection Journey with PingOne Protect",
        "_rev": "-1588720494",
        "identityResource": "managed/alpha_user",
        "entryNodeId": "de286919-6e98-4a9e-859f-6e86ed11d212",
        "innerTreeOnly": false,
        "noSession": false,
        "mustRun": false,
        "enabled": true,
        "transactionalOnly": false,
        "uiConfig": {
          "categories": "[\"Threat Detection\"]"
        },
        "nodes": {
          "01285823-fca4-49b4-850e-5519ede1d21d": {
            "connections": {
              "true": "f75ce75e-959f-4684-9cd3-5eccf9cbe75d"
            },
            "displayName": "Set p1ProtectAction As Init",
            "nodeType": "ScriptedDecisionNode",
            "x": 180,
            "y": 1020.03125,
            "version": 1
          },
          "0a4a0329-376a-41db-b05a-6d88a5c75f4e": {
            "connections": {
              "false": "1d330623-d624-4a92-a286-484e5e91277a",
              "true": "57aa078c-d8ff-4bed-9b88-286c0d7d0c2f"
            },
            "displayName": "Protect Evaluation & Mitigation",
            "nodeType": "InnerTreeEvaluatorNode",
            "x": 165,
            "y": 52.015625,
            "version": 1
          },
          "0b04a2c7-21af-47df-baae-880000a94423": {
            "connections": {
              "localAuthentication": "0cb0ca30-6b20-4e8c-a5d2-2817fca0932c",
              "socialAuthentication": "82268cd3-3139-4136-be72-2d2c676990e3"
            },
            "displayName": "Page Node",
            "nodeType": "PageNode",
            "x": 198,
            "y": 504.015625,
            "version": 1
          },
          "0cb0ca30-6b20-4e8c-a5d2-2817fca0932c": {
            "connections": {
              "false": "57aa078c-d8ff-4bed-9b88-286c0d7d0c2f",
              "true": "eda29daf-f00f-4058-a69b-3b337536fb91"
            },
            "displayName": "Is Protect Analysis Required?",
            "nodeType": "ScriptedDecisionNode",
            "x": 178,
            "y": 342.03125,
            "version": 1
          },
          "1d330623-d624-4a92-a286-484e5e91277a": {
            "connections": {
              "outcome": "e301438c-0bd0-429c-ab0c-66126501069a"
            },
            "displayName": "Update P1 Protect Eval Failure",
            "nodeType": "product-PingOneProtectResultNode",
            "x": 1543,
            "y": 651.03125,
            "version": 1
          },
          "212b2a85-54ca-418e-aabe-0322b34ee052": {
            "connections": {
              "false": "65368b39-2dae-43ac-999a-0b373780b4e2",
              "true": "d4d85de2-09ec-42bd-9a27-6d119f0c8c88"
            },
            "displayName": "Is Email Verified?",
            "nodeType": "AttributeValueDecisionNode",
            "x": 536.203125,
            "y": 114.015625,
            "version": 1
          },
          "2293a2b1-1fe6-4013-a10f-f99c69f8437c": {
            "connections": {
              "true": "01285823-fca4-49b4-850e-5519ede1d21d"
            },
            "displayName": "Set flowType As Authentication",
            "nodeType": "ScriptedDecisionNode",
            "x": 176,
            "y": 1145.03125,
            "version": 1
          },
          "2ee63a92-f470-4910-a25b-f164e5da7bd3": {
            "connections": {
              "true": "e301438c-0bd0-429c-ab0c-66126501069a"
            },
            "displayName": "Delete User Entry",
            "nodeType": "ScriptedDecisionNode",
            "x": 1627,
            "y": 1426.03125,
            "version": 1
          },
          "3b420c82-80ec-43b9-b2d2-9ec77fa42d32": {
            "connections": {
              "false": "2ee63a92-f470-4910-a25b-f164e5da7bd3",
              "true": "c5e0b647-f936-4554-8584-fd63729d4311"
            },
            "displayName": "MFA Registration",
            "nodeType": "InnerTreeEvaluatorNode",
            "x": 1628,
            "y": 1271.421875,
            "version": 1
          },
          "3bea3f78-23b7-4249-9dcc-b0583f54392e": {
            "connections": {
              "false": "89ce033d-ea45-434f-bdb2-ce1f924e04da",
              "true": "593ce86d-5796-4f50-bba4-75e5f8219ee1"
            },
            "displayName": "Terms and Conditions Decision",
            "nodeType": "TermsAndConditionsDecisionNode",
            "x": 1154,
            "y": 7.015625,
            "version": 1
          },
          "4bef992a-b9c5-4f86-a4c9-c02030680a2b": {
            "connections": {
              "false": "a2aa29d0-5466-47b6-aede-412bcc5c6dd2",
              "true": "829b4f7e-1ab3-443a-9a3d-815496865502"
            },
            "displayName": "Required Attributes Present",
            "nodeType": "RequiredAttributesDecisionNode",
            "x": 601,
            "y": 1080.421875,
            "version": 1
          },
          "57aa078c-d8ff-4bed-9b88-286c0d7d0c2f": {
            "connections": {
              "CANCELLED": "e301438c-0bd0-429c-ab0c-66126501069a",
              "EXPIRED": "e301438c-0bd0-429c-ab0c-66126501069a",
              "FALSE": "e301438c-0bd0-429c-ab0c-66126501069a",
              "LOCKED": "e301438c-0bd0-429c-ab0c-66126501069a",
              "TRUE": "d2a3c77b-1bff-4221-99f1-be18dcc19090"
            },
            "displayName": "Identity Store Decision",
            "nodeType": "IdentityStoreDecisionNode",
            "x": 566.15625,
            "y": 594.015625,
            "version": 1
          },
          "593ce86d-5796-4f50-bba4-75e5f8219ee1": {
            "connections": {
              "outcome": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "Update P1 Protect Eval Success",
            "nodeType": "product-PingOneProtectResultNode",
            "x": 1485,
            "y": 100.03125,
            "version": 1
          },
          "65368b39-2dae-43ac-999a-0b373780b4e2": {
            "connections": {
              "outcome": "f30290ec-a1d6-4376-96ad-af0800cca7fd"
            },
            "displayName": "Email Suspend Node",
            "nodeType": "EmailSuspendNode",
            "x": 528,
            "y": 6.03125,
            "version": 1
          },
          "6709d20f-d15b-481a-aebb-2b1cfab90957": {
            "connections": {
              "false": "e301438c-0bd0-429c-ab0c-66126501069a",
              "true": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "Account Active Decision",
            "nodeType": "AccountActiveDecisionNode",
            "x": 910,
            "y": 801.03125,
            "version": 1
          },
          "76d720ff-73e9-482c-adf9-4724f7b71b60": {
            "connections": {
              "CREATED": "ae7268ad-116d-4a2c-9110-22a299f20837",
              "FAILURE": "e301438c-0bd0-429c-ab0c-66126501069a"
            },
            "displayName": "Create Object",
            "nodeType": "CreateObjectNode",
            "x": 943,
            "y": 1086.921875,
            "version": 1
          },
          "7be35b6e-4fe7-4741-8a86-e7e7f83dbc47": {
            "connections": {
              "false": "e301438c-0bd0-429c-ab0c-66126501069a",
              "true": "c6b1586e-a98f-40f3-9022-171bf224c798"
            },
            "displayName": "Identify Existing User",
            "nodeType": "IdentifyExistingUserNode",
            "x": 1284.3125,
            "y": 1268.03125,
            "version": 1
          },
          "82268cd3-3139-4136-be72-2d2c676990e3": {
            "connections": {
              "ACCOUNT_EXISTS": "6709d20f-d15b-481a-aebb-2b1cfab90957",
              "NO_ACCOUNT": "4bef992a-b9c5-4f86-a4c9-c02030680a2b",
              "SOCIAL_AUTH_INTERRUPTED": "e301438c-0bd0-429c-ab0c-66126501069a"
            },
            "displayName": "Social Provider Handler Node",
            "nodeType": "SocialProviderHandlerNodeV2",
            "x": 594.15625,
            "y": 827.015625,
            "version": 1
          },
          "829b4f7e-1ab3-443a-9a3d-815496865502": {
            "connections": {
              "outcome": "76d720ff-73e9-482c-adf9-4724f7b71b60"
            },
            "displayName": "Create Profile Social Reg",
            "nodeType": "PageNode",
            "x": 921,
            "y": 1239.921875,
            "version": 1
          },
          "8923efcd-80a8-42ae-871a-46403a5fa194": {
            "connections": {
              "FAILURE": "1d330623-d624-4a92-a286-484e5e91277a",
              "PATCHED": "593ce86d-5796-4f50-bba4-75e5f8219ee1"
            },
            "displayName": "Patch Object",
            "nodeType": "PatchObjectNode",
            "x": 1194,
            "y": 268.015625,
            "version": 1
          },
          "89913383-ce1a-479a-b1e0-284665ab4ddd": {
            "connections": {
              "error": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0",
              "noMail": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0",
              "sent": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "displayName": "Notify User On Email",
            "nodeType": "ScriptedDecisionNode",
            "x": 1624,
            "y": 990.03125,
            "version": 1
          },
          "89ce033d-ea45-434f-bdb2-ce1f924e04da": {
            "connections": {
              "outcome": "8923efcd-80a8-42ae-871a-46403a5fa194"
            },
            "displayName": "Accept Terms and Conditions",
            "nodeType": "AcceptTermsAndConditionsNode",
            "x": 1171,
            "y": 150.015625,
            "version": 1
          },
          "a2aa29d0-5466-47b6-aede-412bcc5c6dd2": {
            "connections": {
              "true": "829b4f7e-1ab3-443a-9a3d-815496865502"
            },
            "displayName": "Create Profile Social Reg",
            "nodeType": "PageNode",
            "x": 639,
            "y": 1243.421875,
            "version": 1
          },
          "ae7268ad-116d-4a2c-9110-22a299f20837": {
            "connections": {
              "outcome": "7be35b6e-4fe7-4741-8a86-e7e7f83dbc47"
            },
            "displayName": "Disable User's Account",
            "nodeType": "AccountLockoutNode",
            "x": 1276,
            "y": 1424.03125,
            "version": 1
          },
          "c5e0b647-f936-4554-8584-fd63729d4311": {
            "connections": {
              "outcome": "89913383-ce1a-479a-b1e0-284665ab4ddd"
            },
            "displayName": "Enable User's Account",
            "nodeType": "AccountLockoutNode",
            "x": 1623,
            "y": 1166.03125,
            "version": 1
          },
          "c6b1586e-a98f-40f3-9022-171bf224c798": {
            "connections": {
              "true": "3b420c82-80ec-43b9-b2d2-9ec77fa42d32"
            },
            "displayName": "Set Email Ver. Status To True",
            "nodeType": "ScriptedDecisionNode",
            "x": 1263,
            "y": 1162.421875,
            "version": 1
          },
          "cd664fcc-06ec-4b3f-aeba-d69a98e3f346": {
            "connections": {
              "false": "0b04a2c7-21af-47df-baae-880000a94423",
              "true": "2293a2b1-1fe6-4013-a10f-f99c69f8437c"
            },
            "displayName": "Is Protect Analysis Required?",
            "nodeType": "ScriptedDecisionNode",
            "x": 183,
            "y": 1265.03125,
            "version": 1
          },
          "d2a3c77b-1bff-4221-99f1-be18dcc19090": {
            "connections": {
              "false": "e301438c-0bd0-429c-ab0c-66126501069a",
              "true": "212b2a85-54ca-418e-aabe-0322b34ee052"
            },
            "displayName": "Account Active Decision",
            "nodeType": "AccountActiveDecisionNode",
            "x": 559,
            "y": 420.015625,
            "version": 1
          },
          "d39972ca-0d61-45b1-b303-f8c20694d6cf": {
            "connections": {
              "true": "cd664fcc-06ec-4b3f-aeba-d69a98e3f346"
            },
            "displayName": "Prerequisites & Init Variables",
            "nodeType": "ScriptedDecisionNode",
            "x": 187.42857142857144,
            "y": 1426.8080357142858,
            "version": 1
          },
          "d4d85de2-09ec-42bd-9a27-6d119f0c8c88": {
            "connections": {
              "false": "3bea3f78-23b7-4249-9dcc-b0583f54392e",
              "true": "f3bdeddc-f2bc-4b0e-a0ca-0166e149c3e1"
            },
            "displayName": "Auth Level Decision",
            "nodeType": "AuthLevelDecisionNode",
            "x": 801,
            "y": 133.015625,
            "version": 1
          },
          "de286919-6e98-4a9e-859f-6e86ed11d212": {
            "connections": {
              "DONE": "d39972ca-0d61-45b1-b303-f8c20694d6cf"
            },
            "displayName": "Polling Wait Node",
            "nodeType": "PollingWaitNode",
            "x": 192,
            "y": 1548.03125,
            "version": 1
          },
          "eda29daf-f00f-4058-a69b-3b337536fb91": {
            "connections": {
              "true": "0a4a0329-376a-41db-b05a-6d88a5c75f4e"
            },
            "displayName": "Set p1ProtectAction As Eval",
            "nodeType": "ScriptedDecisionNode",
            "x": 173,
            "y": 229.015625,
            "version": 1
          },
          "f30290ec-a1d6-4376-96ad-af0800cca7fd": {
            "connections": {
              "true": "d4d85de2-09ec-42bd-9a27-6d119f0c8c88"
            },
            "displayName": "Set Email Ver. Status To True",
            "nodeType": "ScriptedDecisionNode",
            "x": 807,
            "y": 15.03125,
            "version": 1
          },
          "f3bdeddc-f2bc-4b0e-a0ca-0166e149c3e1": {
            "connections": {
              "false": "1d330623-d624-4a92-a286-484e5e91277a",
              "true": "3bea3f78-23b7-4249-9dcc-b0583f54392e"
            },
            "displayName": "MFA Authentication",
            "nodeType": "InnerTreeEvaluatorNode",
            "x": 988,
            "y": 269.015625,
            "version": 1
          },
          "f75ce75e-959f-4684-9cd3-5eccf9cbe75d": {
            "connections": {
              "false": "e301438c-0bd0-429c-ab0c-66126501069a",
              "true": "0b04a2c7-21af-47df-baae-880000a94423"
            },
            "displayName": "Initialize P1 Protect",
            "nodeType": "InnerTreeEvaluatorNode",
            "x": 206,
            "y": 860.03125,
            "version": 1
          }
        },
        "staticNodes": {
          "70e691a5-1e33-4ac3-a356-e7b6d60d92e0": {
            "x": 2143,
            "y": 98
          },
          "e301438c-0bd0-429c-ab0c-66126501069a": {
            "x": 2040,
            "y": 829
          },
          "startNode": {
            "x": 32,
            "y": 210
          }
        }
      },
      "nodes": {
        "01285823-fca4-49b4-850e-5519ede1d21d": {
          "_id": "01285823-fca4-49b4-850e-5519ede1d21d",
          "_rev": "338199738",
          "script": "47616408-11a3-485c-8d34-b7eac1383a58",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "p1ProtectAction",
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "null"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "0a4a0329-376a-41db-b05a-6d88a5c75f4e": {
          "_id": "0a4a0329-376a-41db-b05a-6d88a5c75f4e",
          "_rev": "-1776002491",
          "displayErrorOutcome": false,
          "tree": "Threat Detection - Inner Journey",
          "_type": {
            "_id": "InnerTreeEvaluatorNode",
            "name": "Inner Tree Evaluator",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "0b04a2c7-21af-47df-baae-880000a94423": {
          "_id": "0b04a2c7-21af-47df-baae-880000a94423",
          "_rev": "-271547941",
          "nodes": [
            {
              "_id": "f7fb5574-005e-4c5d-9678-f9724eab9e7e",
              "nodeType": "ValidatedUsernameNode",
              "nodeVersion": 1,
              "displayName": "Platform Username"
            },
            {
              "_id": "85584d3e-23ff-4d5e-baac-28790d0576bb",
              "nodeType": "ValidatedPasswordNode",
              "nodeVersion": 1,
              "displayName": "Platform Password"
            },
            {
              "_id": "9521836a-245f-4105-9e23-4a8c389f0252",
              "nodeType": "ScriptedDecisionNode",
              "nodeVersion": 1,
              "displayName": "Validate Inputs"
            },
            {
              "_id": "37d99565-2bb2-4f66-a683-de4ba965a73c",
              "nodeType": "SelectIdPNode",
              "nodeVersion": 1,
              "displayName": "Select Identity Provider"
            }
          ],
          "pageDescription": {},
          "stage": "{\"submitButtonText\":{\"en\":\"Sign In\"}}",
          "pageHeader": {
            "en": "Sign In"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "socialAuthentication",
              "displayName": "Social Authentication"
            },
            {
              "id": "localAuthentication",
              "displayName": "Local Authentication"
            }
          ]
        },
        "0cb0ca30-6b20-4e8c-a5d2-2817fca0932c": {
          "_id": "0cb0ca30-6b20-4e8c-a5d2-2817fca0932c",
          "_rev": "384266721",
          "script": "391bc676-db7a-4a3e-ad27-c07c76c62f77",
          "outcomes": [
            "true",
            "false"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "ciam_protectAnalysisRequired"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            },
            {
              "id": "false",
              "displayName": "false"
            }
          ]
        },
        "1d330623-d624-4a92-a286-484e5e91277a": {
          "_id": "1d330623-d624-4a92-a286-484e5e91277a",
          "_rev": "-939934270",
          "status": "FAILED",
          "_type": {
            "_id": "product-PingOneProtectResultNode",
            "name": "PingOne Protect Result",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "212b2a85-54ca-418e-aabe-0322b34ee052": {
          "_id": "212b2a85-54ca-418e-aabe-0322b34ee052",
          "_rev": "1586421412",
          "comparisonValue": "true",
          "comparisonOperation": "EQUALS",
          "identityAttribute": "userName",
          "comparisonAttribute": "custom_emailVerified",
          "_type": {
            "_id": "AttributeValueDecisionNode",
            "name": "Attribute Value Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "2293a2b1-1fe6-4013-a10f-f99c69f8437c": {
          "_id": "2293a2b1-1fe6-4013-a10f-f99c69f8437c",
          "_rev": "846306342",
          "script": "3453f878-5d62-41d1-b816-cfc272217853",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "flowType",
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "null"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "2ee63a92-f470-4910-a25b-f164e5da7bd3": {
          "_id": "2ee63a92-f470-4910-a25b-f164e5da7bd3",
          "_rev": "1572685064",
          "script": "50c68c9c-1fda-4f66-b71e-30bc3f3b13a0",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "_id"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "3b420c82-80ec-43b9-b2d2-9ec77fa42d32": {
          "_id": "3b420c82-80ec-43b9-b2d2-9ec77fa42d32",
          "_rev": "-65464794",
          "displayErrorOutcome": false,
          "tree": "MFA Device Registration - Inner Journey",
          "_type": {
            "_id": "InnerTreeEvaluatorNode",
            "name": "Inner Tree Evaluator",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "3bea3f78-23b7-4249-9dcc-b0583f54392e": {
          "_id": "3bea3f78-23b7-4249-9dcc-b0583f54392e",
          "_rev": "-1504765163",
          "identityAttribute": "userName",
          "_type": {
            "_id": "TermsAndConditionsDecisionNode",
            "name": "Terms and Conditions Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "4bef992a-b9c5-4f86-a4c9-c02030680a2b": {
          "_id": "4bef992a-b9c5-4f86-a4c9-c02030680a2b",
          "_rev": "-1799093517",
          "identityResource": "managed/alpha_user",
          "_type": {
            "_id": "RequiredAttributesDecisionNode",
            "name": "Required Attributes Present",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "57aa078c-d8ff-4bed-9b88-286c0d7d0c2f": {
          "_id": "57aa078c-d8ff-4bed-9b88-286c0d7d0c2f",
          "_rev": "-127446675",
          "useUniversalIdForUsername": false,
          "minimumPasswordLength": 8,
          "mixedCaseForPasswordChangeMessages": false,
          "_type": {
            "_id": "IdentityStoreDecisionNode",
            "name": "Identity Store Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "TRUE",
              "displayName": "True"
            },
            {
              "id": "FALSE",
              "displayName": "False"
            },
            {
              "id": "LOCKED",
              "displayName": "Locked"
            },
            {
              "id": "CANCELLED",
              "displayName": "Cancelled"
            },
            {
              "id": "EXPIRED",
              "displayName": "Expired"
            }
          ]
        },
        "593ce86d-5796-4f50-bba4-75e5f8219ee1": {
          "_id": "593ce86d-5796-4f50-bba4-75e5f8219ee1",
          "_rev": "459636046",
          "status": "SUCCESS",
          "_type": {
            "_id": "product-PingOneProtectResultNode",
            "name": "PingOne Protect Result",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "65368b39-2dae-43ac-999a-0b373780b4e2": {
          "_id": "65368b39-2dae-43ac-999a-0b373780b4e2",
          "_rev": "-222236206",
          "emailSuspendMessage": {
            "en": "An email has been sent to the address you entered. Click the link in that email to proceed."
          },
          "emailTemplateName": "magicLinkTemplate",
          "identityAttribute": "userName",
          "emailAttribute": "mail",
          "objectLookup": true,
          "_type": {
            "_id": "EmailSuspendNode",
            "name": "Email Suspend Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "6709d20f-d15b-481a-aebb-2b1cfab90957": {
          "_id": "6709d20f-d15b-481a-aebb-2b1cfab90957",
          "_rev": "-2044284213",
          "_type": {
            "_id": "AccountActiveDecisionNode",
            "name": "Account Active Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "76d720ff-73e9-482c-adf9-4724f7b71b60": {
          "_id": "76d720ff-73e9-482c-adf9-4724f7b71b60",
          "_rev": "-1455670318",
          "identityResource": "managed/alpha_user",
          "_type": {
            "_id": "CreateObjectNode",
            "name": "Create Object",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "CREATED",
              "displayName": "Created"
            },
            {
              "id": "FAILURE",
              "displayName": "Failed"
            }
          ]
        },
        "7be35b6e-4fe7-4741-8a86-e7e7f83dbc47": {
          "_id": "7be35b6e-4fe7-4741-8a86-e7e7f83dbc47",
          "_rev": "1753738780",
          "identityAttribute": "userName",
          "identifier": "userName",
          "_type": {
            "_id": "IdentifyExistingUserNode",
            "name": "Identify Existing User",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "82268cd3-3139-4136-be72-2d2c676990e3": {
          "_id": "82268cd3-3139-4136-be72-2d2c676990e3",
          "_rev": "-1908969549",
          "clientType": "BROWSER",
          "script": "58c824ae-84ed-4724-82cd-db128fc3f6c",
          "usernameAttribute": "userName",
          "storeTokens": false,
          "_type": {
            "_id": "SocialProviderHandlerNodeV2",
            "name": "Social Provider Handler Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "ACCOUNT_EXISTS",
              "displayName": "Account exists"
            },
            {
              "id": "NO_ACCOUNT",
              "displayName": "No account exists"
            },
            {
              "id": "SOCIAL_AUTH_INTERRUPTED",
              "displayName": "Social auth interrupted"
            }
          ]
        },
        "829b4f7e-1ab3-443a-9a3d-815496865502": {
          "_id": "829b4f7e-1ab3-443a-9a3d-815496865502",
          "_rev": "-207949856",
          "nodes": [
            {
              "_id": "ba67da1e-9e74-4cb5-aac3-7269daa6fa2a",
              "nodeType": "ValidatedPasswordNode",
              "nodeVersion": 1,
              "displayName": "Platform Password"
            },
            {
              "_id": "981aafd5-5ff3-4223-b91d-32f980a4a2e7",
              "nodeType": "ScriptedDecisionNode",
              "nodeVersion": 1,
              "displayName": "Validate Inputs"
            },
            {
              "_id": "e6d8de25-cc29-4acc-bb32-5904e90beae9",
              "nodeType": "AcceptTermsAndConditionsNode",
              "nodeVersion": 1,
              "displayName": "Accept Terms and Conditions"
            }
          ],
          "pageDescription": {},
          "pageHeader": {
            "en": "Create Your Profile"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "8923efcd-80a8-42ae-871a-46403a5fa194": {
          "_id": "8923efcd-80a8-42ae-871a-46403a5fa194",
          "_rev": "-938838601",
          "identityResource": "managed/alpha_user",
          "patchAsObject": false,
          "ignoredFields": [],
          "identityAttribute": "userName",
          "_type": {
            "_id": "PatchObjectNode",
            "name": "Patch Object",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "PATCHED",
              "displayName": "Patched"
            },
            {
              "id": "FAILURE",
              "displayName": "Failed"
            }
          ]
        },
        "89913383-ce1a-479a-b1e0-284665ab4ddd": {
          "_id": "89913383-ce1a-479a-b1e0-284665ab4ddd",
          "_rev": "-1213151195",
          "script": "3dc1226a-65fb-4b36-81b8-1c8d13d1326c",
          "outcomes": [
            "sent",
            "noMail",
            "error"
          ],
          "outputs": [
            "*"
          ],
          "inputs": [
            "_id",
            "username"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "sent",
              "displayName": "sent"
            },
            {
              "id": "noMail",
              "displayName": "noMail"
            },
            {
              "id": "error",
              "displayName": "error"
            }
          ]
        },
        "89ce033d-ea45-434f-bdb2-ce1f924e04da": {
          "_id": "89ce033d-ea45-434f-bdb2-ce1f924e04da",
          "_rev": "685059823",
          "_type": {
            "_id": "AcceptTermsAndConditionsNode",
            "name": "Accept Terms and Conditions",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "a2aa29d0-5466-47b6-aede-412bcc5c6dd2": {
          "_id": "a2aa29d0-5466-47b6-aede-412bcc5c6dd2",
          "_rev": "-1306719287",
          "nodes": [
            {
              "_id": "2a8823b7-b8bd-4205-baaf-5be12e1caeef",
              "nodeType": "AttributeCollectorNode",
              "nodeVersion": 1,
              "displayName": "Attribute Collector"
            },
            {
              "_id": "69fde49b-ada7-4e9a-aad0-4d37bf2d4849",
              "nodeType": "ScriptedDecisionNode",
              "nodeVersion": 1,
              "displayName": "Validating Inputs"
            }
          ],
          "pageDescription": {},
          "pageHeader": {
            "en": "Create Your Profile"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "ae7268ad-116d-4a2c-9110-22a299f20837": {
          "_id": "ae7268ad-116d-4a2c-9110-22a299f20837",
          "_rev": "78336500",
          "lockAction": "LOCK",
          "_type": {
            "_id": "AccountLockoutNode",
            "name": "Account Lockout",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "c5e0b647-f936-4554-8584-fd63729d4311": {
          "_id": "c5e0b647-f936-4554-8584-fd63729d4311",
          "_rev": "-1515973582",
          "lockAction": "UNLOCK",
          "_type": {
            "_id": "AccountLockoutNode",
            "name": "Account Lockout",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "c6b1586e-a98f-40f3-9022-171bf224c798": {
          "_id": "c6b1586e-a98f-40f3-9022-171bf224c798",
          "_rev": "864702225",
          "script": "d5242e7f-60b1-4314-93e9-89b80f7c5bf6",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "_id",
            "ciam_allowedMFATypes"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "cd664fcc-06ec-4b3f-aeba-d69a98e3f346": {
          "_id": "cd664fcc-06ec-4b3f-aeba-d69a98e3f346",
          "_rev": "-1237323995",
          "script": "391bc676-db7a-4a3e-ad27-c07c76c62f77",
          "outcomes": [
            "true",
            "false"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "ciam_protectAnalysisRequired"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            },
            {
              "id": "false",
              "displayName": "false"
            }
          ]
        },
        "d2a3c77b-1bff-4221-99f1-be18dcc19090": {
          "_id": "d2a3c77b-1bff-4221-99f1-be18dcc19090",
          "_rev": "1344220593",
          "_type": {
            "_id": "AccountActiveDecisionNode",
            "name": "Account Active Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "d39972ca-0d61-45b1-b303-f8c20694d6cf": {
          "_id": "d39972ca-0d61-45b1-b303-f8c20694d6cf",
          "_rev": "530948024",
          "script": "3290857f-9150-4b56-afeb-8437fca17711",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "ciam_allowedMFATypes",
            "ciam_protectAnalysisRequired",
            "ciam_magicLinkEnabled"
          ],
          "inputs": [
            "null"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "d4d85de2-09ec-42bd-9a27-6d119f0c8c88": {
          "_id": "d4d85de2-09ec-42bd-9a27-6d119f0c8c88",
          "_rev": "1461995629",
          "authLevelRequirement": 1,
          "_type": {
            "_id": "AuthLevelDecisionNode",
            "name": "Auth Level Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "de286919-6e98-4a9e-859f-6e86ed11d212": {
          "_id": "de286919-6e98-4a9e-859f-6e86ed11d212",
          "_rev": "816926714",
          "spamDetectionTolerance": 3,
          "spamDetectionEnabled": false,
          "exitMessage": {},
          "waitingMessage": {
            "en": "Loading..."
          },
          "secondsToWait": 2,
          "exitable": false,
          "_type": {
            "_id": "PollingWaitNode",
            "name": "Polling Wait Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "DONE",
              "displayName": "Done"
            }
          ]
        },
        "eda29daf-f00f-4058-a69b-3b337536fb91": {
          "_id": "eda29daf-f00f-4058-a69b-3b337536fb91",
          "_rev": "-654048084",
          "script": "81980021-14fc-4e6c-a397-80452b16963f",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "p1ProtectAction",
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "null"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "f30290ec-a1d6-4376-96ad-af0800cca7fd": {
          "_id": "f30290ec-a1d6-4376-96ad-af0800cca7fd",
          "_rev": "166811594",
          "script": "d5242e7f-60b1-4314-93e9-89b80f7c5bf6",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "_id",
            "ciam_allowedMFATypes"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "f3bdeddc-f2bc-4b0e-a0ca-0166e149c3e1": {
          "_id": "f3bdeddc-f2bc-4b0e-a0ca-0166e149c3e1",
          "_rev": "-2143752692",
          "displayErrorOutcome": false,
          "tree": "MFA Authentication - Inner Journey",
          "_type": {
            "_id": "InnerTreeEvaluatorNode",
            "name": "Inner Tree Evaluator",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "f75ce75e-959f-4684-9cd3-5eccf9cbe75d": {
          "_id": "f75ce75e-959f-4684-9cd3-5eccf9cbe75d",
          "_rev": "-1506100873",
          "displayErrorOutcome": false,
          "tree": "Threat Detection - Inner Journey",
          "_type": {
            "_id": "InnerTreeEvaluatorNode",
            "name": "Inner Tree Evaluator",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        }
      },
      "innerNodes": {
        "f7fb5574-005e-4c5d-9678-f9724eab9e7e": {
          "_id": "f7fb5574-005e-4c5d-9678-f9724eab9e7e",
          "_rev": "1851706911",
          "usernameAttribute": "userName",
          "validateInput": false,
          "_type": {
            "_id": "ValidatedUsernameNode",
            "name": "Platform Username",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "85584d3e-23ff-4d5e-baac-28790d0576bb": {
          "_id": "85584d3e-23ff-4d5e-baac-28790d0576bb",
          "_rev": "-1674536969",
          "passwordAttribute": "password",
          "validateInput": false,
          "_type": {
            "_id": "ValidatedPasswordNode",
            "name": "Platform Password",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "9521836a-245f-4105-9e23-4a8c389f0252": {
          "_id": "9521836a-245f-4105-9e23-4a8c389f0252",
          "_rev": "-265993727",
          "script": "b8332c2e-adec-4ff3-8e5e-95cea0baa73e",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "null"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "37d99565-2bb2-4f66-a683-de4ba965a73c": {
          "_id": "37d99565-2bb2-4f66-a683-de4ba965a73c",
          "_rev": "2016889420",
          "includeLocalAuthentication": true,
          "filteredProviders": [
            "Google",
            "Facebook",
            "Apple"
          ],
          "identityAttribute": "mail",
          "passwordAttribute": "password",
          "offerOnlyExisting": false,
          "_type": {
            "_id": "SelectIdPNode",
            "name": "Select Identity Provider",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "socialAuthentication",
              "displayName": "Social Authentication"
            },
            {
              "id": "localAuthentication",
              "displayName": "Local Authentication"
            }
          ]
        },
        "ba67da1e-9e74-4cb5-aac3-7269daa6fa2a": {
          "_id": "ba67da1e-9e74-4cb5-aac3-7269daa6fa2a",
          "_rev": "2089639243",
          "passwordAttribute": "password",
          "validateInput": false,
          "_type": {
            "_id": "ValidatedPasswordNode",
            "name": "Platform Password",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "981aafd5-5ff3-4223-b91d-32f980a4a2e7": {
          "_id": "981aafd5-5ff3-4223-b91d-32f980a4a2e7",
          "_rev": "1667367193",
          "script": "bd5c931d-3f2b-4a39-9ee8-8b5efabd4ea2",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "null"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        },
        "e6d8de25-cc29-4acc-bb32-5904e90beae9": {
          "_id": "e6d8de25-cc29-4acc-bb32-5904e90beae9",
          "_rev": "-1522516510",
          "_type": {
            "_id": "AcceptTermsAndConditionsNode",
            "name": "Accept Terms and Conditions",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "2a8823b7-b8bd-4205-baaf-5be12e1caeef": {
          "_id": "2a8823b7-b8bd-4205-baaf-5be12e1caeef",
          "_rev": "-216330355",
          "attributesToCollect": [
            "userName",
            "givenName",
            "sn"
          ],
          "identityAttribute": "userName",
          "validateInputs": true,
          "required": true,
          "_type": {
            "_id": "AttributeCollectorNode",
            "name": "Attribute Collector",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "69fde49b-ada7-4e9a-aad0-4d37bf2d4849": {
          "_id": "69fde49b-ada7-4e9a-aad0-4d37bf2d4849",
          "_rev": "1829736987",
          "script": "678ed3e6-ea15-4016-9a67-fe2d3e76dae1",
          "outcomes": [
            "true"
          ],
          "outputs": [
            "errorMessage",
            "errorDetails"
          ],
          "inputs": [
            "null"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "true"
            }
          ]
        }
      },
      "scripts": {
        "47616408-11a3-485c-8d34-b7eac1383a58": {
          "_id": "47616408-11a3-485c-8d34-b7eac1383a58",
          "name": "Threat Detection - Set Protect Action Init",
          "description": "Script to set Protect action as Eval, will be used in Threat Detection Journey to initialize Protect SDK",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: null\\n    - Script Outputs: \\\"p1ProtectAction\\\", \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\ntry {\\n    // Action to be taken in threat detection child journey\\n    nodeState.putShared(\\\"p1ProtectAction\\\", \\\"init\\\");\\n    // Go to true path\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error \\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925795,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083469,
          "evaluatorVersion": "2.0"
        },
        "391bc676-db7a-4a3e-ad27-c07c76c62f77": {
          "_id": "391bc676-db7a-4a3e-ad27-c07c76c62f77",
          "name": "Threat Detection - Protect Analysis Required",
          "description": "Script to check if P1 Protect analysis is required or not",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: \\\"ciam_protectAnalysisRequired\\\"\\n    - Script Outputs: \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"true\\\", \\\"false\\\"\\n*/\\n\\n// Prerequisites: Set the environment variable: p1-protect-analysis-required\\n\\ntry {\\n    // Get Protect analysis required or not from the Environment variable\\n    var protectAnalysisRequired = (systemEnv.getProperty(\\\"esv.p1.protect.analysis.required\\\") && systemEnv.getProperty(\\\"esv.p1.protect.analysis.required\\\").length) ? systemEnv.getProperty(\\\"esv.p1.protect.analysis.required\\\") : nodeState.get(\\\"ciam_protectAnalysisRequired\\\");\\n    \\n    if(protectAnalysisRequired === \\\"true\\\" || protectAnalysisRequired === true) outcome = \\\"true\\\";\\n    else outcome = \\\"false\\\";\\n    // Go to outcome\\n    action.goTo(outcome);\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error \\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925800,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083479,
          "evaluatorVersion": "2.0"
        },
        "3453f878-5d62-41d1-b816-cfc272217853": {
          "_id": "3453f878-5d62-41d1-b816-cfc272217853",
          "name": "Threat Detection - Set Flow Type As Authentication",
          "description": "Script to set flowType as Authentication",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: \\\"ciam_protectAnalysisRequired\\\", esv.p1.protect.analysis.required\\n    - Script Outputs: \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"true\\\", \\\"false\\\"\\n*/\\n\\ntry {\\n    // Setting the flowType as Authentication, this will be used to differentiate paths in Threat Detection Journey\\n    nodeState.putShared(\\\"flowType\\\", \\\"Authentication\\\");\\n    // Go to true\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error  \\n    action.goTo(\\\"Error\\\");\\n}\\n\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925785,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083448,
          "evaluatorVersion": "2.0"
        },
        "50c68c9c-1fda-4f66-b71e-30bc3f3b13a0": {
          "_id": "50c68c9c-1fda-4f66-b71e-30bc3f3b13a0",
          "name": "Threat Detection - Delete User Entry Script",
          "description": "Script to delete a user's entry from directory service if they fail during registration process",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: \\\"_id\\\"\\n    - Script Outputs: \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\ntry {\\n    var userId = nodeState.get(\\\"_id\\\");\\n    // Delete the user entry from the data store\\n    openidm.delete('managed/alpha_user/'+ userId, null);\\n    // Go to true path\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error\\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925828,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083490,
          "evaluatorVersion": "2.0"
        },
        "3dc1226a-65fb-4b36-81b8-1c8d13d1326c": {
          "_id": "3dc1226a-65fb-4b36-81b8-1c8d13d1326c",
          "name": "Threat Detection - Send welcome email",
          "description": "Script to send next-gen templated welcome email",
          "script": "\"/**\\n * @file This script sends a templated email to a user via the IDM's configured email service\\n * using the openidm binding in next-gen scripting\\n * NOTE - The use of SendGrid is not supported in Production and must be changed to your own email service\\n * Steps are here: https://backstage.forgerock.com/docs/idcloud/latest/tenants/email-provider.html#external_smtp_email_server\\n * @version 0.2.0\\n * @keywords email mail sharedState transientState templateService\\n */\\n\\n/**\\n * Script configuration\\n*/\\n\\n// Initialise the logger called ds-node-logger-lib library script\\nXLogger = require(\\\"ds-node-logger-lib\\\").XLogger;\\nlogger = new XLogger(this);\\n\\nvar config = {\\n    /**\\n     * @property {string} templateID - Identifier of email template\\n     * @property {string} idmEndpoint - IDM Endpoint used to send templated emails\\n     * @property {string} idmAction - IDM action executed against the idmEndpoint\\n     */\\n\\n    templateID: \\\"welcome\\\",\\n    idmEndpoint: \\\"external/email\\\",\\n    idmAction: \\\"sendTemplate\\\"\\n};\\n\\n/**\\n * Node outcomes\\n*/\\nvar nodeOutcome = {\\n    PASS: \\\"sent\\\",\\n    FAIL: \\\"noMail\\\",\\n    ERROR: \\\"error\\\"\\n};\\n\\n/**\\n * Send email via the IDM Email Service openidm binding in next-gen scripting\\n * \\n * @param {string} mail - mail attribute retrieved from the idRepository. Note if this is a registration journey acquire mail from sharedState\\n * @param {string} userName - userName attribute retrieved from the sharedState.\\n */\\n\\nfunction sendMail(mail, username) {\\n    try {\\n        var params = new Object();\\n        params.templateName = config.templateID;\\n        params.to = mail;\\n        params.object = {\\n            \\\"userName\\\": username\\n        };\\n        openidm.action(config.idmEndpoint, config.idmAction, params);\\n        logger.error(\\\"Email send successfully\\\");\\n        return nodeOutcome.PASS;\\n    }\\n    catch (e) {\\n        logger.error(\\\"Failed to call IDM Email endpoint using template. Exception is: \\\" + e);\\n        return nodeOutcome.ERROR;\\n    }\\n};\\n\\n/**\\n * Main function\\n */\\n\\n(function () {\\n    logger.error(\\\"Node execution started\\\");\\n    var id;\\n    var mail;\\n    var username;\\n\\n    if (!(id = nodeState.get(\\\"_id\\\"))) {\\n        logger.error(\\\"Unable to retrieve Identity\\\");\\n        action.goTo(nodeOutcome.ERROR);\\n        return;\\n    } else {\\n        var identity = idRepository.getIdentity(id);\\n    }\\n\\n    //If this is a registration journey adapt the following to try retrieve from nodeState\\n    if (!(mail = identity.getAttributeValues(\\\"mail\\\").toArray()[0])) {\\n        logger.error(\\\"Unable to retrieve mail attribute from the idRepository\\\");\\n        action.goTo(nodeOutcome.FAIL);\\n        return;\\n    }\\n\\n    if (!(username = nodeState.get(\\\"username\\\"))) {\\n        logger.error(\\\"Unable to retrieve username\\\");\\n        action.goTo(nodeOutcome.ERROR);\\n        return;\\n    }\\n    \\n    //Execute function to send mail\\n    outcome = sendMail(mail, username);\\n})();\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925806,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083479,
          "evaluatorVersion": "2.0"
        },
        "d5242e7f-60b1-4314-93e9-89b80f7c5bf6": {
          "_id": "d5242e7f-60b1-4314-93e9-89b80f7c5bf6",
          "name": "Threat Detection - Set email verification status",
          "description": "Script to set email verification status in user's profile",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: \\\"_id\\\", \\\"ciam_allowedMFATypes\\\"\\n    - Script Outputs: \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\n// Caution: This script might auto-enroll the \\\"EMAIL\\\" as a MFA method in user's profile\\n\\n\\ntry {\\n    // Get the userId\\n    var userId = nodeState.get(\\\"_id\\\");\\n    \\n    // Update the email verification status attribute of user to \\\"true\\\"\\n    openidm.patch(\\\"managed/alpha_user/\\\" + userId, null, [{\\\"operation\\\":\\\"replace\\\", \\\"field\\\":\\\"/custom_emailVerified\\\", \\\"value\\\":\\\"true\\\"}]);\\n\\n    // Enroll email as an MFA authentication method\\n    var allowedMFAMethods = nodeState.get(\\\"ciam_allowedMFATypes\\\");\\n    var mfaDevicesObj = openidm.read(\\\"managed/alpha_user/\\\" + userId, null, [\\\"custom_mfaDevices\\\"]);\\n    var mfaDevices = (mfaDevicesObj && mfaDevicesObj.custom_mfaDevices) ? mfaDevicesObj.custom_mfaDevices : [];\\n\\n    // By default returned mfaDevices is of Object type so values are parsed in a new array\\n    var usableMFADevices = [];\\n   \\n    mfaDevices.forEach(device => {\\n        usableMFADevices.push(device);\\n    });\\n\\n    var emailMFAAllowed = false;\\n    allowedMFAMethods.forEach(device => {\\n        if(device === \\\"EMAIL\\\") emailMFAAllowed = true;\\n    });\\n    \\n    // Add email to the MFA Devices list, if not already present \\n    if(emailMFAAllowed && !usableMFADevices.includes(\\\"EMAIL\\\")) usableMFADevices.push(\\\"EMAIL\\\");\\n    \\n    // Update the custom_mfaDevices Object\\n    openidm.patch(\\\"managed/alpha_user/\\\" + userId, null, [{\\\"operation\\\":\\\"replace\\\", \\\"field\\\":\\\"/custom_mfaDevices\\\", \\\"value\\\":usableMFADevices}]);\\n    // Go to true path\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error\\n    action.goTo(\\\"Error\\\");\\n}\\n\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925866,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083448,
          "evaluatorVersion": "2.0"
        },
        "3290857f-9150-4b56-afeb-8437fca17711": {
          "_id": "3290857f-9150-4b56-afeb-8437fca17711",
          "name": "Threat Detection - Initialize Variables",
          "description": "Script to Initialize variables that will be used further in the Journey",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/* Prerequisites for this Journey Pack\\n       -Create following custom attributes before proceeding:\\n           1. custom_emailVerified - string (To keep track that user has verified their emailAddress)\\n           2. custom_protectActivityCity - string (User's P1 Protect Activity City, used in notification template)\\n           3. custom_protectActivityState - string (User's P1 Protect Activity City, used in notification template)\\n           4. custom_protectDeviceOS - string (User's P1 Protect Activity City, used in notification template)\\n           5. custom_mfaDevices - array of string (To set, fetch and display user's registered MFA devices)\\n           6. custom_latestMFADevice - string (Recent MFA device registered by user, used in notification template)\\n       -Configuration Check\\n           1. Set the environment variable p1-protect-analysis-required. If it is not set, the value specified in the code below for \\\"protectAnalysisRequired\\\" var will be used.\\n           2. Threat Detection Inner Journey (If Protect Analysis Is Required):\\n               a. Update the PingOne Worker Service ID (P1 Worker App), Risk Policy ID* in following nodes: (*Optional, if not provided default will be considered)\\n                   -- P1 Protect Initialize (1 instance)\\n                   -- P1 Protect Evaluation (2 instances)\\n           3. MFA Registration Inner Journey (If \\\"SMS\\\", or \\\"VOICE\\\" are opted in below \\\"allowedMFATyps\\\" array):\\n               a. Update the required fields in:\\n                   -- Twilio Verify Lookup\\n                   -- Twilio Verify Sender\\n           4. MFA Authenticaion Inner Journey (If \\\"EMAIL\\\", \\\"SMS\\\", or \\\"VOICE\\\" are opted in below \\\"allowedMFATyps\\\" array):\\n               a. Update the required fields in:\\n                   -- Twilio Verify Lookup\\n                   -- Twilio Verify Sender\\n        -Create a library script for Email Otp to work (If \\\"EMAIL\\\"is opted in below \\\"allowedMFATyps\\\" array):\\n            function XLogger(env) {\\n              this.logger = env.logger;\\n              this.scriptName = env.scriptName;\\n              this.logPrefix = \\\"***\\\" + env.scriptName + \\\": \\\";\\n              this.debug(\\\"logger initialised\\\");\\n            }\\n            XLogger.prototype.debug = function (message) {\\n              this.logger.debug(this.logPrefix.concat(message));\\n            };\\n            XLogger.prototype.warn = function (message) {\\n              this.logger.warn(this.logPrefix.concat(message));\\n            };\\n            XLogger.prototype.error = function (message) {\\n              this.logger.error(this.logPrefix.concat(message));\\n            };\\n            module.exports.XLogger = XLogger;\\n        - Configure email templates like 'otp', 'welcome' , 'suspiciousActivity' , 'accountDisabled'\\n*/\\n\\n\\n// Allowed MFA device types by the Admin\\nvar allowedMFATypes = [\\\"FIDO2\\\", \\\"OATH\\\", \\\"PUSH\\\", \\\"EMAIL\\\", \\\"SMS\\\", \\\"VOICE\\\"];\\nnodeState.putShared(\\\"ciam_allowedMFATypes\\\", allowedMFATypes);\\n\\n// Check if Admin wants to enable/disable protectAnalysis\\nvar protectAnalysisRequired = true;\\nnodeState.putShared(\\\"ciam_protectAnalysisRequired\\\", protectAnalysisRequired);\\n\\n// Check if Admin wants to allow OOB Magic Link as an MFA authentication method\\nvar magicLinkEnabled = true;\\nnodeState.putShared(\\\"ciam_magicLinkEnabled\\\", magicLinkEnabled);\\n\\noutcome = \\\"true\\\";\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925863,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1741150099432,
          "evaluatorVersion": "2.0"
        },
        "81980021-14fc-4e6c-a397-80452b16963f": {
          "_id": "81980021-14fc-4e6c-a397-80452b16963f",
          "name": "Threat Detection - Set Protect Action As Eval",
          "description": "Script to set Protect action as Eval, will be used in Threat Detection Journey to evaluate Risk",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: null\\n    - Script Outputs: \\\"p1ProtectAction\\\", \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\ntry {  \\n    // Action to be taken in threat detection child journey\\n    nodeState.putShared(\\\"p1ProtectAction\\\", \\\"eval\\\");\\n    // Go to true\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error  \\n    action.goTo(\\\"Error\\\");\\n}\\n\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925828,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083412,
          "evaluatorVersion": "2.0"
        },
        "b8332c2e-adec-4ff3-8e5e-95cea0baa73e": {
          "_id": "b8332c2e-adec-4ff3-8e5e-95cea0baa73e",
          "name": "Threat Detection - Validating Inputs - Authentication",
          "description": "Script to validate inputs, sets constraints, and enables/disables the submit button based on validity",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: null\\n    - Script Outputs: \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\ntry {\\n    // Disable next button, if input is empty\\n    function validateInput() {\\n        return String(\\\" \\\\n\\\\\\n                    const submitBtn = document.querySelectorAll('button[type=\\\\\\\"submit\\\\\\\"]')[0]; \\\\n\\\\\\n                if(submitBtn) submitBtn.disabled = true; \\\\n\\\\\\n                function go(obs) { \\\\n\\\\\\n                    const username = document.querySelectorAll('input[data-vv-as=\\\\\\\"User Name\\\\\\\"]')[0]; \\\\n\\\\\\n                    const password = document.querySelectorAll('input[data-vv-as=\\\\\\\"Password\\\\\\\"]')[0]; \\\\n\\\\\\n                    if (username && password && submitBtn) { \\\\n\\\\\\n                        const enableSubmitBtn = () => { \\\\n\\\\\\n                              // Check input validity before enabling submit button \\\\n\\\\\\n                                const isValidInput = username.value.length > 0 && password.value.length > 0; \\\\n\\\\\\n                                if (isValidInput) { \\\\n\\\\\\n                                    submitBtn.disabled = false; \\\\n\\\\\\n                                } else { \\\\n\\\\\\n                                    // Otherwise, disable the button \\\\n\\\\\\n                                    submitBtn.disabled = true; \\\\n\\\\\\n                                } \\\\n\\\\\\n                        }; \\\\n\\\\\\n                        // Revalidate before form submission \\\\n\\\\\\n                        submitBtn.addEventListener('click', (event) => { \\\\n\\\\\\n                            const isValidInput = username.value.length > 0 && password.value.length > 0; \\\\n\\\\\\n                            if (!isValidInput) { \\\\n\\\\\\n                                event.preventDefault(); \\\\n\\\\\\n                                submitBtn.disabled = true; \\\\n\\\\\\n                            } \\\\n\\\\\\n                        }); \\\\n\\\\\\n                        username.addEventListener('input', enableSubmitBtn); \\\\n\\\\\\n                        password.addEventListener('input', enableSubmitBtn); \\\\n\\\\\\n                        if (obs) obs.disconnect(); \\\\n\\\\\\n                        return; \\\\n\\\\\\n                   } \\\\n\\\\\\n                  } \\\\n\\\\\\n                  if (document.querySelectorAll('input[data-vv-as=\\\\\\\"User Name\\\\\\\"]')[0] && document.querySelectorAll('input[data-vv-as=\\\\\\\"Password\\\\\\\"]')[0]) go(); \\\\n\\\\\\n                  else { \\\\n\\\\\\n                    const observer = new MutationObserver((mutations, obs) => { go(obs); }); \\\\n\\\\\\n                    observer.observe(document, { childList: true, subtree: true }); \\\\n\\\\\\n                  } \\\\n\\\\\\n        \\\");\\n    }\\n    \\n    if (callbacks.isEmpty()) {                \\n        // Request callbacks\\n        callbacksBuilder.scriptTextOutputCallback(validateInput());\\n    }\\n    // Go to true\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error \\n    action.goTo(\\\"Error\\\");\\n}\\n\\n\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925890,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083450,
          "evaluatorVersion": "2.0"
        },
        "bd5c931d-3f2b-4a39-9ee8-8b5efabd4ea2": {
          "_id": "bd5c931d-3f2b-4a39-9ee8-8b5efabd4ea2",
          "name": "Threat Detection - Validate Password",
          "description": "Script to validate password, sets constraints",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: null\\n    - Script Outputs: \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\ntry {\\n    // Disable next button, if input is empty\\n    function validateInput() {\\n        return String(\\\" \\\\n\\\\\\n                    const submitBtn = document.querySelectorAll('button[type=\\\\\\\"submit\\\\\\\"]')[0]; \\\\n\\\\\\n                    if(submitBtn) submitBtn.disabled = true; \\\\n\\\\\\n                    function go(obs) { \\\\n\\\\\\n                        const password = document.querySelectorAll('input[data-vv-as=\\\\\\\"Password\\\\\\\"]')[0]; \\\\n\\\\\\n                        if (password && submitBtn) { \\\\n\\\\\\n                            const enableSubmitBtn = () => { \\\\n\\\\\\n                                // Check input validity before enabling submit button \\\\n\\\\\\n                                const isValidInput = password.value.length > 0; \\\\n\\\\\\n                                if (isValidInput) { \\\\n\\\\\\n                                    submitBtn.disabled = false; \\\\n\\\\\\n                                } else { \\\\n\\\\\\n                                    submitBtn.disabled = true; \\\\n\\\\\\n                                } \\\\n\\\\\\n                            }; \\\\n\\\\\\n                            // Revalidate before form submission \\\\n\\\\\\n                            submitBtn.addEventListener('click', (event) => { \\\\n\\\\\\n                                const isValidInput = password.value.length > 0; \\\\n\\\\\\n                                if (!isValidInput) { \\\\n\\\\\\n                                    event.preventDefault(); \\\\n\\\\\\n                                    submitBtn.disabled = true; \\\\n\\\\\\n                                } \\\\n\\\\\\n                            }); \\\\n\\\\\\n                            password.addEventListener('input', enableSubmitBtn); \\\\n\\\\\\n                            if (obs) obs.disconnect(); \\\\n\\\\\\n                            return; \\\\n\\\\\\n                       } \\\\n\\\\\\n                      } \\\\n\\\\\\n                      if (document.querySelectorAll('input[data-vv-as=\\\\\\\"Password\\\\\\\"]')[0]) go(); \\\\n\\\\\\n                      else { \\\\n\\\\\\n                        const observer = new MutationObserver((mutations, obs) => { go(obs); }); \\\\n\\\\\\n                        observer.observe(document, { childList: true, subtree: true }); \\\\n\\\\\\n                      } \\\\n\\\\\\n        \\\");\\n    }\\n    \\n    if (callbacks.isEmpty()) {                \\n        // Request callbacks\\n        callbacksBuilder.scriptTextOutputCallback(validateInput());\\n    }\\n    // Go to true\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error \\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925829,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083479,
          "evaluatorVersion": "2.0"
        },
        "678ed3e6-ea15-4016-9a67-fe2d3e76dae1": {
          "_id": "678ed3e6-ea15-4016-9a67-fe2d3e76dae1",
          "name": "Threat Detection - Validate name and email address",
          "description": "Script to validate name and email address, sets constraints",
          "script": "\"/*\\n  - Data made available by nodes that have already executed are available in the sharedState variable.\\n  - The script should set outcome to either \\\"true\\\" or \\\"false\\\".\\n */\\n\\n/*\\n    - Script Inputs: null\\n    - Script Outputs: \\\"errorMessage\\\", \\\"errorDetails\\\"\\n    - Outcomes: \\\"true\\\"\\n*/\\n\\ntry {\\n    // Validate Inputs\\n    function validateInput() {\\n        return String(\\\" \\\\n\\\\\\n                    const firstName = document.querySelectorAll('input[data-vv-as=\\\\\\\"First Name\\\\\\\"]')[0]; \\\\n\\\\\\n                    const lastName = document.querySelectorAll('input[data-vv-as=\\\\\\\"Last Name\\\\\\\"]')[0]; \\\\n\\\\\\n                    const emailAddress = document.querySelectorAll('input[data-vv-as=\\\\\\\"Email Address\\\\\\\"]')[0]; \\\\n\\\\\\n                    const submitBtn = document.querySelectorAll('button[type=\\\\\\\"submit\\\\\\\"]')[0]; \\\\n\\\\\\n                    \\\\n\\\\\\n                    if (firstName) firstName.setAttribute('maxlength', '255'); \\\\n\\\\\\n                    if (lastName) lastName.setAttribute('maxlength', '255'); \\\\n\\\\\\n                    if (emailAddress) emailAddress.setAttribute('maxlength', '255'); \\\\n\\\\\\n                    \\\\n\\\\\\n                    if (submitBtn) submitBtn.disabled = true; \\\\n\\\\\\n                    function validateFields() { \\\\n\\\\\\n                        const isValid = firstName.value.length > 0 && lastName.value.length > 0 && emailAddress.value.length > 0; \\\\n\\\\\\n                        submitBtn.disabled = !isValid; \\\\n\\\\\\n                    } \\\\n\\\\\\n                    \\\\n\\\\\\n                    submitBtn.addEventListener('click', (event) => { \\\\n\\\\\\n                        // Ensure the fields are not exceeding max length even if modified in browser \\\\n\\\\\\n                        if (firstName.value.length > 255 || lastName.value.length > 255 || emailAddress.value.length > 255) { \\\\n\\\\\\n                            event.preventDefault(); \\\\n\\\\\\n                            submitBtn.disabled = true; \\\\n\\\\\\n                        } \\\\n\\\\\\n                        const isValid = firstName.value.length > 0 && lastName.value.length > 0 && emailAddress.value.length > 0; \\\\n\\\\\\n                        if (!isValid) { \\\\n\\\\\\n                            event.preventDefault(); \\\\n\\\\\\n                            submitBtn.disabled = true; \\\\n\\\\\\n                        } \\\\n\\\\\\n                    }); \\\\n\\\\\\n                    \\\\n\\\\\\n                    firstName.addEventListener('input', validateFields); \\\\n\\\\\\n                    lastName.addEventListener('input', validateFields); \\\\n\\\\\\n                    emailAddress.addEventListener('input', validateFields); \\\\n\\\\\\n        \\\");\\n    }\\n    \\n    if (callbacks.isEmpty()) {                \\n        // Request callbacks\\n        callbacksBuilder.scriptTextOutputCallback(validateInput());\\n    }\\n    // Go to true path\\n    action.goTo(\\\"true\\\");\\n} catch (e) {\\n    // User-friendly error message\\n    nodeState.putShared(\\\"errorMessage\\\", \\\"An error has occurred. Contact support.\\\");\\n    // Detailed error information for debugging\\n    nodeState.putShared(\\\"errorDetails\\\", e.toString());\\n    // Go to Error  \\n    action.goTo(\\\"Error\\\");\\n}\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "creationDate": 1733466925806,
          "lastModifiedBy": "id=33cd4f64-d3b0-45a9-9fbd-ccfc3e1b2aaa,ou=user,ou=am-config",
          "lastModifiedDate": 1733468083415,
          "evaluatorVersion": "2.0"
        }
      },
      "emailTemplates": {
        "magicLinkTemplate": {
          "_id": "emailTemplate/magicLinkTemplate",
          "advancedEditor": true,
          "defaultLocale": "en",
          "description": "To authenticate with email address ",
          "displayName": "Magic Link Template",
          "enabled": true,
          "from": "",
          "html": {
            "en": "",
            "fr": ""
          },
          "message": {
            "en": "<div style=\"display:block;text-align:center;font-family:sans-serif;border:1px solid #c5c5c5;width:400px;padding:30px 20px\">\n  <img src=\"https://assets.pingone.com/ux/ui-library/5.0.2/images/logo-pingidentity.png\" alt=\"Company Logo\" style=\"height:65px;margin-bottom:10px\" />\n  <h1>Sign On Request</h1>\n  <div style=\"margin-top:20px;margin-bottom:25px\">\n    <p>Please click the link below to authenticate. </p>\n    <a href=\"{{object.resumeURI}}\" style=\"font-size:14pt\">Complete Sign On</a>\n  </div>\n</div>",
            "fr": "<html>\n  <head></head>\n  <body style=\"background-color: #324054; color: #5e6d82; padding: 60px; text-align: center;\">\n    <h3>Ceci est votre mail d'inscription.</h3>\n    <p>\n      <a href=\"{{object.resumeURI}}\" style=\"text-decoration: none; color: #109cf1;\">Lien de vérification email</a>\n    </p>\n  </body>\n</html>"
          },
          "mimeType": "text/html",
          "styles": "body{background-color:#324054;color:#5e6d82;padding:60px;text-align:center}a{text-decoration:none;color:#109cf1}.content{background-color:#fff;border-radius:4px;margin:0 auto;padding:48px;width:235px}",
          "subject": {
            "en": "Sign On Request",
            "fr": "Créer un nouveau compte"
          },
          "templateId": "magicLinkTemplate"
        }
      },
      "socialIdentityProviders": {},
      "themes": [],
      "saml2Entities": {},
      "circlesOfTrust": {}
    }
  }
}